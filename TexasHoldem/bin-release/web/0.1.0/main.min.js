var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(a,o){function r(e){try{l(i.next(e))}catch(t){o(t)}}function s(e){try{l(i["throw"](e))}catch(t){o(t)}}function l(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(r,s)}l((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,o&&(r=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,o=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){s.label=n[1];break}if(6===n[0]&&s.label<r[1]){s.label=r[1],r=n;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(n);break}r[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(i){n=[6,i],o=0}finally{a=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var a,o,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return{next:n(0),"throw":n(1),"return":n(2)}},BasePanel=function(e){function t(){var t=e.call(this)||this;return t.layer=UILayerType.Module,t.panelAlignType=PanelAlignType.Center_Center,t.offsetH=0,t.offsetV=0,t.isTween=!0,t.isCloseButtonTween=!0,t.isFirstTween=!1,t.isLoadComplete=!1,t.isTweenOver=!1,t.isTweenCloseing=!1,t._isMaskClickClose=!1,t._maskAlpha=.5,t.addEventListener(eui.UIEvent.COMPLETE,t.onAwake,t),t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onEnable,t),t.setTouchEnable(!0),t.setTouchChildren(!0),t.width=GameSetting.StageWidth,t.height=GameSetting.StageHeight,t.grayMask=new eui.Image,t.grayMask.source=ImageSource.GrayBg,t.grayMask.scale9Grid=new egret.Rectangle(10,9,33,15),t.grayMask.top=0,t.grayMask.bottom=0,t.grayMask.left=0,t.grayMask.right=0,t.setGrayMask(!0),t}return __extends(t,e),Object.defineProperty(t.prototype,"isMaskClickClose",{set:function(e){this._isMaskClickClose=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maskAlpha",{set:function(e){this._maskAlpha=e,this.grayMask.alpha=e},enumerable:!0,configurable:!0}),t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.onAwake=function(e){this.isLoadComplete=!0,this.isTween&&(this.isTweenOver=!1,this.isFirstTween=!0,this.onTween()),this.tweenGroup?(this.tweenGroup.maxWidth=GameSetting.StageWidth,this.tweenGroup.maxHeight=GameSetting.StageHeight):(this.maxWidth=GameSetting.StageWidth,this.maxHeight=GameSetting.StageHeight),this.addChildAt(this.grayMask,0),this.removeEventListener(eui.UIEvent.COMPLETE,this.onAwake,this)},t.prototype.init=function(e){this.isTween&&this.isLoadComplete&&!this.isFirstTween&&(this.isTweenOver=!1,this.onTween()),this.panelData=e,this.isTweenCloseing=!1},t.prototype.onEnable=function(e){if(this.closeButton&&this.isCloseButtonTween){egret.Tween.removeTweens(this.closeButton);var t=egret.Tween.get(this.closeButton),n=this.closeButton.scaleX,i=this.closeButton.scaleY;this.closeButton.scaleX=0,this.closeButton.scaleY=0,t.wait(300).to({scaleX:n,scaleY:i},200)}this.closeButton&&this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnClickHandler,this),this._isMaskClickClose&&this.grayMask.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnClickHandler,this),this.addEventListener(egret.Event.RENDER,this.onRender,this),this.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this)},t.prototype.onDisable=function(e){this.removeEventListener(eui.UIEvent.COMPLETE,this.onAwake,this),this.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this),this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnClickHandler,this),this.tweenGroup&&egret.Tween.removeTweens(this.tweenGroup),this.grayMask.hasEventListener(egret.TouchEvent.TOUCH_TAP)&&this.grayMask.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseBtnClickHandler,this),this.removeEventListener(egret.Event.RENDER,this.onRender,this)},t.prototype.onRender=function(e){this.removeEventListener(egret.Event.RENDER,this.onRender,this)},t.prototype.onTween=function(){this.tweenGroup&&(this.grayMask&&this.grayMask.visible&&(this.grayMask.alpha=this._maskAlpha),egret.Tween.removeTweens(this.tweenGroup),this.tweenGroup.scaleX=.5,this.tweenGroup.scaleY=.5,this.tweenGroup.alpha=1,this.tweenObj=new egret.Tween(this.tweenGroup,null,null),this.tweenObj.to({scaleX:1.03,scaleY:1.03},200).to({scaleX:1,scaleY:1},120,egret.Ease.backIn).wait(120).call(this.onTweenOver,this),this.tweenObj.play())},t.prototype.onTweenOver=function(){this.isFirstTween=!1,this.tweenObj=null,this.isTweenOver=!0},t.prototype.onCloseBtnClickHandler=function(e){e&&SoundManager.playButtonEffect(e.target),this.isTween&&this.tweenGroup?this.isTweenCloseing||(this.onTweenOver(),this.isTweenCloseing=!0,egret.Tween.removeTweens(this.tweenGroup),this.tweenObj=new egret.Tween(this.tweenGroup,{onChange:this.onCloseTweenChange.bind(this)},null),this.tweenObj.to({scaleX:.5,scaleY:.5,alpha:.1},200,egret.Ease.quadInOut).call(this.tweenClose,this),this.tweenObj.play()):this.tweenClose()},t.prototype.onCloseTweenChange=function(){this.grayMask&&this.grayMask.visible&&this.tweenGroup.alpha<this._maskAlpha&&(this.grayMask.alpha=this.tweenGroup.alpha)},t.prototype.tweenClose=function(){this.tweenGroup&&(egret.Tween.removeTweens(this.tweenGroup),this.isTweenCloseing=!1),UIManager.closePanel(this)},t.prototype.setAlignInfo=function(e,t,n){void 0===e&&(e=PanelAlignType.Center_Center),void 0===t&&(t=0),void 0===n&&(n=0),this.panelAlignType=e,this.offsetH=t,this.offsetV=n},t.prototype.setTouchEnable=function(e){this.touchEnabled=e},t.prototype.setTouchChildren=function(e){this.touchChildren=e},t.prototype.setGrayMask=function(e){void 0===e&&(e=!0),this.grayMask.visible=e},t.prototype.destroy=function(){this.onDisable(null),this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onEnable,this),this.removeEventListener(eui.UIEvent.COMPLETE,this.onAwake,this)},t}(eui.Component);__reflect(BasePanel.prototype,"BasePanel");var BaseAnmiatePanel=function(e){function t(){var t=e.call(this)||this;return t.maskAlpha=1,t}return __extends(t,e),t.prototype.init=function(e){e&&null!=e.prePaneName&&(this.prePaneName=e.prePaneName)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.isEnterOver=!1,egret.Tween.removeTweens(this.anmGroup),egret.Tween.removeTweens(this.anmGroup1),egret.Tween.removeTweens(this.titleImg),this.grayMask&&egret.Tween.removeTweens(this.grayMask);var n=egret.Tween.get(this.anmGroup);this.anmGroup.y=-100,this.anmGroup.alpha=1,n.to({y:0,alpha:1},260,egret.Ease.circOut),n=egret.Tween.get(this.anmGroup1),this.anmGroup1.y=1280,this.anmGroup.alpha=0,n.to({y:100,alpha:1},260,egret.Ease.circOut).call(this.onEnterAnmComplete.bind(this)),n=egret.Tween.get(this.titleImg),this.titleImg.y=-100,n.wait(300).to({y:10},200),this.grayMask&&(n=egret.Tween.get(this.grayMask),this.grayMask.alpha=0,n.to({alpha:1},260,egret.Ease.backOut))},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.isEnterOver=!1},t.prototype.onEnterAnmComplete=function(){this.isEnterOver=!0},t.prototype.onCloseBtnClickHandler=function(e){e&&SoundManager.playButtonEffect(e.target);var t=egret.Tween.get(this.anmGroup);this.anmGroup.y=0,this.anmGroup.alpha=1,t.to({y:-100,alpha:1},500,egret.Ease.circOut),t=egret.Tween.get(this.anmGroup1),this.anmGroup1.y=100,this.anmGroup.alpha=1,t.to({y:1280,alpha:0},500,egret.Ease.circOut).call(this.onCloseAnmComplete.bind(this)),this.grayMask&&(t=egret.Tween.get(this.grayMask),this.grayMask.alpha=.7,t.to({alpha:.1},400,egret.Ease.backOut)),this.prePaneName&&UIManager.showPanel(this.prePaneName)},t.prototype.onCloseAnmComplete=function(){UIManager.closePanel(this)},t}(BasePanel);__reflect(BaseAnmiatePanel.prototype,"BaseAnmiatePanel");var Dictionary=function(){function e(){this.keys=[],this.values=[]}return Object.defineProperty(e.prototype,"count",{get:function(){return this.keys.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){var n=this.keys.indexOf(e,0);n>=0?this.values[n]=t:(this.keys.push(e),this.values.push(t))},e.prototype.remove=function(e){var t=this.keys.indexOf(e,0);t>=0&&(this.keys.splice(t,1),this.values.splice(t,1))},e.prototype.getValue=function(e){var t=this.keys.indexOf(e,0);return-1!=t?this.values[t]:null},e.prototype.containsKey=function(e){for(var t=0,n=this.keys.length;n>t;++t)if(this.keys[t]==e)return!0;return!1},e.prototype.getKey=function(e){var t=this.values.indexOf(e);return t>=0?this.keys[t]:null},e.prototype.getKeys=function(){return this.keys},e.prototype.getValues=function(){return this.values},e.prototype.clear=function(){this.keys.length=0,this.values.length=0},e}();__reflect(Dictionary.prototype,"Dictionary");var BaseComponent=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.COMPLETE,t.onAwake,t),t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onEnable,t),t.skinName="",t}return __extends(t,e),t.prototype.init=function(e){this.bindData=e},t.prototype.onAwake=function(e){this.isLoadComplete=!0,this.removeEventListener(eui.UIEvent.COMPLETE,this.onAwake,this)},t.prototype.onEnable=function(e){this.addEventListener(egret.Event.RENDER,this.rendererStart,this),this.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this)},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.RENDER,this.rendererStart,this),this.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this)},t.prototype.rendererStart=function(e){this.removeEventListener(egret.Event.RENDER,this.rendererStart,this)},t.prototype.destroy=function(){this.onDisable(null),this.removeEventListener(eui.UIEvent.COMPLETE,this.onAwake,this),this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onEnable,this)},t}(eui.Component);__reflect(BaseComponent.prototype,"BaseComponent");var InitAppHandler=function(){function e(){this._isAppComplete=!1}return Object.defineProperty(e.prototype,"isAppComplete",{get:function(){return this._isAppComplete},enumerable:!0,configurable:!0}),e.prototype.Invoke=function(){0==this._isAppComplete&&(this._isAppComplete=!0),MailManager.Reset()},e}();__reflect(InitAppHandler.prototype,"InitAppHandler");var InitServerHandler=function(){function e(){this._isComplete=!1,this._isGeting=!1}return Object.defineProperty(e.prototype,"isComplete",{get:function(){return this._isComplete},enumerable:!0,configurable:!0}),e.prototype.Invoke=function(e,t,n,i){this._isComplete=!1,this._complete=n,this._error=i,UserManager.serverInfo=t,SocketManager.Close(),SocketManager.Initialize(e.userid,t.roleId,t.id,e.secret,e.session,GameSetting.Gamec2sBin,GameSetting.Games2cBin),this.RemoveEvents(),SocketManager.OnConnect.addListener(this.OnSocketConnect,this),SocketManager.OnEnterError.addListener(this.OnEnterError,this),SocketManager.isEntering=!0,SocketManager.Connect(e.ip,e.port,!0)},e.prototype.AfreshGetInfo=function(){0==this._isGeting&&(this._isGeting=!0,SocketManager.AddCommandListener(Command.Role_Get_3000,this.OnRoleInfo),SocketManager.Send(Command.Role_Get_3000))},e.prototype.RemoveEvents=function(){SocketManager.OnConnect.removeListener(this.OnSocketConnect),SocketManager.OnEnterError.removeListener(this.OnEnterError)},e.prototype.OnSocketConnect=function(){SocketManager.AddCommandListener(Command.Role_Get_3000,this.OnRoleInfo,this),SocketManager.Send(Command.Role_Get_3000)},e.prototype.OnEnterError=function(){this.DispatchError()},e.prototype.OnRoleInfo=function(e){0==LoginManager.loginInfo.hasAlreadyCreateRole&&(LoginManager.loginInfo.hasAlreadyCreateRole=!0),SocketManager.RemoveCommandListener(Command.Role_Get_3000,this.OnRoleInfo),0==UserManager.serverInfo.roleId&&(UserManager.serverInfo.roleId=SocketManager.roleId),UserManager.initialize(SocketManager.roleId,e.data),PayManager.initialize(),ShoppingManager.initialize(),VipManager.initialize(),TimeManager.initialize(e.data),this.RequestNotice()},e.prototype.RequestNotice=function(){RoomManager.reqJoinRoomEA.addListener(this.OnGetNotice,this),RoomManager.reqJoinRoom(0,SocketManager.requestSessionMax)},e.prototype.OnGetNotice=function(){RoomManager.reqJoinRoomEA.removeListener(this.OnGetNotice),SocketManager.isEntering=!1,this.DispatchComplete()},e.prototype.DispatchComplete=function(){this.RemoveEvents(),this._isGeting=!1,this._isComplete=!0,null!=this._complete&&(this._complete(),this._complete=null)},e.prototype.DispatchError=function(){this.RemoveEvents(),this._isGeting=!1,null!=this._error&&(this._error(),this._error=null)},e}();__reflect(InitServerHandler.prototype,"InitServerHandler");var BaseScene=function(){function e(){}return e.prototype.initialize=function(e,t){this.clear(),this.resGroupName=e,void 0==this.resGroupName||this.isResLoaded?this.onResourceLoadComplete():(RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(this.resGroupName))},e.prototype.onResourceLoadComplete=function(){this.isResLoaded=!0,UIManager.closePanel(UIModuleName.LoadingSwitchPanel),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.onResourceProgress=function(e){console.log("场景资源加载地址："+e.resItem.url),SceneManager.updateProgress(e,"正在加载场景资源.....")},e.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load")},e.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},e}();__reflect(BaseScene.prototype,"BaseScene");var BackHomeAnimePanel=function(e){function t(){var t=e.call(this)||this;return t.prePaneName=UIModuleName.GameHallPanel,t}return __extends(t,e),t}(BaseAnmiatePanel);__reflect(BackHomeAnimePanel.prototype,"BackHomeAnimePanel");var BaseSocket=function(){function e(e){void 0===e&&(e=!1),this._session=0,this._discRetryMap=new Dictionary,this._address=StringConstant.empty,this._msgType=egret.WebSocket.TYPE_BINARY,this._commandDispatcher=new CallDispatcher,this._errorDispatcher=new CallDispatcher,this._normalErrorSet=new Array,this._enabledSend=!1,this._useHandshake=!1,this._isHandshaking=!1,this._requestSessionMax=0,this._useHandshake=e}return Object.defineProperty(e.prototype,"enabledSend",{get:function(){return this._enabledSend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestSessionMax",{get:function(){return this._requestSessionMax},enumerable:!0,configurable:!0}),e.prototype.addNormalError=function(e){this._normalErrorSet.push(e)},e.prototype.removeNormalError=function(e){ArrayUtil.RemoveItem(e,this._normalErrorSet)},Object.defineProperty(e.prototype,"address",{get:function(){return this._address},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.RemoveCommandListener(e.HandshakeName,this.ParseHandshake),this._discRetryMap=null,this._enabledSend=!1,this.resetSocket(),null!=this._commandDispatcher&&(this._commandDispatcher.dispose(),this._commandDispatcher=null),null!=this._errorDispatcher&&(this._errorDispatcher.dispose(),this._errorDispatcher=null),this._spRpc=null},e.prototype.close=function(e){void 0===e&&(e=!1),this._enabledSend=e,this.resetSocket()},Object.defineProperty(e.prototype,"hasDiscRetry",{get:function(){return null!=this._discRetryMap?this._discRetryMap.count>0:!1},enumerable:!0,configurable:!0}),e.prototype.resetSocket=function(){if(null!=this._socket)try{this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),this._socket.close(),this._socket=null}catch(e){console.log(e)}this._isHandshaking=!1},e.prototype.Connect=function(e,t){this._address=e,this._port=t,null!=this._socket&&this.resetSocket(),this._socket=new egret.WebSocket,this._socket.type=this._msgType,this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),this._socket.connect(this._address,this._port)},e.prototype.onSocketOpen=function(){null!=this._socket&&this._spRpc&&(this._enabledSend=!0,this._spRpc.host("package"),this._attchRet=this._spRpc.attach(),this._useHandshake?(this._isHandshaking=!0,this.Handshake()):(this._isHandshaking=!1,this.DispatchMessage(new SocketMessage(SocketMessageType.Connect,"0","connect succeed"))))},e.prototype.InvokeSend=function(e,t,n){return void 0===n&&(n=null),(this._enabledSend||e)&&this._session++,e&&this.addSendObject(t,this._session,n),this._enabledSend?this.sendData(t,this._session,n):-1},e.prototype.Send=function(e,t){return void 0===t&&(t=null),this._session++,this.sendData(e,this._session,t)},e.prototype.sendData=function(e,t,n){if(void 0===n&&(n=null),null==this._socket||null==this._spRpc||null==this._attchRet)return void this.DispatchMessage(new SocketMessage(SocketMessageType.NetworkError,"-1","NotInitialized"));try{console.log("Socket.Send -> cmdId:",e,"session:",t);var i=this._attchRet(e,n,t).buf,a=array2arraybuffer(i),o=new egret.ByteArray(a);return this._socket.writeBytes(o),this._socket.flush(),t}catch(r){console.log(r),this.ParseException(-1,r)}return-1},e.prototype.onSocketClose=function(){console.log("WebSocket Close"),this.DispatchMessage(new SocketMessage(SocketMessageType.Failing,"close","Server Close"))},e.prototype.onSocketError=function(){console.log("WebSocket connect error"),this.DispatchMessage(new SocketMessage(SocketMessageType.NetworkError,"close","WebSocket connect error"))},e.prototype.onReceiveMessage=function(e){if(this._socket){var t=new egret.ByteArray;this._socket.readBytes(t),t.position=0;var n=arraybuffer2array(t.buffer);this._spRpc.dispatch({buf:n,sz:n.length},this.handleRequest.bind(this),this.handleResponse.bind(this))}},e.prototype.handleRequest=function(e,t,n,i){void 0==i&&(i=0),console.log("server-push---->socket.receive -> cmdId:",e,"-> session:",n,"-> error:",i),this._discRetryMap.remove(e);var a=new SpRpcResult;a.cmdId=e,a.data=t,a.error=i,a.op=SpRpcOp.Request,a.session=n,this._requestSessionMax<n&&(this._requestSessionMax=n),this._useHandshake&&this._isHandshaking?this.ParseHandshake(a):(this.DispatchResult(a),0==a.error||-1!=this._normalErrorSet.indexOf(a.error)?this.DispatchCommand(e,a):this.DispatchError(e,a))},e.prototype.handleResponse=function(e,t,n,i){void 0==i&&(i=0),console.log("client-req-----socket.receive -> cmdId:",e,"-> session:",n,"-> error:",i),this._discRetryMap.remove(e);var a=new SpRpcResult;a.cmdId=e,a.data=t,a.error=i,a.op=SpRpcOp.Response,a.session=n,this._useHandshake&&this._isHandshaking?this.ParseHandshake(a):(this.DispatchResult(a),0==a.error||-1!=this._normalErrorSet.indexOf(a.error)?this.DispatchCommand(e,a):this.DispatchError(e,a))},e.prototype.addSendObject=function(e,t,n){var i=new SocketSendInfo;i.session=t,i.obj=n,this._discRetryMap.add(e,i)},e.prototype.Handshake=function(){},e.prototype.ParseHandshake=function(e){},e.prototype.AddMessageListener=function(e){null==this._onSocketMessage&&(this._onSocketMessage=new ActionDispatcher),this._onSocketMessage.addListener(e)},e.prototype.RemoveMessageListener=function(e){this._onSocketMessage&&this._onSocketMessage.removeListener(e)},e.prototype.DispatchMessage=function(e){this._onSocketMessage&&this._onSocketMessage.dispatch(e)},e.prototype.ParseException=function(e,t){var n=new SocketMessage(SocketMessageType.NetworkError,e.toString(),t.toString());this.DispatchMessage(n)},e.prototype.AddResultListener=function(e){null==this._onResult&&(this._onResult=new ActionDispatcher),this._onResult.addListener(e)},e.prototype.RemoveResultListener=function(e){this._onResult&&this._onResult.removeListener(e)},e.prototype.DispatchResult=function(e){this._onResult&&this._onResult.dispatch(e)},e.prototype.AddCommandListener=function(e,t,n){this._commandDispatcher.addListener(e,t,n)},e.prototype.RemoveCommandListener=function(e,t){this._commandDispatcher.removeListener(e,t)},e.prototype.DispatchCommand=function(e,t){this._commandDispatcher.dispatch(e,t)},e.prototype.AddErrorListener=function(e,t,n){this._errorDispatcher.addListener(e,t,n)},e.prototype.RemoveErrorListener=function(e,t){this._errorDispatcher.removeListener(e,t)},e.prototype.DispatchError=function(e,t){this._errorDispatcher.dispatch(e,t)},e}();BaseSocket.HandshakeName="handshake",__reflect(BaseSocket.prototype,"BaseSocket");var BaseServerValueInfo=function(){function e(e){this.reset(),e&&this.copyValueFrom(e)}return e.prototype.copyValueFrom=function(e){if(e)for(var t in e){var n=this[t];if(!(n instanceof Function)){var i=typeof this[t];if(void 0==e[t])switch(i){case"number":e[t]=0;break;case"string":e[t]=StringConstant.empty}else this[t]=e[t]}}},e.prototype.copyValueFromThis=function(e){if(e)for(var t in this){var n=e[t];n instanceof Function||(this[t]=e[t])}},e}();__reflect(BaseServerValueInfo.prototype,"BaseServerValueInfo");var OtherShouCard=function(e){function t(t,n){var i=e.call(this)||this;return i._shouPaiDef=t,i._imageBg=new eui.Image,i.addChild(i._imageBg),i.init(),i}return __extends(t,e),Object.defineProperty(t.prototype,"shouPaiDef",{get:function(){return this._shouPaiDef},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardNum",{get:function(){return this._card},enumerable:!0,configurable:!0}),t.prototype.init=function(){if(!this._imageBg.source)switch(this._shouPaiDef.posType){case PosType.BenJia:this._imageBg.source=ImageSource.BenJia_ShouCard_Bg,this._imageBg.width=92.4,this._imageBg.height=117;break;case PosType.XiaJia:this._imageBg.source=ImageSource.XiaJia_ShouCard_Bg,this._imageBg.width=129,this._imageBg.height=185,this.scaleX=-1;break;case PosType.DuiJia:this._imageBg.source=ImageSource.DuiJia_ShouCard_Bg,this._imageBg.width=50,this._imageBg.height=59;break;case PosType.ShangJia:this._imageBg.source=ImageSource.ShangJia_ShouCard_Bg,this._imageBg.width=129,this._imageBg.height=185}},t.prototype.refreshFace=function(e){},t.prototype.setScale=function(e){e&&(this._imageBg.scaleX=this._imageBg.scaleY=e)},t.prototype.clear=function(){},t}(egret.DisplayObjectContainer);__reflect(OtherShouCard.prototype,"OtherShouCard");var EnterRoomPwdPanel=function(e){function t(t){for(var n=e.call(this)||this,i=1;6>=i;i++)n["label"+i.toString()]=new NumComponent;return t||(n.skinName=UISkinName.EnterRoomPwdPanel),n}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.isCloseButtonTween=!1,this._labelList=new Array;for(var n=1;6>=n;n++)this._labelList.push(this["label"+n.toString()]),this.labelGroup.addChild(this["label"+n.toString()]);this.setGrayMask(!1),this.callback=this.enterPwd,this.openPanelName=UIModuleName.EnterRoomPwdPanel},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.resetLabel(),UIManager.showPanel(UIModuleName.KeyBoardPanel,{callback:this.callback,target:this,isbgNotCanClick:!0}),UIManager.showPanel(this.openPanelName)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t.prototype.onCloseBtnClickHandler=function(t){e.prototype.onCloseBtnClickHandler.call(this,t),UIManager.closePanel(this.openPanelName),PlayingFieldManager.onCloseKeyboardEvent.dispatch(),this.resetLabel()},t.prototype.resetLabel=function(){for(var e=0,t=this._labelList;e<t.length;e++){var n=t[e];n.refresh()}},t.prototype.enterPwd=function(e,t){if(t){var n=this.getUnWriteLabel();n&&n.refresh(parseInt(t))}if(1==e){var i=this.getRoomPwd();if(i.length>5){var a=parseInt(i);if(0>=a||a.toString().length<6)return void UIManager.showFloatTips("房间密码不对！");UIManager.showFloatTips("发送加入房间请求"+PlayingFieldManager.roomId)}}else if(2==e){var o=this.getWirteLabel();o&&o.refresh()}else 3==e&&this.resetLabel()},t.prototype.getUnWriteLabel=function(){for(var e,t=0;t<this._labelList.length;t++)if(e=this._labelList[t],e.label1&&!e.label1.text)return e;return null},t.prototype.getWirteLabel=function(){for(var e,t=this._labelList.length-1;t>=0;t--)if(e=this._labelList[t],e.label1&&e.label1.text)return e;return null},t.prototype.getRoomPwd=function(){for(var e=StringConstant.empty,t=0;t<this._labelList.length;t++)e+=this._labelList[t].label1.text;return e},t}(BasePanel);__reflect(EnterRoomPwdPanel.prototype,"EnterRoomPwdPanel");var BaseItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName="",t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){this.bindData=this.data},t.prototype.destroy=function(){},t}(eui.ItemRenderer);__reflect(BaseItemRenderer.prototype,"BaseItemRenderer");var ChannelBase=function(){function e(){}return e.prototype.Initialize=function(){},e.prototype.Login=function(e,t){},e.prototype.PaySend=function(e,t,n,i){},e.prototype.Logout=function(){},e.prototype.CheckPayOrder=function(){},e.prototype.loginValidateFail=function(){},e.prototype.Exit=function(){},e.prototype.share=function(e){},e.prototype.SetExtData=function(e){},e.prototype.SetChannelData=function(e,t){},e.prototype.requestMicrophone=function(){},e.prototype.recordAudio=function(e){},e.prototype.hotUpdate=function(e){},e.prototype.playComplete=function(e){},e.prototype.setRecordData=function(e,t){},e.prototype.checkAudioCachePath=function(){},e.prototype.hasRecordData=function(e){},e.prototype.playRecord=function(e){},e.prototype.sdkPaySucceed=function(e){},e.prototype.sdkPayFailed=function(){},e}();__reflect(ChannelBase.prototype,"ChannelBase");var UpdateHandler=function(){function e(){}return e.prototype.GetUpdateChannelURL=function(e){StringUtil.isNull(this._updateChannelUrl)?(this._updateCallback=e,RES.getResByUrl(ProjectDefined.GetInstance().getValue(ProjectDefined.updateUrl),this.OnGetUpdateChannelCompdate,this,RES.ResourceItem.TYPE_JSON)):(null!=e&&e(this._updateChannelUrl),this._updateCallback=null)},e.prototype.OnGetUpdateChannelCompdate=function(e){this.ParseUpdate(e),null!=this._updateCallback&&0==StringUtil.isNull(this._updateChannelUrl)&&(this._updateCallback(this._updateChannelUrl),this._updateCallback=null)},e.prototype.OpenUpdateUrl=function(){StringUtil.isNull(this._updateChannelUrl)?RES.getResByUrl(ProjectDefined.GetInstance().getValue(ProjectDefined.updateUrl),this.OnUpdateCompdate,this,RES.ResourceItem.TYPE_JSON):window.location.href=this._updateChannelUrl},e.prototype.OnUpdateCompdate=function(e){this.ParseUpdate(e,!0),0==StringUtil.isNull(this._updateChannelUrl)&&(window.location.href=this._updateChannelUrl)},e.prototype.ParseUpdate=function(e,t){if(void 0===t&&(t=!1),StringUtil.isNull(e))t&&this.exceptionAlert();else try{var n=JSON.parse(e);this._updateChannelUrl=n[ChannelManager.bundleId]}catch(i){t&&this.exceptionAlert()}},e.prototype.exceptionAlert=function(){AlertManager.showSingleAlert("下载出错，请到应用商店下载"),this._updateCallback=null},e}();__reflect(UpdateHandler.prototype,"UpdateHandler");var BaseDefined=function(){function e(){}return e.prototype.getDefinition=function(e,t){if(null!=t)for(var n=0;n<t.length;n++)if(t[n].id==e)return t[n];return null},e}();__reflect(BaseDefined.prototype,"BaseDefined");var LoginMode;!function(e){e[e.Guest=0]="Guest",e[e.Account=1]="Account",e[e.Token=2]="Token",e[e.TokenDebug=3]="TokenDebug"}(LoginMode||(LoginMode={}));var ChannelLoginType=function(){function e(){}return e.IsViewAccount=function(t){switch(t){case e.Guest:case e.Account:case e.IntranetGuest:case e.IntranetAccount:return!0}return!1},e.GetChannelLoginList=function(t,n,i,a){var o=new Array;if(i==OperatePlatform.qin?(o.push(e.Account),o.push(e.Guest),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&o.push(e.Weixin),t&&(o.push(e.IntranetAccount),o.push(e.IntranetGuest))):n?(o.push(e.Guest),t&&egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&o.push(e.Weixin)):(t&&o.push(e.Guest),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&o.push(e.Weixin)),o.length<=0)throw new Error("登录类型列表长度不可能为0");return o},e}();ChannelLoginType.Guest="guest",ChannelLoginType.IntranetGuest="intranetGuest",ChannelLoginType.IntranetAccount="intranetAccount",ChannelLoginType.Weixin="weixin",ChannelLoginType.Account="account",ChannelLoginType.Normal="",__reflect(ChannelLoginType.prototype,"ChannelLoginType");var UILayerType;!function(e){e[e.None=0]="None",e[e.GameContent=1]="GameContent",e[e.MainUI=2]="MainUI",e[e.Module=3]="Module",e[e.Tips=4]="Tips",e[e.Guide=5]="Guide",e[e.Warn=6]="Warn"}(UILayerType||(UILayerType={}));var PanelAlignType;!function(e){e[e.None=0]="None",e[e.Center_Top=1]="Center_Top",e[e.Center_Center=2]="Center_Center",e[e.Center_Bottom=3]="Center_Bottom",e[e.Left_Top=4]="Left_Top",e[e.Left_Center=5]="Left_Center",e[e.Left_Bottom=6]="Left_Bottom",e[e.Right_Top=7]="Right_Top",e[e.Right_Center=8]="Right_Center",e[e.Right_Bottom=9]="Right_Bottom"}(PanelAlignType||(PanelAlignType={}));var SceneLayer;!function(e){e[e.None=0]="None",e[e.Map=1]="Map",e[e.Model=2]="Model",e[e.Effect=3]="Effect",e[e.Text=4]="Text"}(SceneLayer||(SceneLayer={}));var SceneType;!function(e){e[e.None=0]="None",e[e.Login=1]="Login",e[e.Hall=2]="Hall",e[e.Game=3]="Game"}(SceneType||(SceneType={}));var UIModuleName=function(){function e(){}return e}();UIModuleName.NetworkPanel="NetworkPanel",UIModuleName.TextTipsPanel="TextTipsPanel",UIModuleName.GetCoinTipsPanel="GetCoinTipsPanel",UIModuleName.AlertInfoPanel="AlertInfoPanel",UIModuleName.LoadingPanel="LoadingPanel",UIModuleName.LoginPanel="LoginPanel",UIModuleName.UserAngreementPanel="UserAngreementPanel",UIModuleName.GameHallPanel="GameHallPanel",UIModuleName.MarqueePanel="MarqueePanel",UIModuleName.PayPanel="PayPanel",UIModuleName.CreateRoomPanel="CreateRoomPanel",UIModuleName.SettingPanel="SettingPanel",UIModuleName.TextInfoPanel="TextInfoPanel",UIModuleName.JoinInRoomPanel="JoinInRoomPanel",UIModuleName.RegisterPanel="RegisterPanel",UIModuleName.LoginLocalPanel="LoginLocalPanel",UIModuleName.LoginBar="LoginBar",UIModuleName.EnterLoginPanel="EnterLoginPanel",UIModuleName.RoundInfoPanel="RoundInfoPanel",UIModuleName.GameScenePanel="GameScenePanel",UIModuleName.LoadingSwitchPanel="LoadingSwitchPanel",UIModuleName.TingInfoPanel="TingInfoPanel",UIModuleName.OnceResultPanel="OnceResultPanel",UIModuleName.GameOverPanel="GameOverPanel",UIModuleName.GangSelectPanel="GangSelectPanel",UIModuleName.UserInfoPanel="UserInfoPanel",UIModuleName.LoginSceneBgPanel="LoginSceneBgPanel",UIModuleName.RoomDisbandInfoPanel="RoomDisbandInfoPanel",UIModuleName.RoomDisbandOperPanel="RoomDisbandOperPanel",UIModuleName.RoundDetialsPanel="RoundDetialsPanel",UIModuleName.ShareGamePanel="ShareGamePanel",UIModuleName.AudioRecordingPanel="AudioRecordingPanel",UIModuleName.VipPanel="VipPanel",UIModuleName.CreateRolePanel="CreateRolePanel",UIModuleName.EditUserInfoPanel="EditUserInfoPanel",UIModuleName.ChangeUserNamePanel="ChangeUserNamePanel",UIModuleName.ShoppingPanel="ShoppingPanel",UIModuleName.PlayingFieldPanel="PlayingFieldPanel",UIModuleName.KeyBoardPanel="KeyBoardPanel",UIModuleName.EnterRoomPwdPanel="EnterRoomPwdPanel",UIModuleName.SetPanel="SetPanel",UIModuleName.GameRulePanel="GameRulePanel",UIModuleName.CreateRoomPwdPanel="CreateRoomPwdPanel",UIModuleName.SavePanel="SavePanel",UIModuleName.FriendPanel="FriendPanel",UIModuleName.MailPanel="MailPanel",UIModuleName.ChatPanel="ChatPanel",UIModuleName.MyAwardPanel="MyAwardPanel",__reflect(UIModuleName.prototype,"UIModuleName");
var UISkinName=function(){function e(){}return e}();UISkinName.TextTipsPanel="resource/assets/skins/panel/TextTipsSkin.exml",UISkinName.GetCoinTipsPanel="resource/assets/skins/panel/GetCionTipsSkin.exml",UISkinName.AlertInfoPanel="resource/assets/skins/panel/AlertInfoPanel.exml",UISkinName.LoadingPanel="resource/assets/skins/panel/LoadingPanel.exml",UISkinName.LoginPanel="resource/assets/skins/panel/LoginPanel.exml",UISkinName.UserAngreementPanel="resource/assets/skins/panel/UserAngreementPanel.exml",UISkinName.GameHallPanel="resource/assets/skins/panel/GameHallPanel.exml",UISkinName.MarqueePanel="resource/assets/skins/panel/MarqueePanel.exml",UISkinName.PayPanel="resource/assets/skins/panel/PayPanel.exml",UISkinName.CreateRoomPanel="resource/assets/skins/panel/CreateRoomPanel.exml",UISkinName.SettingPanel="resource/assets/skins/panel/SettingPanel.exml",UISkinName.TextInfoPanel="resource/assets/skins/panel/TextInfoPanel.exml",UISkinName.JoinInRoomPanel="resource/assets/skins/panel/JoinInRoomPanel.exml",UISkinName.RegisterPanel="resource/assets/skins/panel/RegisterPanel.exml",UISkinName.LoginLocalPanel="resource/assets/skins/panel/LoginLocalPanel.exml",UISkinName.LoginBar="resource/assets/skins/panel/LoginBar.exml",UISkinName.EnterLoginPanel="resource/assets/skins/panel/EnterLoginPanel.exml",UISkinName.RoundInfoPanel="resource/assets/skins/panel/RoundInfoPanel.exml",UISkinName.GameScenePanel="resource/assets/skins/panel/GameScenePanel.exml",UISkinName.LoadingSwitchPanel="resource/assets/skins/panel/LoadingSwitchPanel.exml",UISkinName.TingInfoPanel="resource/assets/skins/panel/TingInfoPanel.exml",UISkinName.OnceResultPanel="resource/assets/skins/panel/OnceResultPanel.exml",UISkinName.GameOverPanel="resource/assets/skins/panel/GameOverPanel.exml",UISkinName.GangSelectPanel="resource/assets/skins/panel/GangSelectPanel.exml",UISkinName.UserInfoPanel="resource/assets/skins/panel/UserInfoPanel.exml",UISkinName.LoginSceneBgPanel="resource/assets/skins/panel/LoginSceneBgPanel.exml",UISkinName.RoomDisbandOperPanel="resource/assets/skins/panel/RoomDisbandOperPanel.exml",UISkinName.RoomDisbandInfoPanel="resource/assets/skins/panel/RoomDisbandInfoPanel.exml",UISkinName.RoundDetialsPanel="resource/assets/skins/panel/RoundDetialsPanel.exml",UISkinName.ShareGamePanel="resource/assets/skins/panel/ShareGamePanel.exml",UISkinName.AudioRecordingPanel="resource/assets/skins/panel/AudioRecordingPanel.exml",UISkinName.VipPanel="resource/assets/skins/panel/VipPanel.exml",UISkinName.CreateRolePanel="resource/assets/skins/panel/CreateRolePanel.exml",UISkinName.EditUserInfoPanel="resource/assets/skins/panel/EditUserInfoPanel.exml",UISkinName.ChangeUserNamePanel="resource/assets/skins/panel/ChangeUserNamePanel.exml",UISkinName.ShoppingPanel="resource/assets/skins/panel/ShoppingPanel.exml",UISkinName.PlayingFieldPanel="resource/assets/skins/panel/PlayingFieldPanel.exml",UISkinName.KeyBoardPanel="resource/assets/skins/panel/KeyBoardPanel.exml",UISkinName.SetPanel="resource/assets/skins/panel/SetPanel.exml",UISkinName.GameRulePanel="resource/assets/skins/panel/GameRulePanel.exml",UISkinName.EnterRoomPwdPanel="resource/assets/skins/panel/EnterRoomPwdPanel.exml",UISkinName.CreateRoomPwdPanel="resource/assets/skins/panel/CreateRoomPwdPanel.exml",UISkinName.SavePanel="resource/assets/skins/panel/SavePanel.exml",UISkinName.FriendPanel="resource/assets/skins/panel/FriendPanel.exml",UISkinName.MailPanel="resource/assets/skins/panel/MailPanel.exml",UISkinName.ChatPanel="resource/assets/skins/panel/ChatPanel.exml",UISkinName.MyAwardPanel="resource/assets/skins/panel/MyAwardPanel.exml",__reflect(UISkinName.prototype,"UISkinName");var UIRendererSkinName=function(){function e(){}return e}();UIRendererSkinName.PayPanelItemRenderer="resource/assets/skins/renderer/PayPanelItemRenderer.exml",UIRendererSkinName.CreateRoomPanelRenderer="resource/assets/skins/renderer/CreateRoomPanelRenderer.exml",UIRendererSkinName.RoundUserItemRenderer="resource/assets/skins/renderer/RoundUserItemRenderer.exml",UIRendererSkinName.RoundUserListItemRenderer="resource/assets/skins/renderer/RoundUserListItemRenderer.exml",UIRendererSkinName.ShouPaiItemRenderer="resource/assets/skins/renderer/ShouPaiItemRenderer.exml",UIRendererSkinName.TingRenderer="resource/assets/skins/renderer/tingRenderer.exml",UIRendererSkinName.OnceResultItemRenderer="resource/assets/skins/renderer/OnceResultItemRenderer.exml",UIRendererSkinName.OneRoundScoreItemRenderer="resource/assets/skins/renderer/OneRoundScoreItemRenderer.exml",UIRendererSkinName.GameOverItemRenderer="resource/assets/skins/renderer/GameOverItemRenderer.exml",UIRendererSkinName.GangPaiSelectItemRenderer="resource/assets/skins/renderer/GangPaiSelectItemRenderer.exml",UIRendererSkinName.TextRenderer="resource/assets/skins/renderer/TextRenderer.exml",UIRendererSkinName.RoundDetialsItemRenderer="resource/assets/skins/renderer/RoundDetialsItemRenderer.exml",UIRendererSkinName.MyAwardPanelItemRenderer="resource/assets/skins/renderer/MyAwardPanelItemRenderer.exml",UIRendererSkinName.GoldListItemRenderer="resource/assets/skins/renderer/GoldListItemRenderer.exml",UIRendererSkinName.DiamondListItemRenderer="resource/assets/skins/renderer/DiamondListItemrenderer.exml",UIRendererSkinName.VipListItemRenderer="resource/assets/skins/renderer/VipListItemRenderer.exml",UIRendererSkinName.PlayingFieldItemRenderer="resource/assets/skins/renderer/PlayingFieldItemRenderer.exml",UIRendererSkinName.FriendItemRenderer="resource/assets/skins/renderer/FriendItemRenderer.exml",UIRendererSkinName.AchievementItemRenderer="resource/assets/skins/renderer/AchievementItemRenderer.exml",UIRendererSkinName.MailItemRenderer="resource/assets/skins/renderer/MailItemRenderer.exml",UIRendererSkinName.GiftItemRenderer="resource/assets/skins/renderer/GiftItemRenderer.exml",UIRendererSkinName.FriendRequestItemRenderer="resource/assets/skins/renderer/FriendRequestItemRenderer.exml",UIRendererSkinName.AddFriendItemRenderer="resource/assets/skins/renderer/AddFriendItemRenderer.exml",UIRendererSkinName.ChatItemRenderer="resource/assets/skins/renderer/ChatItemRenderer.exml",UIRendererSkinName.FaceItemRenderer="resource/assets/skins/renderer/FaceItemRenderer.exml",UIRendererSkinName.FastChatItemRenderer="resource/assets/skins/renderer/FastChatItemRenderer.exml",__reflect(UIRendererSkinName.prototype,"UIRendererSkinName");var UIComponentSkinName=function(){function e(){}return e}();UIComponentSkinName.RoomUserHeadInfoComponent="resource/assets/skins/component/RoomUserHeadInfoComponent.exml",UIComponentSkinName.TouZiComponent="resource/assets/skins/component/TouZiComponent.exml",UIComponentSkinName.ScoreEffectComponent="resource/assets/skins/component/ScoreEffectComponent.exml",UIComponentSkinName.ActionEffectComponent="resource/assets/skins/component/ActionEffectComponent.exml",UIComponentSkinName.NumComponent="resource/assets/skins/component/NumComponent.exml",UIComponentSkinName.OnceResultCardComponet="resource/assets/skins/cardface/ShouPaiSkin.exml",UIComponentSkinName.CommonIcon="resource/assets/skins/component/CommonIcon.exml",UIComponentSkinName.UserInfoComponent="resource/assets/skins/component/UserInfoComponent.exml",UIComponentSkinName.ButtonSkin2="resource/assets/skins/component/buttonSkin2.exml",__reflect(UIComponentSkinName.prototype,"UIComponentSkinName");var OutCardSkinName=function(){function e(){}return e}();OutCardSkinName.BenJiaOutCard="resource/assets/skins/cardface/BenJiaOutCard.exml",OutCardSkinName.XiaJiaOutCard="resource/assets/skins/cardface/XiaJiaOutCard.exml",OutCardSkinName.DuiJiaOutCard="resource/assets/skins/cardface/DuiJiaOutCard.exml",OutCardSkinName.ShangJiaOutCard="resource/assets/skins/cardface/ShangJiaOutCard.exml",__reflect(OutCardSkinName.prototype,"OutCardSkinName");var LiangPaiSkiName=function(){function e(){}return e}();LiangPaiSkiName.BenJiaLiangCard="resource/assets/skins/cardface/BenJia_LiangPaiSkin.exml",LiangPaiSkiName.XiaJiaLiangCard="resource/assets/skins/cardface/XiaJia_LiangPaiSkin.exml",LiangPaiSkiName.DuiJiaLiangCard="resource/assets/skins/cardface/DuiJia_LiangPaiSkin.exml",LiangPaiSkiName.ShangJiaLiangCard="resource/assets/skins/cardface/ShangJia_LiangPaiSkin.exml",__reflect(LiangPaiSkiName.prototype,"LiangPaiSkiName");var ImageSource=function(){function e(){}return e.getActionEffectImgSource=function(t){switch(t){case ActionType.AnGang:case ActionType.BuGang:case ActionType.Gang:return e.Effect_Gang;case ActionType.Peng:return e.Effect_Peng;case ActionType.Hu:return e.Effect_Hu;case ActionType.Ting:return e.Effect_Ting;case ActionType.MaiMa:return e.Effect_MaiMa}},e}();ImageSource.GrayBg="bg_page4_2_png",ImageSource.YellowCheng="yellow_cheng_png",ImageSource.AnGang="h_angang_png",ImageSource.MingGang="h_minggang_png",ImageSource.DianGang="h_diangang_png",ImageSource.MaiMa="h_maima_png",ImageSource.HuJiaGang="h_hujiagang_png",ImageSource.JiaGang="h_jiagang_png",ImageSource.MaleImg="boy_png",ImageSource.FemaleImg="gril_png",ImageSource.Card_Wall_DuiJia="up_qiang_png",ImageSource.Card_Wall_BenJia="down_qiang_png",ImageSource.Card_Wall_ShangJia="L_qiang_png",ImageSource.Card_Wall_XiaJia="R_qiang_png",ImageSource.BenJia_ShouCard_Bg="mj_bg_png",ImageSource.XiaJia_ShouCard_Bg="L_mj_png",ImageSource.DuiJia_ShouCard_Bg="up_mj_png",ImageSource.ShangJia_ShouCard_Bg="L_mj_png",ImageSource.Out_BenJia_Bg="down_chu_png",ImageSource.Out_XiaJia_Bg="L_chu_png",ImageSource.Out_DuiJia_Bg="up_chu_png",ImageSource.Out_ShangJia_Bg="L_chu_png",ImageSource.ListenerArrow="h_jt_png",ImageSource.Effect_Hu="effect_hu_png",ImageSource.Effect_Ting="effect_ting_png",ImageSource.Effect_MaiMa="effect_maima_png",ImageSource.Effect_Peng="effect_peng_png",ImageSource.Effect_Gang="effect_gang_png",ImageSource.Effect_Chi="effect_chi_png",ImageSource.Default_Head="1001_png",ImageSource.Yellow_MaoHao="yellow_maohao_png",__reflect(ImageSource.prototype,"ImageSource");var ResGroupName=function(){function e(){}return e}();ResGroupName.Preload="preload",ResGroupName.Pub="pub",ResGroupName.Hall="hall",ResGroupName.Carddesk="carddesk",__reflect(ResGroupName.prototype,"ResGroupName");var ResPrefixName=function(){function e(){}return e}();ResPrefixName.Map="map_",ResPrefixName.CardGroup="resource/assets/skins/cardface/",ResPrefixName.NumRed="red_",ResPrefixName.NumGreen="greed_",ResPrefixName.NumYellow="yellow_",ResPrefixName.JiFen="jifen",ResPrefixName.Fen="fen",__reflect(ResPrefixName.prototype,"ResPrefixName");var ResSuffixName=function(){function e(){}return e}();ResSuffixName.JSONSuffix="_json",ResSuffixName.PNGSuffix="_png",ResSuffixName.Mp3Suffix=".mp3",ResSuffixName.Json=".json",__reflect(ResSuffixName.prototype,"ResSuffixName");var PathName=function(){function e(){}return e}();PathName.Map="resource/assets/map/map_",PathName.Piece="resource/assets/images/ui/piece/",PathName.Touzi="dice_",PathName.Sound="resource/assets/sound/",PathName.Config="resource/config/",__reflect(PathName.prototype,"PathName");var MahJongType;!function(e){e[e.None=0]="None",e[e.Tiao=1]="Tiao",e[e.Wan=2]="Wan",e[e.Bin=3]="Bin",e[e.Baida=4]="Baida"}(MahJongType||(MahJongType={}));var StringConstant=function(){function e(){}return e}();StringConstant.empty="",StringConstant.Dot=".",StringConstant.UnderLine="_",StringConstant.Comma=",",__reflect(StringConstant.prototype,"StringConstant");var TextId;!function(e){e[e.None=0]="None",e[e.UserAngreement=1]="UserAngreement",e[e.PlayWay=2]="PlayWay",e[e.RoomCard=101]="RoomCard",e[e.Version=201]="Version",e[e.Info=301]="Info"}(TextId||(TextId={}));var ScrollViewDirection;!function(e){e[e.None=0]="None",e[e.Horizontal_L_R=1]="Horizontal_L_R",e[e.Vertical_T_D=2]="Vertical_T_D"}(ScrollViewDirection||(ScrollViewDirection={}));var OperatePlatform=function(){function e(){}return Object.defineProperty(e,"current",{get:function(){return e.qin},enumerable:!0,configurable:!0}),e}();OperatePlatform.qin="qin",OperatePlatform.cn="cn",__reflect(OperatePlatform.prototype,"OperatePlatform");var ChannelType=function(){function e(){}return e}();ChannelType.guest="guest",ChannelType.qin="qin",__reflect(ChannelType.prototype,"ChannelType");var SystemReenterType;!function(e){e[e.Normal=1]="Normal",e[e.Logout=2]="Logout",e[e.LangSetting=3]="LangSetting"}(SystemReenterType||(SystemReenterType={}));var Sex;!function(e){e[e.Unknown=0]="Unknown",e[e.Male=1]="Male",e[e.Female=2]="Female"}(Sex||(Sex={}));var Pattern;!function(e){e[e.AllIn=0]="AllIn",e[e.Fast=1]="Fast",e[e.Ante=2]="Ante",e[e.NoUpperLimit=3]="NoUpperLimit"}(Pattern||(Pattern={}));var PosType;!function(e){e[e.BenJia=1]="BenJia",e[e.XiaJia=2]="XiaJia",e[e.DuiJia=3]="DuiJia",e[e.ShangJia=4]="ShangJia"}(PosType||(PosType={}));var GroupCardType;!function(e){e[e.PengXiaJia=1]="PengXiaJia",e[e.PengDuiJia=2]="PengDuiJia",e[e.PengShangJia=3]="PengShangJia",e[e.GangXiaJia=4]="GangXiaJia",e[e.GangDuiJia=5]="GangDuiJia",e[e.GangShangJia=6]="GangShangJia",e[e.AnGang=7]="AnGang"}(GroupCardType||(GroupCardType={}));var ActionType;!function(e){e[e.Peng=1]="Peng",e[e.Gang=2]="Gang",e[e.AnGang=3]="AnGang",e[e.BuGang=4]="BuGang",e[e.Ting=5]="Ting",e[e.Hu=6]="Hu",e[e.Pass=7]="Pass",e[e.MaiMa=8]="MaiMa"}(ActionType||(ActionType={}));var RoomState;!function(e){e[e.TAKE=1]="TAKE",e[e.PUT=2]="PUT",e[e.HU=3]="HU",e[e.WAIT=4]="WAIT",e[e.NIL=5]="NIL"}(RoomState||(RoomState={}));var PlayModeType;!function(e){e[e.Usual=1]="Usual",e[e.Hu8=2]="Hu8"}(PlayModeType||(PlayModeType={}));var HuResultType;!function(e){e[e.LiuJu=0]="LiuJu",e[e.Usual=1]="Usual",e[e.JiaGang=2]="JiaGang"}(HuResultType||(HuResultType={}));var NumResType;!function(e){e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow"}(NumResType||(NumResType={}));var MusicAction=function(){function e(){}return e}();MusicAction.pai="1",MusicAction.peng="peng",MusicAction.hu="hu",MusicAction.maima="maima",MusicAction.ting="ting",MusicAction.gang="gang",MusicAction.lost="lost",MusicAction.win="win",MusicAction.buttonClick="buttonClick",MusicAction.cardClick="cardClick",MusicAction.fapai="fapai",__reflect(MusicAction.prototype,"MusicAction");var MusicResEnum=function(){function e(){}return e.getBgSoundRes=function(t){switch(t){case SceneType.Login:case SceneType.Hall:return e.Login_Hall;case SceneType.Game:return e.Game}return StringConstant.empty},e}();MusicResEnum.Login_Hall="bg_hall",MusicResEnum.Game="bg_playing",__reflect(MusicResEnum.prototype,"MusicResEnum");var ScoreChangeType;!function(e){e[e.None=0]="None",e[e.MaiMa=1]="MaiMa"}(ScoreChangeType||(ScoreChangeType={}));var SeparatorType=function(){function e(){}return e}();SeparatorType.semicolon=";",__reflect(SeparatorType.prototype,"SeparatorType");var RoomQuitState;!function(e){e[e.Wait=0]="Wait",e[e.Refuse=1]="Refuse",e[e.Argree=2]="Argree",e[e.ReqQuit=3]="ReqQuit"}(RoomQuitState||(RoomQuitState={}));var MovieClipData=function(){function e(){}return e}();MovieClipData.SaiZi_Json="saizi_json",MovieClipData.SaiZi_Png="saizi_png",__reflect(MovieClipData.prototype,"MovieClipData");var VipCard;!function(e){e[e.WeekVip=101]="WeekVip",e[e.MonthVip=102]="MonthVip"}(VipCard||(VipCard={}));var PlayingFieldPattern;!function(e){e[e.PrimaryPattern=1]="PrimaryPattern",e[e.MiddlePattern=2]="MiddlePattern",e[e.HighPattern=3]="HighPattern"}(PlayingFieldPattern||(PlayingFieldPattern={}));var IsReceive;!function(e){e[e.Receive=1]="Receive",e[e.NotREceive=0]="NotREceive"}(IsReceive||(IsReceive={}));var PropertyId;!function(e){e[e.gold=1]="gold",e[e.diamond=2]="diamond",e[e.vipExp=3]="vipExp",e[e.exp=4]="exp"}(PropertyId||(PropertyId={}));var FriendInfoType;!function(e){e[e.Receive=1]="Receive",e[e.Send=2]="Send"}(FriendInfoType||(FriendInfoType={}));var ActionDispatcher=function(){function e(){this._list=new Array}return e.prototype.destroy=function(){this._list=null},e.prototype.clear=function(){this._list.length=0},Object.defineProperty(e.prototype,"count",{get:function(){return this._list.length},enumerable:!0,configurable:!0}),e.prototype.addListener=function(e,t){t&&(e.thisObject=t);for(var n=0,i=this._list;n<i.length;n++){var a=i[n];if(a==e)return}this._list.push(e)},e.prototype.removeListener=function(e){for(var t,n=0;n<this._list.length;n++)if(t=this._list[n],t==e){this._list.splice(n,1);break}},e.prototype.dispatch=function(e){for(var t,n=this._list.length,i=0;i<this._list.length;i++)t=this._list[i],t.thisObject?void 0==e?t.call(t.thisObject):t.call(t.thisObject,e):void 0==e?t():t(e),this._list.length<n&&(i-=n-this._list.length)},e}();__reflect(ActionDispatcher.prototype,"ActionDispatcher");var CallDispatcher=function(){function e(){this._map=new Dictionary}return e.prototype.dispose=function(){this._map=null},e.prototype.clear=function(){this._map.clear()},Object.defineProperty(e.prototype,"count",{get:function(){return this._map.count},enumerable:!0,configurable:!0}),e.prototype.addListener=function(e,t,n){n&&(t.thisObject=n);var i=this._map.getValue(e);if(i){for(var a=0,o=i;a<o.length;a++){var r=o[a];if(r==t)return}i.push(t)}else i=new Array,i.push(t),this._map.add(e,i)},e.prototype.removeListener=function(e,t){var n=this._map.getValue(e);if(n)for(var i=void 0,a=0;a<n.length;a++)if(i=n[a],i==t){n.splice(a,1);break}},e.prototype.dispatch=function(e,t){var n=this._map.getValue(e);if(n)for(var i=n.length,a=void 0,o=0;o<n.length;o++)a=n[o],a.thisObject?void 0==t?a.call(a.thisObject):a.call(a.thisObject,t):void 0==t?a():a(t),n.length<i&&(o-=i-n.length)},e}();__reflect(CallDispatcher.prototype,"CallDispatcher");var BaseShouPaiHandler=function(){function e(e){this._moveMinPos=1,this._moveMaxPos=13,this._showFaIndex=0,this.layerContainer=e,this._needMoveList=new Array,this._lastPit=new MoveCardPit,this.pitList=new Array,this._outProxyPit=new MoveCardPit,this._cardList=new Array}return e.prototype.init=function(e,t){if(this._showFaIndex=0,CardShowDefined.GetInstance().shouPaiMap&&(this._shouPaiPosList=CardShowDefined.GetInstance().shouPaiMap.getValue(this._posType)),CardShowDefined.GetInstance().liangPaiMap&&(this._liangPaiPosList=CardShowDefined.GetInstance().liangPaiMap.getValue(this._posType),this._liangPaiPosList.sort(SortUtil.sortCardById)),this._shouPaiPosList){var n=void 0,i=void 0,a=this._shouPaiPosList.length;this._shouPaiPosList.sort(SortUtil.sortCardById);for(var o=void 0,r=0;a-1>r;r++)n=this._shouPaiPosList[r],i=this.createCard(e,n,r),i.visible=t,o=new MoveCardPit,o.card=i,o.def=n,this.pitList.push(o),this._cardList.push(i);this._pitLen=this.pitList.length,this.createLastCard(e,a-1)}},e.prototype.setPit=function(e){for(var t,n=0;n<this._pitLen;n++)t=this.pitList[n],t.card=this._cardList[n],t.card.visible=e},e.prototype.showByY=function(){},e.prototype.createLastCard=function(e,t){var n=this._shouPaiPosList[t],i=this.createCard(e,n,t);this._lastPit.def=n,i.isLastCard=!0,this._lastPit.card=i,this.hideLastCard()},e.prototype.createCard=function(e,t,n){var i=new e(t,n+1);return i.x=t.x,i.y=t.y,this._initY=t.y,i.setScale(t.scale),this.layerContainer.addChild(i),i},e.prototype.exactlyCard=function(e,t){if(RoomManager.roomInfo){var n=RoomManager.getPosByPosTypeForMine(this._posType);if(this.playerInfo=RoomManager.getPlayerInfoByPos(n),this.playerInfo){this.tryImmediatelyMoveOver();var i=this.playerInfo.shouPaiNum,a=n==RoomManager.roomInfo.pos&&RoomManager.roomInfo.play==RoomState.PUT;a&&i--;for(var o,r=0,s=0;s<this._pitLen&&!(r>i);s++)o=this.pitList[s],o.card&&(this.refreshPit(o,e),this.layerContainer.addChild(o.card)),r++;for(var l=this._pitLen-i,s=0;l>s;s++)this.pitList[s].card.visible=!1;this.showByY(),a?this.setNewCard(void 0):this.hideLastCard()}else for(var c=0,h=this.pitList;c<h.length;c++){var d=h[c];d.card&&(d.card.visible=!1,d.card=null)}}},e.prototype.refreshPit=function(e,t){void 0===t&&(t=!0),e&&e.def&&e.card&&(e.card.visible=t,e.card.x=e.def.x,e.card.y=e.def.y,e.card.setScale(e.def.scale))},e.prototype.get4Card=function(){this._showFaIndex++;var e=4*this._showFaIndex,t=this._pitLen;t=Math.min(e,t);for(var n,i=0;t>i;i++)n=this.pitList[i],this.refreshPit(n),this._posType==PosType.BenJia&&n.card.refreshFace(RoomManager.roomInfo.shouPai[i]);this._pitLen>=e?RoomManager.updateHead(4):RoomManager.updateHead(1)},e.prototype.setNewCard=function(e){GoCardProcessManager.isReady&&(this.tryImmediatelyMoveOver(),this._lastPit.card.refreshFace(e),this._lastPit.card.visible=!0,void 0!=this._initY&&(this._lastPit.card.y=this._initY))},e.prototype.hideLastCard=function(){this._lastPit&&(this._lastPit.card.visible=!1)},e.prototype.outCard=function(e,t){var n=this.getRandomPit();n&&(this.tryImmediatelyMoveOver(),this._outIndex=this.pitList.indexOf(n),this._outProxyPit.card=n.card,n.card.visible=!1)},e.prototype.showLiangPai=function(e,t,n){this._liangCardList||(this._liangCardList=new Array);for(var i=0;i<this._cardList.length;i++)this._cardList[i].visible=!1;if(this.hideLastCard(),this.clearLiangCard(),void 0!=t&&void 0!=n)if(n==HuResultType.JiaGang){var a=ArrayUtil.RemoveItem(t,e);a&&e.unshift(t)}else if(n==HuResultType.Usual){var a=ArrayUtil.RemoveItem(t,e);a&&e.unshift(t)}var o,r,s=this._liangCardList.length,l=e.length,c=2;void 0!=t&&(c=1);for(var h=this._liangPaiPosList.length-c,i=0;l>i;i++)r=this._liangPaiPosList[h-i],i>s-1?(o=new LiangCard(r),this._liangCardList.push(o)):o=this._liangCardList[i],o.visible=!0,o.x=r.x,o.y=r.y,o.init(e[i]);if(s=this._liangCardList.length,this._posType==PosType.ShangJia)for(var i=s-1;i>=0;i--)o=this._liangCardList[i],o&&this.layerContainer.addChild(o);else for(var i=0;s>i;i++)o=this._liangCardList[i],o&&this.layerContainer.addChild(o)},e.prototype.findPit=function(e){for(var t=0,n=this.pitList;t<n.length;t++){var i=n[t];if(i.card==e)return i}return null},e.prototype.startInsertCard=function(e){if(this._isInserting&&this.tryImmediatelyMoveOver(),ArrayUtil.Clear(this._needMoveList),this._nowInsertPit=this.getRandomPit(),this._nowInsertPit&&this._nowInsertPit.card&&this._outProxyPit.card&&this._lastPit.card.visible){this._isInserting=!0,this._outProxyPit.card.x=this._lastPit.def.x,this._outProxyPit.card.y=this._lastPit.def.y,this._outProxyPit.card.visible=!0;var t=this.pitList.indexOf(this._nowInsertPit),n=void 0;if(t>this._outIndex){this._isReverse=!0;for(var i=this._outIndex+1;t>=i;i++)n=this.pitList[i],n.targetPit=this.pitList[i-1],this._needMoveList.push(n)}else if(t<this._outIndex){this._isReverse=!1;for(var i=t;i<this._outIndex;i++)n=this.pitList[i],n.targetPit=this.pitList[i+1],this._needMoveList.push(n)}}},e.prototype.playInsert=function(){},e.prototype.test=function(){this.tryImmediatelyMoveOver()},e.prototype.tryImmediatelyMoveOver=function(){this._isInserting&&this.immediatelyMoveOver()},e.prototype.immediatelyMoveOver=function(){this._outProxyPit.card.x=this._nowInsertPit.def.x,this._outProxyPit.card.y=this._nowInsertPit.def.y,this._outProxyPit.card.visible=!0,this._outProxyPit.card.rotation=0;for(var e,t=this._needMoveList.length,n=0;t>n;n++)e=this._needMoveList[n],e.card.x=e.targetPit.def.x,e.card.y=e.targetPit.def.y;this.moveOver()},e.prototype.moveOver=function(){this._isInserting=!1;var e,t=this._needMoveList.length;if(this.removeAllTweens(),this._isReverse)for(var n=0;t>n;n++)e=this._needMoveList[n],e.targetPit.card=e.card;else for(var n=t-1;n>=0;n--)e=this._needMoveList[n],e.targetPit.card=e.card;this._nowInsertPit.card=this._outProxyPit.card},e.prototype.removeAllTweens=function(){for(var e,t=0;t<this._pitLen;t++)e=this.pitList[t],e&&e.card&&egret.Tween.removeTweens(e.card);this._outProxyPit&&this._outProxyPit.card&&egret.Tween.removeTweens(this._outProxyPit.card),this._lastPit&&this._lastPit.card&&egret.Tween.removeTweens(this._lastPit.card)},e.prototype.getInsertPit=function(e){return this.getRandomPit()},e.prototype.getRandomPit=function(){for(var e,t=this.pitList.length,n=new Array,i=0;t>i;i++)e=this.pitList[i],e.card&&e.card.visible&&n.push(e);var a=MathUtil.getRandom(0,n.length-1);return void 0!=a?n[a]:null},e.prototype.onEnable=function(){},e.prototype.onDisable=function(){},e.prototype.clear=function(){for(var e,t=0;t<this._pitLen;t++)e=this.pitList[t],e.clear();ArrayUtil.Clear(this._needMoveList),this._showFaIndex=0;for(var n=0,i=this._cardList;n<i.length;n++){var a=i[n];a.visible=!1,a.clear()}this._isInserting=!1,this._lastPit.card.clear(),this.hideLastCard(),this.clearLiangCard(),this.onDisable()},e.prototype.clearLiangCard=function(){if(this._liangCardList)for(var e=0,t=this._liangCardList;e<t.length;e++){var n=t[e];n.visible=!1}},e.prototype.sortCard=function(e,t){return e.cardNum>t.cardNum?1:e.cardNum<t.cardNum?-1:0},e}();__reflect(BaseShouPaiHandler.prototype,"BaseShouPaiHandler");var MoveCardPit=function(){function e(){}return e.prototype.clear=function(){this.targetPit=null},e}();__reflect(MoveCardPit.prototype,"MoveCardPit");var RoomDisbandInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.layer=UILayerType.Tips,t.skinName=UISkinName.RoomDisbandInfoPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.refreshPanel=function(){this.onRender(null)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t);var n,i=StringConstant.empty;if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList)for(var a=void 0,o=0;o<RoomManager.roomInfo.playerList.length;o++)switch(a=RoomManager.roomInfo.playerList[o],a.quit){case RoomQuitState.Wait:i+=a.name+"等待选择\n";break;case RoomQuitState.ReqQuit:n=a.name;break;case RoomQuitState.Refuse:i+=a.name+"已拒绝\n";break;case RoomQuitState.Argree:i+=a.name+"已同意\n"}var r=ProjectDefined.GetInstance().getValue(ProjectDefined.waitDisbandTime),s=Math.ceil(r/60);this.headLabel.text="玩家"+n+"申请解散房间，请等待其他玩家选择(超过"+s+"分钟未做选择，则默认同意)",this.infoLabel.text=i,this.showTime()},t.prototype.showTime=function(){var e=RoomManager.remainTimeStr;this.timeLabel.text=e,e||this.onCloseBtnClickHandler(null)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),Tick.getInstance().AddSecondsInvoke(this.showTime,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),Tick.getInstance().RemoveSecondsInvoke(this.showTime)},t}(BasePanel);__reflect(RoomDisbandInfoPanel.prototype,"RoomDisbandInfoPanel");var ChatManager=function(){function e(){}return e.initialzie=function(){e.messageList||(e.messageList=new Array),ArrayUtil.Clear(e.messageList),SocketManager.AddCommandListener(Command.Rec_Message_2014,e.pushChatMessage,this)},e.pushChatMessage=function(t){if(t.data){var n=PoolUtil.GetObject(ChatInfo);n.roleId=t.data.roleId,n.message=t.data.message,n.type=t.data.type,n.name=t.data.name,n.type==ChatMessageType.Maquee?e.messageList.push(n):e.CheckAndPlay(n),e.dispatchChatEvent()}},e.SendAudioRecordMessage=function(t,n,i,a,o){e.SendChatMessage(ChatSpecialStrings.AudioRecordMessage+n+StringConstant.Comma+i+StringConstant.Comma+a+StringConstant.Comma+o,t)},e.SendChatMessage=function(t,n){var i=function(a){SocketManager.RemoveCommandListener(Command.Req_Send_ChatMessage_3019,i),e.OnChatSendMessageFromServer(a,t,n)};SocketManager.AddCommandListener(Command.Req_Send_ChatMessage_3019,i),SocketManager.Send(Command.Req_Send_ChatMessage_3019,{message:t,type:n})},e.OnChatSendMessageFromServer=function(t,n,i){var a=e.CreateChatInfoByMyInfo(i,n);e.DispatchMessageSend(a)},e.CheckAndPlay=function(t){e._checkList||(e._checkList=new Array),-1==e._checkList.indexOf(t)&&e._checkList.push(t);var n=t.param[1];ChannelManager.hasRecordData(n)},e.checkComplete=function(t){var n=JSON.parse(t);if(n){var i=n.guid,a=StringUtil.toBoolean(n.has),o=e.getRecordChatInfo(i);o&&(a?RecordAudioManager.playingGuid!=i&&(ChannelManager.playRecord(i),RecordAudioManager.PlayPauseAndResume(i,parseInt(o.param[0]))):RecordAudioManager.DownloadAmrData(o.param[3],i,parseInt(o.param[0])))}},e.getRecordChatInfo=function(t){for(var n=0,i=e._checkList;n<i.length;n++){var a=i[n];if(a.param[1]==t)return a}return null},e.removeRecordChatInfo=function(t){for(var n=0,i=e._checkList;n<i.length;n++){var a=i[n];if(a.param[1]==t){ArrayUtil.RemoveItem(a,e._checkList);break}}},e.CreateChatInfoByMyInfo=function(e,t){var n=new ChatInfo;return n.roleId=UserManager.userInfo.roleId,n.type=e,n.message=t,n.name=UserManager.userInfo.name,n},e.messageOper=function(){if(!e.isOnMessage&&e.messageList.length>0){var t=e.messageList.shift();t.type==ChatMessageType.Maquee?UIManager.showPanel(UIModuleName.MarqueePanel,t.message):t.type==ChatMessageType.InRoom&&e.CheckAndPlay(t),PoolUtil.PutObject(t)}},e.nextMessage=function(){e.isOnMessage=!1,e.messageOper()},e.reqSendChatMsg=function(t,n){if(n==ChatMessageType.Maquee){var i=e.CreateChatInfoByMyInfo(n,t);e.onSendChatMsgEvent.dispatch(i)}else{var i=new Object;i.message=t,i.type=ChatMessageType.InRoom,e.onSendChatMsgEvent.dispatch(i)}},e.dispatchChatEvent=function(){e.pushChatMessageEa.dispatch()},e.DispatchMessageSend=function(t){null!=e.OnMessageSend&&e.OnMessageSend.dispatch(t)},e}();ChatManager.pushChatMessageEa=new ActionDispatcher,ChatManager.onSendChatMsgEvent=new ActionDispatcher,ChatManager.OnMessageSend=new ActionDispatcher,__reflect(ChatManager.prototype,"ChatManager");var ChatInfo=function(){function e(){}return Object.defineProperty(e.prototype,"message",{get:function(){return this._message},set:function(e){this._message=e,this.ParseMessageParams()},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.roleId=void 0,this.message=void 0,this.type=void 0},e.prototype.ParseMessageParams=function(){if(this.message&&0==this.message.indexOf(ChatSpecialStrings.AudioRecordMessage)){var e=this.message.substring(ChatSpecialStrings.AudioRecordMessage.length),t=e.split(StringConstant.Comma);4==t.length&&(this.param=t)}},e}();__reflect(ChatInfo.prototype,"ChatInfo",["IPoolObject","Object"]);var ChatMessageType;!function(e){e[e.InRoom=1]="InRoom",e[e.Maquee=2]="Maquee"}(ChatMessageType||(ChatMessageType={}));var ChatChannelInfo=function(){function e(){}return e}();__reflect(ChatChannelInfo.prototype,"ChatChannelInfo");var ChatSpecialStrings=function(){function e(){}return e}();ChatSpecialStrings.AudioRecordMessage="#AudioRecordMessage#",ChatSpecialStrings.ShareVcr="#ShareVcr#",ChatSpecialStrings.OpenModule="#OpenModule#",__reflect(ChatSpecialStrings.prototype,"ChatSpecialStrings");var Face=function(){function e(){}return e}();__reflect(Face.prototype,"Face");var ShouPaiBenJiaHandler=function(e){function t(t){var n=e.call(this,t)||this;return n._posType=PosType.BenJia,n}return __extends(t,e),t.prototype.init=function(t,n){e.prototype.init.call(this,t,n)},t.prototype.exactlyCard=function(e,t){if(RoomManager.roomInfo&&RoomManager.roomInfo.shouPai){this.tryImmediatelyMoveOver(),this.playerInfo=RoomManager.getPlayerInfoByPosType(PosType.BenJia);var n=0;RoomManager.roomInfo.myLastCard&&RoomManager.isSelfAction&&!t&&ArrayUtil.RemoveItem(RoomManager.roomInfo.myLastCard,RoomManager.roomInfo.shouPai,1),RoomManager.roomInfo.shouPai.sort(SortUtil.downSort);for(var i=RoomManager.roomInfo.shouPai.length,a=void 0,o=this._pitLen-1;o>=0&&!(n>i);o--)a=this.pitList[o],this.refreshPit(a),a.card.refreshFace(RoomManager.roomInfo.shouPai[n]),n++;RoomManager.roomInfo.myLastCard&&RoomManager.isSelfAction&&!t?(RoomManager.roomInfo.shouPai.push(RoomManager.roomInfo.myLastCard),this.setNewCard(RoomManager.roomInfo.myLastCard)):this.hideLastCard();for(var r=this._pitLen-i,o=0;r>o;o++)this.pitList[o].card.visible=!1}},t.prototype.outCard=function(e,t){var n;if(t)return void(this._lastPit.card.visible=!1);if(n=this.findPit(e),e==this._lastPit.card)this._lastPit.card.visible=!1;else{if(!n)return;this._outIndex=this.pitList.indexOf(n),this._outProxyPit.card=n.card,n.card.visible=!1}},t.prototype.startInsertCard=function(e){if(this._isInserting&&this.tryImmediatelyMoveOver(),ArrayUtil.Clear(this._needMoveList),this._nowInsertPit=this.getInsertPit(e),this._nowInsertPit&&this._outProxyPit.card&&this._lastPit.card.visible){this._isInserting=!0;var t=this.pitList.indexOf(this._nowInsertPit),n=void 0;if(void 0!=this._outIndex&&void 0!=t&&-1!=t){if(this._outIndex>t){n=this.pitList[t],e>=n.card.cardNum&&(t+=1,this._nowInsertPit=this.pitList[t]);for(var i=t;i<this._outIndex;i++)n=this.pitList[i],n.targetPit=this.pitList[i+1],this._needMoveList.push(n);
this._isReverse=!1}else if(this._outIndex<t){for(var i=this._outIndex+1;t>=i;i++)n=this.pitList[i],n.targetPit=this.pitList[i-1],this._needMoveList.push(n);this._isReverse=!0}this._outProxyPit.card.x=this._lastPit.def.x,this._outProxyPit.card.y=this._lastPit.def.y,this._outProxyPit.card.refreshFace(e),this._outProxyPit.card.visible=!0}this._newCardTween=egret.Tween.get(this._outProxyPit.card);var a=this._nowInsertPit.def;12==t?(this._moveTime=500,this._newCardTween.to({x:a.x},this._moveTime,egret.Ease.quintOut).call(this.moveOver.bind(this)),this.playInsert()):(this._moveTime=300,this._newCardTween.to({rotation:15},200).to({y:a.y-127},200).to({x:a.x},300,egret.Ease.quintOut).to({rotation:0},100,egret.Ease.sineOut).call(this.playInsert.bind(this)).to({y:a.y},this._moveTime,egret.Ease.quadInOut).call(this.moveOver.bind(this))),this._newCardTween.play(),this.hideLastCard()}},t.prototype.getInsertPit=function(e){for(var t,n,i=this._pitLen-1;i>=0;i--)if(t=this.pitList[i],t.card&&t.card.visible){if(n=t,t.card.cardNum<=e)return t;if(t.card.cardNum<e)return t}if(!n)return this.pitList[this._pitLen-1];var a=this.pitList.indexOf(n);return this._outIndex>a?this.pitList[a]:(1>a&&(a=1),this.pitList[a-1])},t.prototype.playInsert=function(){if(this._isInserting){e.prototype.playInsert.call(this);for(var t=this._needMoveList.length,n=void 0,i=void 0,a=0;t>a;a++)i=this._needMoveList[a],n=egret.Tween.get(i.card,{}),n.to({x:i.targetPit.def.x},this._moveTime,egret.Ease.quintOut),n.play();console.log("播放插入动画！")}else console.log("本家插牌调用异常！")},t.prototype.immediatelyMoveOver=function(){e.prototype.immediatelyMoveOver.call(this)},t.prototype.moveOver=function(){e.prototype.moveOver.call(this)},t.prototype.showArrow=function(e){for(var t,n=this.pitList.length,i=0;n>i;i++)t=this.pitList[i],t.card&&void 0!=e&&t.card.cardNum==e&&t.card.setArrow(!0);this._lastPit&&void 0!=e&&this._lastPit.card.cardNum==e&&this._lastPit.card.setArrow(!0)},t.prototype.hideArrow=function(){for(var e,t=this.pitList.length,n=0;t>n;n++)e=this.pitList[n],e.card&&e.card.setArrow(!1);this._lastPit&&this._lastPit.card.setArrow(!1)},t}(BaseShouPaiHandler);__reflect(ShouPaiBenJiaHandler.prototype,"ShouPaiBenJiaHandler");var ShouPaiDuiJiaHandler=function(e){function t(t){var n=e.call(this,t)||this;return n._posType=PosType.DuiJia,n}return __extends(t,e),t.prototype.init=function(t,n){e.prototype.init.call(this,t,n),this._shouPaiPosList&&this.exactlyCard(n)},t.prototype.startInsertCard=function(t){if(e.prototype.startInsertCard.call(this,t),this._nowInsertPit&&this._nowInsertPit&&this._outProxyPit.card&&this._lastPit.card.visible){this._newCardTween=egret.Tween.get(this._outProxyPit.card);var n=this._nowInsertPit.def;this._newCardTween.to({rotation:-15},200).to({y:n.y-50},200).to({x:n.x},300,egret.Ease.quintOut).to({rotation:0},100).call(this.playInsert.bind(this)).to({y:n.y},200,egret.Ease.quadInOut).call(this.moveOver.bind(this)),this._newCardTween.play(),this.hideLastCard()}},t.prototype.playInsert=function(){if(this._isInserting){e.prototype.playInsert.call(this);for(var t=this._needMoveList.length,n=void 0,i=void 0,a=0;t>a;a++)i=this._needMoveList[a],n=egret.Tween.get(i.card),n.to({x:i.targetPit.def.x},200,egret.Ease.quintOut),n.play()}else console.log("对家插牌动画调用异常！")},t.prototype.moveOver=function(){e.prototype.moveOver.call(this)},t}(BaseShouPaiHandler);__reflect(ShouPaiDuiJiaHandler.prototype,"ShouPaiDuiJiaHandler");var ShouPaiShangJiaHandler=function(e){function t(t){var n=e.call(this,t)||this;return n._posType=PosType.ShangJia,n}return __extends(t,e),t.prototype.init=function(t,n){e.prototype.init.call(this,t,n),this._shouPaiPosList&&(this.exactlyCard(n),this.layerContainer.addChildAt(this._lastPit.card,this._shouPaiPosList.length-1)),this.onEnable()},t.prototype.setNewCard=function(t){e.prototype.setNewCard.call(this,t),this.layerContainer.addChild(this._lastPit.card)},t.prototype.exactlyCard=function(t,n){e.prototype.exactlyCard.call(this,t,n)},t.prototype.showByY=function(){for(var e,t=0;t<this._pitLen;t++)e=this.pitList[t],e.card&&e.card.visible&&(this.refreshPit(e),this.layerContainer.addChild(e.card))},t.prototype.startInsertCard=function(t){if(e.prototype.startInsertCard.call(this,t),this._nowInsertPit&&this._nowInsertPit&&this._outProxyPit.card&&this._lastPit.card.visible){this.layerContainer.addChild(this._outProxyPit.card),this._newCardTween=egret.Tween.get(this._outProxyPit.card);var n=this._nowInsertPit.def;this._newCardTween.to({rotation:5},200).to({y:this._outProxyPit.card.y-120,x:this._outProxyPit.card.x+15},200).to({x:n.x,y:n.y-50},300,egret.Ease.quintOut).to({rotation:0},100).call(this.playInsert.bind(this)).to({y:n.y},200,egret.Ease.quadInOut).call(this.moveOver.bind(this)),this._newCardTween.play(),this.hideLastCard()}},t.prototype.tryImmediatelyMoveOver=function(){e.prototype.tryImmediatelyMoveOver.call(this),this.showByY()},t.prototype.playInsert=function(){if(this._isInserting){this._isInsertTarget=!0;for(var e=this._needMoveList.length,t=void 0,n=void 0,i=0;e>i;i++)n=this._needMoveList[i],t=egret.Tween.get(n.card),t.to({x:n.targetPit.def.x,y:n.targetPit.def.y},200,egret.Ease.quintOut),t.play()}else console.log("上家插牌动画调用异常")},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),GameManager.stage.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),GameManager.stage.removeEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.update=function(e){this._isInsertTarget&&this.showByY()},t.prototype.moveOver=function(){e.prototype.moveOver.call(this),this._isInsertTarget=!1,this.showByY()},t.prototype.get4Card=function(){this._showFaIndex++;var e=4*this._showFaIndex,t=this._pitLen;t=Math.min(e,t);for(var n,i=0;t>i;i++)n=this.pitList[i],this.refreshPit(n),n.card&&this.layerContainer.addChild(n.card);this._pitLen>=e?RoomManager.updateHead(4):RoomManager.updateHead(1)},t}(BaseShouPaiHandler);__reflect(ShouPaiShangJiaHandler.prototype,"ShouPaiShangJiaHandler");var ShouPaiXiaJiaHandler=function(e){function t(t){var n=e.call(this,t)||this;return n._posType=PosType.XiaJia,n}return __extends(t,e),t.prototype.init=function(t,n){e.prototype.init.call(this,t,n),this._shouPaiPosList&&(this.exactlyCard(n),this.layerContainer.addChildAt(this._lastPit.card,0)),this.onEnable()},t.prototype.exactlyCard=function(t,n){e.prototype.exactlyCard.call(this,t,n)},t.prototype.showByY=function(){for(var e,t=this._pitLen-1;t>=0;t--)e=this.pitList[t],e.card&&e.card.visible&&(this.refreshPit(e),this.layerContainer.addChild(e.card))},t.prototype.startInsertCard=function(t){if(e.prototype.startInsertCard.call(this,t),this._nowInsertPit&&this._nowInsertPit.card&&this._outProxyPit.card&&this._lastPit.card.visible){this.layerContainer.addChild(this._outProxyPit.card),this._newCardTween=egret.Tween.get(this._outProxyPit.card);var n=this._nowInsertPit.def;this._newCardTween.to({rotation:5},200).to({y:this._outProxyPit.card.y-50},200).to({x:n.x,y:n.y-50},300,egret.Ease.quintOut).to({rotation:0},100).call(this.playInsert.bind(this)).to({y:n.y},200,egret.Ease.quadInOut).call(this.moveOver.bind(this)),this._newCardTween.play(),this.hideLastCard()}},t.prototype.playInsert=function(){if(this._isInserting){this._isInsertTarget=!0;for(var e=this._needMoveList.length,t=void 0,n=void 0,i=0;e>i;i++)n=this._needMoveList[i],t=egret.Tween.get(n.card),t.to({x:n.targetPit.def.x,y:n.targetPit.def.y},200,egret.Ease.quintOut),t.play()}else console.log("下家插牌动画，调用异常！")},t.prototype.tryImmediatelyMoveOver=function(){e.prototype.tryImmediatelyMoveOver.call(this),this.showByY()},t.prototype.onEnable=function(){e.prototype.onEnable.call(this),GameManager.stage.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.onDisable=function(){e.prototype.onDisable.call(this),GameManager.stage.removeEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.update=function(e){this._isInsertTarget&&this.showByY()},t.prototype.moveOver=function(){e.prototype.moveOver.call(this),this._isInsertTarget=!1,this.showByY()},t.prototype.setNewCard=function(t){e.prototype.setNewCard.call(this,t),GoCardProcessManager.isReady&&this.layerContainer.addChildAt(this._lastPit.card,0)},t.prototype.get4Card=function(){this._showFaIndex++;var e=4*this._showFaIndex,t=this._pitLen;t=Math.min(e,t);for(var n,i=t-1;i>=0;i--)n=this.pitList[i],this.refreshPit(n),n.card&&this.layerContainer.addChild(n.card);this._pitLen>=e?RoomManager.updateHead(4):RoomManager.updateHead(1)},t}(BaseShouPaiHandler);__reflect(ShouPaiXiaJiaHandler.prototype,"ShouPaiXiaJiaHandler");var LayerContainer=function(e){function t(t){var n=e.call(this)||this;return n.layer=t,n}return __extends(t,e),t}(eui.Component);__reflect(LayerContainer.prototype,"LayerContainer");var LayerController=function(){function e(){}return e.prototype.init=function(e){this._group=e,this._duiJiaGrouplayerContainer=new LayerContainer(GameSetting.DuiJiaGrouplayer),this._duiJiaShouPaiLayerContainer=new LayerContainer(GameSetting.DuiJiaShouPaiLayer),this._shangJiaShouPaiLayerContainer=new LayerContainer(GameSetting.ShangJiaShouPaiLayer),this._shangJiaGroupLayerContainer=new LayerContainer(GameSetting.ShangJiaGroupLayer),this._xiaJiaGroupLayer=new LayerContainer(GameSetting.XiaJiaGroupLayer),this._xiaJiaShouPaiLayer=new LayerContainer(GameSetting.XiaJiaShouPaiLayer),this._outBenJiaLayerContainer=new LayerContainer(GameSetting.OutBenJiaLayer),this._outXiaJiaLayerContainer=new LayerContainer(GameSetting.OutXiaJiaLayer),this._outDuiJiaLayerContainer=new LayerContainer(GameSetting.OutDuiJiaLayer),this._outShangJiaLayerContainer=new LayerContainer(GameSetting.OutShangJiaLayer),this._cardWallOtherContainer=new LayerContainer(GameSetting.CardWallOther),this._cardWallLayerBenJiaContainer=new LayerContainer(GameSetting.CardWallLayerBenJia),this._benJiaGroupLayerContainer=new LayerContainer(GameSetting.BenJiaGroupLayer),this._benJiaShouPaiLayerContainer=new LayerContainer(GameSetting.BenJiaShouPaiLayer),e.addChild(this._duiJiaGrouplayerContainer),e.addChild(this._duiJiaShouPaiLayerContainer),e.addChild(this._shangJiaGroupLayerContainer),e.addChild(this._shangJiaShouPaiLayerContainer),e.addChild(this._xiaJiaGroupLayer),e.addChild(this._xiaJiaShouPaiLayer),e.addChild(this._outXiaJiaLayerContainer),e.addChild(this._outDuiJiaLayerContainer),e.addChild(this._outShangJiaLayerContainer),e.addChild(this._outBenJiaLayerContainer),e.addChild(this._cardWallOtherContainer),e.addChild(this._benJiaGroupLayerContainer),e.addChild(this._cardWallLayerBenJiaContainer),e.addChild(this._benJiaShouPaiLayerContainer)},e.prototype.getContainer=function(e){for(var t,n=0;n<this._group.numChildren;n++)if(t=this._group.getChildAt(n),t.layer==e)return t;return null},e}();__reflect(LayerController.prototype,"LayerController");var OutCardController=function(){function e(e){this._handleMap=new Dictionary,this._benJiaHandler=new OutCardHandler(PosType.BenJia,e,GameSetting.OutBenJiaLayer),this._xiaJiaHandler=new OutCardHandler(PosType.XiaJia,e,GameSetting.OutXiaJiaLayer),this._duiJiaHandler=new OutCardHandler(PosType.DuiJia,e,GameSetting.OutDuiJiaLayer),this._shangJiaHandler=new OutCardHandler(PosType.ShangJia,e,GameSetting.OutShangJiaLayer),this._handleMap.add(PosType.BenJia,this._benJiaHandler),this._handleMap.add(PosType.XiaJia,this._xiaJiaHandler),this._handleMap.add(PosType.DuiJia,this._duiJiaHandler),this._handleMap.add(PosType.ShangJia,this._shangJiaHandler)}return e.prototype.showPai=function(){if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList)for(var e=void 0,t=0;t<RoomManager.roomInfo.playerList.length;t++){e=RoomManager.roomInfo.playerList[t];var n=RoomManager.getPosTypeForMine(e.pos),i=this._handleMap.getValue(n);i&&i.showPai(e.outCard)}},e.prototype.addPai=function(e,t,n){void 0===n&&(n=!0);var i=this._handleMap.getValue(e);if(i&&i.addPai(t,void 0,n),RoomManager.mineInfo){var a=RoomManager.getPosByPosTypeForMine(e),o=RoomManager.getPlayerInfoByPos(a);o&&(o.outCard||(o.outCard=new Array),n&&o.outCard.push(t))}},e.prototype.removePai=function(e,t){var n=this._handleMap.getValue(e);n&&n.removePai(t)},e.prototype.shoBuyHorse=function(e,t,n){void 0!=t&&0!=t&&this.addPai(e,t,!1),void 0!=n&&0!=n&&this.addPai(e,n,!1)},e.prototype.clear=function(){for(var e=this._handleMap.getValues(),t=0,n=e;t<n.length;t++){var i=n[t];i.clear()}},e}();__reflect(OutCardController.prototype,"OutCardController");var ShouCardController=function(){function e(e){this.isInit=!1,this._shouCardContainer=e}return e.prototype.create=function(e){this._faCount=0,this._masterPosType=PosType.BenJia,RoomManager.masterInfo&&(this._masterPosType=RoomManager.masterInfo.pos);var t=SceneManager.gameScene.gameProcesser.layerController;this._benJiaHandler=new ShouPaiBenJiaHandler(t.getContainer(GameSetting.BenJiaShouPaiLayer)),this._benJiaHandler.init(BenJiaShouCard,e),this._xiaJiaHandler=new ShouPaiXiaJiaHandler(t.getContainer(GameSetting.XiaJiaShouPaiLayer)),this._xiaJiaHandler.init(OtherShouCard,e),this._duiJiaHandler=new ShouPaiDuiJiaHandler(t.getContainer(GameSetting.DuiJiaShouPaiLayer)),this._duiJiaHandler.init(OtherShouCard,e),this._shangJiaHandler=new ShouPaiShangJiaHandler(t.getContainer(GameSetting.ShangJiaShouPaiLayer)),this._shangJiaHandler.init(OtherShouCard,e),this._jiaList=new Array,this._jiaList.push(void 0,this._benJiaHandler,this._xiaJiaHandler,this._duiJiaHandler,this._shangJiaHandler)},e.prototype.init=function(e){if(this._benJiaHandler){if(this._jiaList)for(var t=0,n=this._jiaList;t<n.length;t++){var i=n[t];i&&i.setPit(e)}}else this.create(e),this.isInit=!0;RoomManager.roomInfo.shouPai&&this.onEnable()},e.prototype.onEnable=function(){DragUtil.dragEndEa.addListener(this.onDragCardEnd,this),this._shouCardContainer.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clikShouCardHandler,this),this._shouCardContainer.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginShouCardhandler,this),GroupCardHandler.moveAd.addListener(this.onMove,this)},e.prototype.onDisable=function(){DragUtil.dragEndEa.removeListener(this.onDragCardEnd),this._shouCardContainer.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clikShouCardHandler,this),this._shouCardContainer.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginShouCardhandler,this),GroupCardHandler.moveAd.removeListener(this.onMove)},e.prototype.initExactlyCard=function(e){if(void 0===e&&(e=!1),this._jiaList)for(var t=void 0,n=1;n<this._jiaList.length;n++)e?n!=PosType.BenJia&&(t=this._jiaList[n]):t=this._jiaList[n],t&&t.exactlyCard(!0)},e.prototype.pengExactlyCard=function(e){if(this._jiaList&&e>=PosType.BenJia&&e<=PosType.ShangJia){var t=this._jiaList[e];t&&t.exactlyCard(!0)}},e.prototype.immediatelyInsert=function(e){if(this._jiaList&&e>=PosType.BenJia&&e<=PosType.ShangJia){var t=this._jiaList[e];t&&t.exactlyCard(!0,!0)}},e.prototype.showLastCard=function(){if(RoomManager.masterInfo&&RoomManager.mineInfo&&RoomManager.roomInfo){var e=RoomManager.getPosTypeForMine(RoomManager.masterInfo.pos),t=this._jiaList[e];t&&(e==PosType.BenJia?RoomManager.roomInfo.myLastCard&&t.setNewCard(RoomManager.roomInfo.myLastCard):t.setNewCard(void 0))}},e.prototype.hideLastCard=function(){if(RoomManager.masterInfo&&RoomManager.mineInfo){var e=RoomManager.getPosTypeForMine(RoomManager.masterInfo.pos),t=this._jiaList[e];t&&t.hideLastCard()}},e.prototype.runGetCard=function(){if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList){this._faCount++,this._faCount%=RoomManager.mod;var e=RoomManager.getPosType(this._masterPosType,this._faCount),t=this._jiaList[e];t&&t.get4Card()}},e.prototype.setNewCard=function(e,t){if(this._jiaList){var n=this._jiaList[e];n&&n.setNewCard(t)}},e.prototype.outCard=function(e,t,n){if(this._jiaList){var i=this._jiaList[e];i&&i.outCard(t,n),this._benJiaHandler&&this._benJiaHandler.hideArrow()}},e.prototype.startInsert=function(e,t){var n=this._jiaList[e];n&&n.startInsertCard(t)},e.prototype.test=function(){this._benJiaHandler.test()},e.prototype.touchBeginShouCardhandler=function(e){if(e.target instanceof eui.Image&&e.target.parent instanceof BenJiaShouCard){SoundManager.playEffect(Sex.Male,MusicAction.cardClick);var t=e.target.parent;this._dragProxyCard||(this._dragProxyCard=new BenJiaShouCard(t.shouPaiDef,0)),this._dragProxyCard.refreshFace(t.cardNum),this._dragCard=t,DragUtil.startDrag(this._dragProxyCard)}},e.prototype.onDragCardEnd=function(e){e instanceof BenJiaShouCard&&DragUtil.dragTarget&&DragUtil.dragTarget.y<450&&RoomManager.isSelfAction&&GoCardProcessManager.isReady&&(GoCardProcessManager.isClickTingBtn?this._dragCard.isTingCard&&(console.log("听牌拖拽出牌出牌了："),GoCardProcessManager.reqPutOutCard(this._dragCard,this._dragCard.cardNum)):(console.log("拖拽出牌出牌了："),GoCardProcessManager.reqPutOutCard(this._dragCard,this._dragCard.cardNum)))},e.prototype.clikShouCardHandler=function(e){if(e.target instanceof eui.Image)if(e.target.parent instanceof BenJiaShouCard){var t=e.target.parent;this._initY||(this._initY=t.y),SoundManager.playEffect(Sex.Male,MusicAction.cardClick),RoomManager.isSelfAction&&this._lastShouCardHandler==t&&t.y<this._initY&&GoCardProcessManager.isReady?t&&(GoCardProcessManager.isClickTingBtn?t.isTingCard&&(console.log("听牌点击出牌出牌了："),GoCardProcessManager.reqPutOutCard(t,t.cardNum),this._lastShouCardHandler=null):(console.log("点击出牌出牌了："),GoCardProcessManager.reqPutOutCard(t,t.cardNum),this._lastShouCardHandler=null)):this._lastShouCardHandler&&this.backUpCard(),t.y=this._initY-30,t.isTingCard&&this.showTingInfo(t.cardNum),this._lastShouCardHandler=t}else this.backUpCard();else this._lastShouCardHandler&&this.backUpCard()},e.prototype.showTingInfo=function(e){if(void 0==e&&GoCardProcessManager.curOutCard&&(e=GoCardProcessManager.curOutCard.cardNum),e){var t=this.getListenerResultInfo(e);t&&UIManager.showPanel(UIModuleName.TingInfoPanel,t)}},e.prototype.showLiangPai=function(e,t){var n=RoomManager.getPlayerInfoByRoleId(e),i=RoomManager.getPosTypeForMine(n.pos),a=this._jiaList[i];a&&n&&GoCardProcessManager.huCardInfo&&(e==GoCardProcessManager.huCardInfo.roleId?a.showLiangPai(t,GoCardProcessManager.huCardInfo.card,GoCardProcessManager.huCardInfo.huType):a.showLiangPai(t))},e.prototype.backUpCard=function(){UIManager.closePanel(UIModuleName.TingInfoPanel),this._lastShouCardHandler&&(this._lastShouCardHandler.y=this._initY,this._lastShouCardHandler=null)},e.prototype.onMove=function(e){this.refreshShouPai(e.pos,e.offsetX,e.offsetY,e.num)},e.prototype.refreshShouPai=function(e,t,n,i){var a=this._jiaList[e],o=RoomManager.getPlayerInfoByPosType(e);if(a&&o){var r=0;o.groupList&&(r=o.groupList.length),e==PosType.ShangJia?(a.layerContainer.x=18*r,a.layerContainer.y=-45*r):e==PosType.XiaJia?(a.layerContainer.x=18*r,a.layerContainer.y=45*r):(a.layerContainer.x=t,a.layerContainer.y=n)}},e.prototype.refreshTingState=function(e){if(this._benJiaHandler||(this.create(!1),this.isInit=!0),e){this._listenerResultInfoList=e;var t=e.length;if(this._benJiaHandler&&this._benJiaHandler.hideArrow(),t>0)for(var n=void 0,i=0;t>i;i++)n=e[i],this._benJiaHandler.showArrow(n.outCard)}else this._benJiaHandler&&this._benJiaHandler.hideArrow()},e.prototype.getListenerResultInfo=function(e){if(this._listenerResultInfoList)for(var t=this._listenerResultInfoList.length,n=void 0,i=0;t>i;i++)if(n=this._listenerResultInfoList[i],n.outCard==e)return n;return null},e.prototype.clear=function(){if(this._jiaList)for(var e=0,t=this._jiaList;e<t.length;e++){var n=t[e];n&&(n.layerContainer.x=n.layerContainer.y=0,n.clear())}},e}();__reflect(ShouCardController.prototype,"ShouCardController");var FriendManager=function(){function e(){}return e.reqFriendListInfo=function(){SocketManager.AddCommandListener(Command.Req_friendInfo_3003,e.FriendListInfoResponse),SocketManager.Send(Command.Req_friendInfo_3003)},e.FriendListInfoResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_friendInfo_3003,e.FriendListInfoResponse),t.data&&(e.friendList||(e.friendList=new Array),e.friendList=t.data.friendList),e.onGetFriendListEvent.dispatch()},e.reqGiveFriendGold=function(t){SocketManager.AddCommandListener(Command.Req_GiveFriendGold_3013,e.GiveFriendGoldResponse),SocketManager.Send(Command.Req_GiveFriendGold_3013,{id:t})},e.GiveFriendGoldResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_GiveFriendGold_3013,e.GiveFriendGoldResponse),e.onGiveFriendGoldEvent.dispatch()},e.reqReceiveGift=function(t){SocketManager.AddCommandListener(Command.Req_ReceiveGift_3006,e.ReceiveGiftResponse),SocketManager.Send(Command.Req_ReceiveGift_3006,{id:t})},e.ReceiveGiftResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_ReceiveGift_3006,e.ReceiveGiftResponse),e.onReceiveGiftEvent.dispatch()},e.reqFriendRequest=function(){SocketManager.AddCommandListener(Command.Req_FriendRequest_3007,e.FriendRequestResponse),SocketManager.Send(Command.Req_FriendRequest_3007)},e.FriendRequestResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_FriendRequest_3007,e.FriendRequestResponse),t.data&&(e.requestFriendList||(e.requestFriendList=new Array),e.requestFriendList=t.data.requestFriendList),e.onFriendRequestEvent.dispatch()},e.reqReceiveFriendRequest=function(t,n){SocketManager.AddCommandListener(Command.Req_ReceiveFriend_3008,e.ReceiveFriendRequestResponse),e.isReceive=n,SocketManager.Send(Command.Req_ReceiveFriend_3008,{id:t,isReceive:n})},e.ReceiveFriendRequestResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_ReceiveFriend_3008,e.ReceiveFriendRequestResponse),e.onReceiveFriendRequestEvent.dispatch()},e.reqSearchPlayer=function(t){SocketManager.AddCommandListener(Command.Req_SearchPlayer_3009,e.SearchPlayerResponse),SocketManager.Send(Command.Req_SearchPlayer_3009,{text:t})},e.SearchPlayerResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_SearchPlayer_3009,e.SearchPlayerResponse),t.data&&(e.searchList||(e.searchList=new Array),e.searchList=t.data.searchList,e.onSearchPlayerEvent.dispatch())},e.reqAddPlayer=function(t){SocketManager.AddCommandListener(Command.Req_AddPlayer_3010,e.AddPlayerResponse),SocketManager.Send(Command.Req_AddPlayer_3010,{id:t})},e.AddPlayerResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_AddPlayer_3010,e.AddPlayerResponse),e.onAddPlayerEvent.dispatch()},e.reqFastReceive=function(){SocketManager.AddCommandListener(Command.Req_FastReceive_3011,e.FastReceiveResponse),SocketManager.Send(Command.Req_FastReceive_3011)},e.FastReceiveResponse=function(t){SocketManager.RemoveCommandListener(Command.Req_FastReceive_3011,e.FastReceiveResponse),e.onFastReceiveEvent.dispatch()},e.reqRemovePlayer=function(t){var n=function(i){SocketManager.RemoveCommandListener(Command.Req_AddPlayer_3010,n),e.onRemovePlayerEvent.dispatch(t)};SocketManager.AddCommandListener(Command.Req_AddPlayer_3010,n),SocketManager.Send(Command.Req_AddPlayer_3010,{id:t})},e}();FriendManager.onGetFriendListEvent=new ActionDispatcher,FriendManager.onGiveFriendGoldEvent=new ActionDispatcher,FriendManager.onReceiveGiftEvent=new ActionDispatcher,FriendManager.onFriendRequestEvent=new ActionDispatcher,FriendManager.onReceiveFriendRequestEvent=new ActionDispatcher,FriendManager.onSearchPlayerEvent=new ActionDispatcher,FriendManager.onAddPlayerEvent=new ActionDispatcher,FriendManager.onFastReceiveEvent=new ActionDispatcher,FriendManager.onRemovePlayerEvent=new ActionDispatcher,__reflect(FriendManager.prototype,"FriendManager");var FriendInfo=function(){function e(){}return e}();__reflect(FriendInfo.prototype,"FriendInfo");var GameManager=function(){function e(){}return Object.defineProperty(e,"stage",{get:function(){return e._stage},enumerable:!0,configurable:!0}),e.initialize=function(t){e._stage=t},e.InitServer=function(t,n){e._isInitComplete=!1,e.initServerHandler.Invoke(t,n,e.ParseInitComplete,e.DispatchInitError)},e.ParseInitComplete=function(){0==e._isInitComplete&&e.initServerHandler.isComplete&&(e._isInitComplete=!0,e.initAppHandler.Invoke(),e.DispatchInitComplete())},e.DispatchInitComplete=function(){e.OnInitComplete.dispatch()},e.DispatchInitError=function(){e.OnInitError.dispatch()},e.reLogin=function(t){void 0===t&&(t=SystemReenterType.Normal),e.reenterType=t,SocketManager.Dispose(),UserManager.reLogin(),GoCardProcessManager.reLogin(),RoomManager.reLogin(),SceneManager.reLogin(),SceneManager.goToLogin()},e}();GameManager.reenterType=SystemReenterType.Normal,GameManager.initServerHandler=new InitServerHandler,GameManager.initAppHandler=new InitAppHandler,GameManager._isInitComplete=!1,GameManager.OnInitComplete=new ActionDispatcher,GameManager.OnInitError=new ActionDispatcher,__reflect(GameManager.prototype,"GameManager");var RecordAudioManager=function(){function e(){}return e.RecordComplete=function(t){var n=JSON.parse(t);if(n){var i=n.data;if(e._armData=i,e._armTime=parseFloat(n.time),e._armGuid=n.guid,e._armTime<.5)return e.ClearData(),void AlertManager.showSingleAlert("录音时间太短，请重试");e.DispatchRecordVoiceComplete(e._armTime,e._armGuid),StringUtil.isNullOrEmpty(e._updateSign)?e.RequestUpdateSign():e.UpdateAmrRecordData()}},e.UpdateAmrRecordData=function(){var t;t=VersionManager.isClientTest?ProjectDefined.GetInstance().getValue(ProjectDefined.voiceHostTest)+ProjectDefined.GetInstance().getValue(ProjectDefined.voicePath):ProjectDefined.GetInstance().getValue(ProjectDefined.voiceHost)+ProjectDefined.GetInstance().getValue(ProjectDefined.voicePath);var n=e._armGuid,i=e._updatePath,a=e._armTime,o=function(t){ChatManager.SendAudioRecordMessage(ChatMessageType.InRoom,a,n,t.sign,i),e.DispatchUpdateRecordVoiceComplete(a,n,t.sign,i)};UpLoader.UpLoad(t,e._updateSign,e._armData,!0,o,e.OnUpdateError),e.ClearData()},e.IsStillHandling=function(){return!StringUtil.isNullOrEmpty(e._armGuid)},e.OnUpdateError=function(t){e.ClearData()},e.ClearData=function(){e._armGuid=null,e._updatePath=null,e._armTime=0,e._updateSign=null,e._armData=null},e.DownloadAmrData=function(t,n,i){var a;a=VersionManager.isClientTest?ProjectDefined.GetInstance().getValue(ProjectDefined.voiceHostTest):ProjectDefined.GetInstance().getValue(ProjectDefined.voiceHost),a+=t,e.isDownloading=!0;var o=n;RES.getResByUrl(a,function(t){e.isDownloading=!1,t?(ChannelManager.setRecordData(o,t),e.PlayPauseAndResume(o,i)):e.OnDownLoadError(o)},this,RES.ResourceItem.TYPE_TEXT)},e.OnDownLoadError=function(e){console.log("加载录音文件失败！:"+e)},e.DispatchUpdateRecordVoiceComplete=function(t,n,i,a){e.OnUpdateRecordVoiceComplete.dispatch([t,n,i,a])},e.DispatchRecordVoiceComplete=function(t,n){e.OnRecordVoiceComplete.dispatch([t,n])},e.DispatchPlayRecordComplete=function(t){e.OnPlayRecordComplete.dispatch(t)},e.DispatchPreparePlay=function(t){e.OnPrepearPlay.dispatch(t)},e.CheckMicrophone=function(e){return void 0===e&&(e=!0),ChannelManager.hasMicrophone?!0:(e&&AlertManager.showSingleAlert("未检测到麦克风设备！或没有使用麦克风的权限！"),!1)},e.RecordVoice=function(t){t==AudioRecordActions.StartRecord?(e.RequestUpdateSign(),e.PauseMusicSetting()):e.RestoreMusicSetting()},e.PauseMusicSetting=function(){e._tempSoundMusic=SoundManager.bgEnabled,e._tempSoundEffect=SoundManager.effectEnabled,e._isChangeSoundSetting=!0,e._tempSoundMusic&&(SoundManager.bgEnabled=!1),e._tempSoundEffect&&(SoundManager.effectEnabled=!1)},e.RestoreMusicSetting=function(){e._isChangeSoundSetting&&(e._tempSoundMusic&&(SoundManager.bgEnabled=!0),e._tempSoundEffect&&(SoundManager.effectEnabled=!0),e._isChangeSoundSetting=!1),egret.clearTimeout(e._resumeTimer)},e.RequestUpdateSign=function(){},e.OnUpdateSignCallBack=function(t){null!=t.data&&(e._updateSign=t.data.sign,e._updatePath=t.data.path,e.CheckToUpdateData())},e.CheckToUpdateData=function(){0==StringUtil.isNullOrEmpty(e._updateSign)&&null!=e._armData&&e.UpdateAmrRecordData()},e.PlayPauseAndResume=function(t,n){0!=n&&(e.PauseMusicSetting(),e.playingGuid=t,e.ResumeLater(n)),e.DispatchPreparePlay(t)},e.ResumeLater=function(t){egret.clearTimeout(e._resumeTimer),e._resumeTimer=egret.setTimeout(e.playComplete,this,1e3*t+1e3)},e.playComplete=function(){egret.clearTimeout(e._resumeTimer);var t=e.playingGuid;e.playingGuid=StringConstant.empty,e.DispatchPlayRecordComplete(t),e.RestoreMusicSetting(),ChatManager.removeRecordChatInfo(t)},e}();RecordAudioManager.OnRecordVoiceComplete=new ActionDispatcher,RecordAudioManager.OnUpdateRecordVoiceComplete=new ActionDispatcher,RecordAudioManager.OnPlayRecordComplete=new ActionDispatcher,RecordAudioManager.OnPrepearPlay=new ActionDispatcher,RecordAudioManager._tempSoundMusic=!1,RecordAudioManager._tempSoundEffect=!1,RecordAudioManager._isChangeSoundSetting=!1,RecordAudioManager.playingGuid=StringConstant.empty,RecordAudioManager.isDownloading=!1,__reflect(RecordAudioManager.prototype,"RecordAudioManager");var AudioRecordActions;!function(e){e[e.StartRecord=0]="StartRecord",e[e.StopRecord=1]="StopRecord",e[e.CancelRecord=2]="CancelRecord"}(AudioRecordActions||(AudioRecordActions={}));var BaseShouCardContainer=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.init=function(e){this._posType=e,this._dataList=CardShowDefined.GetInstance().shouPaiMap.getValue(this._posType),this._dataList},t}(egret.DisplayObjectContainer);__reflect(BaseShouCardContainer.prototype,"BaseShouCardContainer");var GameSetting=function(){function e(){}return Object.defineProperty(e,"_shakeEnabled",{get:function(){return void 0!=e._shakeEnabled?e._shakeEnabled:PrefsManager.getBoolean(PrefsManager.Sound_Bg_Enable)},set:function(t){e.shakeEnabled=t,PrefsManager.setBoolean(PrefsManager.Sound_Bg_Enable,t)},enumerable:!0,configurable:!0}),e}();GameSetting.shakeEnabled=!1,GameSetting.StageWidth=720,GameSetting.StageHeight=1280,GameSetting.IsAgreeUserAgreement=!1,GameSetting.IsLogined=!1,GameSetting.htmlParser=new egret.HtmlTextParser,GameSetting.LoginBin=null,GameSetting.Gamec2sBin=null,GameSetting.Games2cBin=null,GameSetting.CardTotalNum=112,GameSetting.MaxCardIndex=28,GameSetting.MaxShouPaiNum=13,GameSetting.ZhuangJiaShouPaiNum=14,GameSetting.OneTypeTotalNum=4,GameSetting.FaFourCardModel=12,GameSetting.OneSecondMS=1e3,GameSetting.DuiJiaGrouplayer=0,GameSetting.DuiJiaShouPaiLayer=5,GameSetting.ShangJiaGroupLayer=10,GameSetting.ShangJiaShouPaiLayer=15,GameSetting.XiaJiaGroupLayer=20,GameSetting.XiaJiaShouPaiLayer=25,GameSetting.CardWallOther=35,GameSetting.OutBenJiaLayer=36,GameSetting.OutDuiJiaLayer=37,GameSetting.OutXiaJiaLayer=38,GameSetting.OutShangJiaLayer=39,GameSetting.BenJiaGroupLayer=40,GameSetting.CardWallLayerBenJia=45,GameSetting.BenJiaShouPaiLayer=50,GameSetting.MaxMailNum=30,__reflect(GameSetting.prototype,"GameSetting");var GoCardProcessManager=function(){function e(){}return e.clear=function(){e.lastMastPos=void 0,ArrayUtil.Clear(e.scroeInfoList),UIManager.closePanel(UIModuleName.GameScenePanel),UIManager.closePanel(UIModuleName.OnceResultPanel)},e.initialize=function(){e.clearReqFlag(),e.huCardInfo=new HuResultInfo,e.buyHorseInfo=new BuyHorseinfo,e.onceResultInfoList=new Array,e.gameOverList=new Array,e.scroeInfoList=new Array,e.onEnable()},e.reLogin=function(){e.isDispatchInit=!1,e.isClickTingBtn=!1,e.isReady=!1,e.isInActionSelect=!1,e.isReqPutOutCarding=!1,e.huCardInfo=new HuResultInfo,e.buyHorseInfo=new BuyHorseinfo,ArrayUtil.Clear(e.scroeInfoList),ArrayUtil.Clear(e.gameOverList),ArrayUtil.Clear(e.onceResultInfoList),e.clearReqFlag()},e.clearReqFlag=function(){e.isReqPutOutCarding=!1,e.isReqTinging=!1,e.isReqPenging=!1,e.isReqGanging=!1,e.isReqHuIng=!1,e.isReqGuoing=!1,e.isReqGoOning=!1},e.onEnable=function(){SocketManager.AddCommandListener(Command.Rec_PushTouziResult_2004,e.onTouZiResult,this),SocketManager.AddCommandListener(Command.Rec_PushShouPai_2005,e.onShouPaiResult,this),SocketManager.AddCommandListener(Command.Rec_PushMoPaiResult_2016,e.onSelfMoPaiResult_2016,this),SocketManager.AddCommandListener(Command.Rec_PushMoPai_2006,e.onMoPaiResult_2006,this),SocketManager.AddCommandListener(Command.Rec_PushOutCard_2007,e.onOutCardResult,this),SocketManager.AddCommandListener(Command.Rec_PushGangCard_2017,e.onGangCardResult,this),SocketManager.AddCommandListener(Command.Rec_PushPengCard_2018,e.onPengCardResult,this),SocketManager.AddCommandListener(Command.Rec_Push_2010,e.onTingCardResult,this),SocketManager.AddCommandListener(Command.Rec_PushHuCard_2019,e.onHuCardResult,this),SocketManager.AddCommandListener(Command.Rec_PushOnceResult_2011,e.onOnceResult,this),SocketManager.AddCommandListener(Command.Rec_PushGameOver_2020,e.onGameOverResult,this),SocketManager.AddCommandListener(Command.Rec_PushBuyHorse_2021,e.onBuyHorseResult,this),SocketManager.AddCommandListener(Command.Rec_PushPlayReady_2022,e.onPlayerReadyResult,this),SocketManager.AddCommandListener(Command.Rec_PushScore_2008,e.onPushScoreResult,this),SocketManager.AddCommandListener(Command.Rec_PushPlayerHosted_2024,e.onPushPlayerHostedResult,this),SocketManager.AddCommandListener(Command.Rec_PushSec_2025,e.onPushSecResult,this),SocketManager.AddCommandListener(Command.Rec_Push_Offline_2026,e.onPushOfflineResult,this)
},e.onDisable=function(){SocketManager.RemoveCommandListener(Command.Rec_PushTouziResult_2004,e.onTouZiResult),SocketManager.RemoveCommandListener(Command.Rec_PushShouPai_2005,e.onShouPaiResult),SocketManager.RemoveCommandListener(Command.Rec_PushMoPaiResult_2016,e.onSelfMoPaiResult_2016),SocketManager.RemoveCommandListener(Command.Rec_PushMoPai_2006,e.onMoPaiResult_2006),SocketManager.RemoveCommandListener(Command.Rec_PushOutCard_2007,e.onOutCardResult),SocketManager.RemoveCommandListener(Command.Rec_PushGangCard_2017,e.onGangCardResult),SocketManager.RemoveCommandListener(Command.Rec_PushPengCard_2018,e.onPengCardResult),SocketManager.RemoveCommandListener(Command.Rec_Push_2010,e.onTingCardResult),SocketManager.RemoveCommandListener(Command.Rec_PushHuCard_2019,e.onHuCardResult),SocketManager.RemoveCommandListener(Command.Rec_PushOnceResult_2011,e.onOnceResult),SocketManager.RemoveCommandListener(Command.Rec_PushGameOver_2020,e.onGameOverResult),SocketManager.RemoveCommandListener(Command.Rec_PushBuyHorse_2021,e.onBuyHorseResult),SocketManager.RemoveCommandListener(Command.Rec_PushPlayReady_2022,e.onPlayerReadyResult),SocketManager.RemoveCommandListener(Command.Rec_PushScore_2008,e.onPushScoreResult),SocketManager.RemoveCommandListener(Command.Rec_PushPlayerHosted_2024,e.onPushPlayerHostedResult),SocketManager.RemoveCommandListener(Command.Rec_PushSec_2025,e.onPushSecResult),SocketManager.RemoveCommandListener(Command.Rec_Push_Offline_2026,e.onPushOfflineResult)},e.ready=function(){UIManager.removeEventListener(UIModuleName.GameScenePanel,UIModuleEvent.COMPLETE,e.ready),void 0!=RoomManager.roomInfo.quitTime&&RoomManager.mineInfo&&(RoomManager.mineInfo.quit==RoomQuitState.ReqQuit?UIManager.showPanel(UIModuleName.RoomDisbandInfoPanel):UIManager.showPanel(UIModuleName.RoomDisbandOperPanel)),RoomManager.mineInfo&&RoomManager.mineInfo.isReady?e.dispatchAlreadyInRoomEvent():RoomManager.roomInfo&&RoomManager.roomInfo.roundNum>0?(SceneManager.gameScene.gameProcesser.gameScenePanel.hideActionBtn(),UIManager.showPanel(UIModuleName.OnceResultPanel)):e.reqGoOnGame(),RoomManager.roomInfo&&RoomManager.roomInfo.roundNum>0&&SceneManager.gameScene.gameProcesser.gameScenePanel.showWaitGroup(!1)},e.reqGoOnGame=function(){if(!e.isReqGoOning){e.isReqGoOning=!0;var t=function(){e.isReqGoOning=!1,RoomManager.roomInfo.head=0,SocketManager.RemoveCommandListener(Command.Req_GoOnGame_3015,t),e.dispatchGoOnGameEvent()};SocketManager.AddCommandListener(Command.Req_GoOnGame_3015,t),SocketManager.AddErrorListener(Command.Req_GoOnGame_3015,e.goOnErrorResult),SocketManager.Send(Command.Req_GoOnGame_3015)}},e.goOnErrorResult=function(t){e.isReqGoOning=!1,SocketManager.RemoveErrorListener(Command.Req_GoOnGame_3015,e.goOnErrorResult)},e.onTouZiResult=function(t){t.data&&(RoomManager.roomInfo.num1=t.data.num1,RoomManager.roomInfo.num2=t.data.num2,e.state=GameSceneState.RunFapai,e.dispatchTouziResultEvent())},e.onShouPaiResult=function(t){if(RoomManager.roomInfo&&t.data.card){if(RoomManager.roomInfo.shouPai=t.data.card,RoomManager.roomInfo.shouPai){var n=RoomManager.roomInfo.shouPai.length;if(n>1){var i=MathUtil.getRandom(0,n-2);ArrayUtil.moveSomeElementsToTheEnd(RoomManager.roomInfo.shouPai,0,i)}RoomManager.mineInfo&&(RoomManager.mineInfo.shouPaiNum=n)}for(var a=0,o=RoomManager.roomInfo.playerList;a<o.length;a++){var r=o[a];r.isMaster?r.shouPaiNum=GameSetting.ZhuangJiaShouPaiNum:r.shouPaiNum=GameSetting.MaxShouPaiNum}e.dispatchShouPaiResultEvent()}},e.onSelfMoPaiResult_2016=function(t){if(RoomManager.roomInfo&&t.data.card){var n=t.data.card;RoomManager.roomInfo.myLastCard=n,RoomManager.roomInfo.shouPai.push(n),RoomManager.mineInfo&&(RoomManager.roomInfo.pos=RoomManager.mineInfo.pos),e.isClickTingBtn=!1,e.dispatchMoPaiResultEvent_2016(n)}},e.onMoPaiResult_2006=function(t){if(RoomManager.roomInfo&&t.data.roleId){var n=t.data.roleId,i=RoomManager.getPlayerInfoByRoleId(n);if(i){RoomManager.roomInfo.pos=i.pos;var a=RoomManager.getPosTypeForMine(i.pos);n==UserManager.userInfo.roleId?RoomManager.roomInfo.play=RoomState.PUT:RoomManager.roomInfo.play=RoomState.WAIT,e.dispatchMoPaiEvent_2006(a)}}},e.onOutCardResult=function(t){if(t.data&&t.data.roleId&&t.data.card&&RoomManager.roomInfo){var n=t.data.roleId,i=t.data.card;n==UserManager.userInfo.roleId&&ArrayUtil.RemoveItem(i,RoomManager.roomInfo.shouPai),RoomManager.roomInfo.play=RoomState.WAIT;var a=RoomManager.getPlayerInfoByRoleId(n);a&&(e.dispatchOutCardEvent(a.pos,i),SoundManager.playEffect(a.sex,MusicAction.pai,i))}},e.onGangCardResult=function(t){if(t.data){var n=t.data.card,i=t.data.roleId,a=t.data.action,o=t.data.pos,r=RoomManager.getPlayerInfoByRoleId(i);r&&(RoomManager.roomInfo.pos=r.pos,SoundManager.playEffect(r.sex,MusicAction.gang)),r=RoomManager.getPlayerInfoByPos(o),r&&ArrayUtil.RemoveItem(n,r.outCard),RoomManager.roomInfo.play=RoomState.WAIT,e.pengGangToGroupOper(i,o,n,a),e.dispatchPushGangEvent(n,i,o,a)}},e.onPengCardResult=function(t){if(t.data){var n=t.data.card,i=t.data.roleId,a=t.data.pos,o=RoomManager.getPlayerInfoByRoleId(i);o&&(RoomManager.roomInfo.pos=o.pos,SoundManager.playEffect(o.sex,MusicAction.peng)),o=RoomManager.getPlayerInfoByPos(a),o&&ArrayUtil.RemoveItem(n,o.outCard),i==UserManager.userInfo.roleId?RoomManager.roomInfo.play=RoomState.PUT:RoomManager.roomInfo.play=RoomState.WAIT,e.pengGangToGroupOper(i,a,n,ActionType.Peng),e.dispatchPushPengEvent(n,i,a)}},e.onTingCardResult=function(t){if(t.data){var n=t.data.roleId,i=t.data.isTing,a=RoomManager.getPlayerInfoByRoleId(n);a&&(a.isTing=i,SoundManager.playEffect(a.sex,MusicAction.ting)),e.dispatchPushTingEvent(n,i)}},e.onHuCardResult=function(t){e.huCardInfo.copyValueFrom(t.data);var n=RoomManager.getPlayerInfoByRoleId(e.huCardInfo.roleId);n&&(RoomManager.roomInfo.pos=n.pos,SoundManager.playEffect(n.sex,MusicAction.hu)),e.state=GameSceneState.OneRoundOver,RoomManager.roomInfo.play=RoomState.HU,e.dispatchPushHuEvent(),RoomManager.nextRoundOper()},e.onOnceResult=function(t){if(t.data){ArrayUtil.Clear(e.onceResultInfoList);var n=t.data.resultList;if(RoomManager.roomInfo)for(var i=0,a=RoomManager.roomInfo.playerList;i<a.length;i++){var o=a[i];if(o.isMaster){e.lastMastPos=o.pos;break}}if(n){var r=void 0,s=void 0;RoomManager.clearMaster();for(var l=0,c=n;l<c.length;l++){var h=c[l];r=new OnceResultInfo,r.copyValueFrom(h),r.shouPai&&r.shouPai.reverse(),r.groupList&&r.groupList.sort(SortUtil.sortGroupCard),s=RoomManager.getPlayerInfoByRoleId(r.roleId),s&&(s.isMaster=r.isMaster),e.onceResultInfoList.push(r)}}if(RoomManager.roomInfo){RoomManager.roomInfo.roundEndTime=TimeManager.GetServerUtcTimestamp();for(var d=0;d<RoomManager.roomInfo.playerList.length;d++)RoomManager.roomInfo.playerList[d].isReady=!1}RoomManager.roomInfo.play=RoomState.NIL,e.dispatchOnceReultEvent()}},e.onBuyHorseResult=function(t){t.data&&(e.buyHorseInfo.copyValueFrom(t.data),console.log(" GoCardProcessManager.buyHorseInfo---card1",e.buyHorseInfo.card1+"card2"+e.buyHorseInfo.card2),e.dispatchBuyHorseEvent())},e.onPlayerReadyResult=function(t){if(t.data){var n=t.data.roleId,i=RoomManager.getPlayerInfoByRoleId(n);i&&(i.isReady=!0,i.hosted=!1),e.dispatchPushPlayerReadyEvent()}},e.onPushScoreResult=function(t){if(t.data){for(var n=void 0,i=void 0,a=void 0,o=0,r=t.data.scoreList;o<r.length;o++){var s=r[o];a=!1;for(var l=0,c=e.scroeInfoList;l<c.length;l++){var h=c[l];if(h.roleId==s.roleId){a=!0,h.offsetScore=s.score-h.score,h.score=s.score,n=RoomManager.getPlayerInfoByRoleId(s.roleId),n&&(n.score=s.score);break}}a||(n=RoomManager.getPlayerInfoByRoleId(s.roleId),n&&(i=new ScoreChangeInfo,i.copyValueFrom(s),i.offsetScore=i.score-n.score,n.score=i.score,e.scroeInfoList.push(i)))}e.lastScoreChangeType=t.data.type,e.dispatchScoreChangeEvent()}},e.onPushPlayerHostedResult=function(t){if(t.data){var n=t.data.roleId,i=t.data.hosted,a=RoomManager.getPlayerInfoByRoleId(n);a&&(a.hosted=i),e.dispatchPlayerHostedEvent(n,i)}},e.onPushSecResult=function(e){if(e.data){e.data.sec-1}},e.onPushOfflineResult=function(t){if(t.data){var n=t.data.roleId,i=t.data.offline,a=RoomManager.getPlayerInfoByRoleId(n);a&&(a.offline=i),e.dispatchPlayerOfflineEvent()}},e.onGameOverResult=function(t){if(ArrayUtil.Clear(e.gameOverList),t.data){for(var n=void 0,i=0,a=t.data.infoList;i<a.length;i++){var o=a[i];n=new GameOverInfo,n.copyValueFrom(o),e.gameOverList.push(n)}e.gameOverList.sort(e.sortOverList),e.gameOverList.length>0&&(e.gameOverList[0].isMaxWin=!0),e.dispatchOnGameOverEvent()}},e.reqPutOutCard=function(t,n){if(!e.isReqPutOutCarding){e.curOutCard=t,e.isReqPutOutCarding=!0;var i=function(t){e.state==GameSceneState.Processing&&!RoomManager.mineInfo.isTing&&e.isClickTingBtn&&RoomManager.mineInfo&&e.reqTingCard(),e.isReqPutOutCarding=!1,SocketManager.RemoveCommandListener(Command.Req_PutOutCard_3008,i)};SocketManager.AddCommandListener(Command.Req_PutOutCard_3008,i),SocketManager.AddErrorListener(Command.Req_PutOutCard_3008,e.putOutErrorResult),SocketManager.ImplSend(Command.Req_PutOutCard_3008,{card:n})}},e.putOutErrorResult=function(t){e.isReqPutOutCarding=!1,SocketManager.RemoveErrorListener(Command.Req_PutOutCard_3008,e.putOutErrorResult)},e.reqPengCard=function(){if(!e.isReqPenging){e.isReqPenging=!0;var t=function(n){e.isReqPenging=!1,e.dispatchPengCardEvnt(),SocketManager.RemoveCommandListener(Command.Req_PengCard_3009,t)};SocketManager.AddCommandListener(Command.Req_PengCard_3009,t),SocketManager.AddErrorListener(Command.Req_PengCard_3009,e.pengErrorResult),SocketManager.ImplSend(Command.Req_PengCard_3009)}},e.pengErrorResult=function(t){e.isReqPenging=!1,SocketManager.RemoveErrorListener(Command.Req_PengCard_3009,e.pengErrorResult)},e.reqGangCard=function(t){if(!e.isReqGanging){e.isReqGanging=!0;var n=function(t){e.isReqGanging=!1,e.dispatchGangCardEvent(),SocketManager.RemoveCommandListener(Command.Req_GangCard_3010,n)};SocketManager.AddCommandListener(Command.Req_GangCard_3010,n),SocketManager.AddErrorListener(Command.Req_GangCard_3010,e.gangErrorResult),t||(t=this.tryGetSelfGang()),void 0!=t&&0!=t&&-1!=t?SocketManager.ImplSend(Command.Req_GangCard_3010,{card:t}):SocketManager.ImplSend(Command.Req_GangCard_3010)}},e.gangErrorResult=function(t){e.isReqGanging=!1,SocketManager.RemoveErrorListener(Command.Req_GangCard_3010,e.gangErrorResult)},e.reqHuCard=function(){if(!e.isReqHuIng){e.isReqHuIng=!0;var t=function(n){e.isReqHuIng=!1,e.dispatchHuCardEvent(),SocketManager.RemoveCommandListener(Command.Req_HuCard_3011,t)};SocketManager.AddCommandListener(Command.Req_HuCard_3011,t),SocketManager.AddErrorListener(Command.Req_HuCard_3011,e.huErrorResult),SocketManager.Send(Command.Req_HuCard_3011)}},e.huErrorResult=function(t){e.isReqHuIng=!1,SocketManager.RemoveErrorListener(Command.Req_HuCard_3011,e.huErrorResult)},e.reqTingCard=function(){if(!e.isReqTinging){e.isReqTinging=!0;var t=function(n){RoomManager.mineInfo.isTing=!0,e.isReqTinging=!1,e.dispatchTingCardEvent(),SocketManager.RemoveCommandListener(Command.Req_TingCard_3012,t)};SocketManager.AddCommandListener(Command.Req_TingCard_3012,t),SocketManager.AddErrorListener(Command.Req_TingCard_3012,e.tingErrorResult),SocketManager.Send(Command.Req_TingCard_3012)}},e.tingErrorResult=function(t){e.isReqTinging=!1,SocketManager.RemoveErrorListener(Command.Req_TingCard_3012,e.tingErrorResult)},e.reqPass=function(){if(!e.isReqGuoing){e.isReqGuoing=!0;var t=function(n){e.isReqGuoing=!1,SocketManager.RemoveCommandListener(Command.Req_Pass_3020,t),e.dispatchPassEvent()};SocketManager.AddCommandListener(Command.Req_Pass_3020,t),SocketManager.AddErrorListener(Command.Req_Pass_3020,e.guoErrorResult),SocketManager.Send(Command.Req_Pass_3020)}},e.guoErrorResult=function(t){e.isReqGuoing=!1,SocketManager.RemoveErrorListener(Command.Req_Pass_3020,e.guoErrorResult)},e.reqBuyHorse=function(){SocketManager.Send(Command.Req_BuyHorse_3013)},e.reqCancelHosted=function(){SocketManager.AddCommandListener(Command.Req_Hosted_3022,e.hostedResult),SocketManager.Send(Command.Req_Hosted_3022)},e.hostedResult=function(t){SocketManager.RemoveCommandListener(Command.Req_Hosted_3022,e.hostedResult)},e.tryGetSelfGang=function(){if(RoomManager.roomInfo&&RoomManager.roomInfo.shouPai&&RoomManager.mineInfo&&RoomManager.isSelfAction)for(var t=void 0,n=0,i=RoomManager.roomInfo.shouPai;n<i.length;n++){var a=i[n];if(t=e.getCardNum(a),4==t)return a;if(RoomManager.mineInfo.groupList){var o=e.getGroupCardForMine(a);if(o&&o.action==ActionType.Peng)return a}}return-1},e.getGroupCardForMine=function(t){return RoomManager.mineInfo?e.getGroupCard(RoomManager.mineInfo.pos,t):null},e.getGroupCard=function(e,t){var n=RoomManager.getPlayerInfoByPos(e);if(n)for(var i=0,a=n.groupList;i<a.length;i++){var o=a[i];if(o.card==t)return o}return null},e.getCardNum=function(e){var t=0;if(RoomManager.roomInfo&&RoomManager.roomInfo.shouPai)for(var n=0;n<RoomManager.roomInfo.shouPai.length;n++)e==RoomManager.roomInfo.shouPai[n]&&t++;return t},e.getAllCardNum=function(t){var n=e.getCardNum(t);if(RoomManager.mineInfo&&RoomManager.mineInfo.groupList)for(var i=0,a=RoomManager.mineInfo.groupList;i<a.length;i++){var o=a[i];if(o.card==t){if(o.action==ActionType.Peng)return n+=3;if(o.action==ActionType.Gang||o.action==ActionType.AnGang||o.action==ActionType.BuGang)return n+=4}}return n},e.getListenerCardNum=function(e){if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList){for(var t=void 0,n=GameSetting.OneTypeTotalNum,i=0;i<RoomManager.roomInfo.playerList.length;i++){if(t=RoomManager.roomInfo.playerList[i],t.groupList)for(var a=0,o=t.groupList;a<o.length;a++){var r=o[a];if(r.card==e)switch(r.action){case ActionType.AnGang:case ActionType.Gang:case ActionType.BuGang:n-=4;break;case ActionType.Peng:n-=3}}if(t.outCard)for(var s=0,l=t.outCard;s<l.length;s++){var c=l[s];c==e&&(n-=1)}}if(RoomManager.roomInfo.shouPai)for(var h=0,d=RoomManager.roomInfo.shouPai;h<d.length;h++){var u=d[h];u==e&&(n-=1)}return n}return 0},e.pengGangToGroupOper=function(t,n,i,a){var o=RoomManager.getPlayerInfoByRoleId(t);if(o&&RoomManager.mineInfo){if(o.groupList||(o.groupList=new Array),a==ActionType.BuGang){var r=e.getGroupCard(o.pos,i);r&&(r.action=ActionType.BuGang)}else{var r=new GroupCardInfo;r.action=a,r.card=i,r.index=o.groupList.length,r.pos=n,o.groupList.push(r)}if(o.pos==RoomManager.mineInfo.pos){switch(a){case ActionType.AnGang:ArrayUtil.RemoveItem(i,RoomManager.roomInfo.shouPai,4);break;case ActionType.Gang:ArrayUtil.RemoveItem(i,RoomManager.roomInfo.shouPai,4);break;case ActionType.BuGang:ArrayUtil.RemoveItem(i,RoomManager.roomInfo.shouPai,4);break;case ActionType.Peng:ArrayUtil.RemoveItem(i,RoomManager.roomInfo.shouPai,2)}o.shouPaiNum=RoomManager.roomInfo.shouPai.length}else switch(a){case ActionType.AnGang:case ActionType.Gang:case ActionType.Peng:o.shouPaiNum-=3}}},e.isProcessing=function(){return e.state==GameSceneState.Processing},e.sortOverList=function(e,t){return e.totalScore>t.totalScore?-1:e.totalScore<t.totalScore?1:0},e.dispatchTouziResultEvent=function(){e.touziResultEa.dispatch()},e.dispatchAlreadyInRoomEvent=function(){e.alreadyInRoomEa.dispatch()},e.dispatchShouPaiResultEvent=function(){e.shouPaiResultEa.dispatch()},e.dispatchMoPaiEvent_2006=function(t){e.moPaiEa.dispatch(t)},e.dispatchMoPaiResultEvent_2016=function(t){e.moPaiResultEa.dispatch(t)},e.dispatchOutCardEvent=function(t,n){e.outCardEa.dispatch([t,n])},e.dispatchPengCardEvnt=function(){e.pengCardEa.dispatch()},e.dispatchGangCardEvent=function(){e.gangPaiEa.dispatch()},e.dispatchHuCardEvent=function(){e.huPaiEa.dispatch()},e.dispatchPushGangEvent=function(t,n,i,a){e.pushGangEa.dispatch([t,n,i,a])},e.dispatchPushPengEvent=function(t,n,i){e.pushPengEa.dispatch([t,n,i])},e.dispatchTingCardEvent=function(){e.tingCardEa.dispatch()},e.dispatchPassEvent=function(){e.passEa.dispatch()},e.dispatchPushTingEvent=function(t,n){e.pushTingEa.dispatch([t,n])},e.dispatchPushHuEvent=function(){e.pushHuCardEa.dispatch()},e.dispatchBuyHorseEvent=function(){e.buyHorseEa.dispatch()},e.dispatchOnceReultEvent=function(){e.onceResultEa.dispatch()},e.dispatchGoOnGameEvent=function(){e.onGoOnGameEa.dispatch()},e.dispatchOnGameOverEvent=function(){e.onGameOverEa.dispatch()},e.dispatchPushPlayerReadyEvent=function(){e.pushPlayerReadyEa.dispatch()},e.dispatchScoreChangeEvent=function(){e.pushScoreChangeEa.dispatch()},e.dispatchPlayerHostedEvent=function(t,n){e.pushPlayerHostedEa.dispatch([t,n])},e.dispatchSecChangeEvent=function(t){e.pushSecChangeEa.dispatch(t)},e.dispatchPlayerOfflineEvent=function(){e.pushPlayerOfflineEa.dispatch()},e}();GoCardProcessManager.isInActionSelect=!1,GoCardProcessManager.horseList=[0,4,8],GoCardProcessManager.touziResultEa=new ActionDispatcher,GoCardProcessManager.alreadyInRoomEa=new ActionDispatcher,GoCardProcessManager.shouPaiResultEa=new ActionDispatcher,GoCardProcessManager.moPaiEa=new ActionDispatcher,GoCardProcessManager.moPaiResultEa=new ActionDispatcher,GoCardProcessManager.outCardEa=new ActionDispatcher,GoCardProcessManager.pengCardEa=new ActionDispatcher,GoCardProcessManager.gangPaiEa=new ActionDispatcher,GoCardProcessManager.huPaiEa=new ActionDispatcher,GoCardProcessManager.pushGangEa=new ActionDispatcher,GoCardProcessManager.pushPengEa=new ActionDispatcher,GoCardProcessManager.tingCardEa=new ActionDispatcher,GoCardProcessManager.passEa=new ActionDispatcher,GoCardProcessManager.pushTingEa=new ActionDispatcher,GoCardProcessManager.pushHuCardEa=new ActionDispatcher,GoCardProcessManager.buyHorseEa=new ActionDispatcher,GoCardProcessManager.onceResultEa=new ActionDispatcher,GoCardProcessManager.onGoOnGameEa=new ActionDispatcher,GoCardProcessManager.onGameOverEa=new ActionDispatcher,GoCardProcessManager.pushPlayerReadyEa=new ActionDispatcher,GoCardProcessManager.pushScoreChangeEa=new ActionDispatcher,GoCardProcessManager.pushPlayerHostedEa=new ActionDispatcher,GoCardProcessManager.pushSecChangeEa=new ActionDispatcher,GoCardProcessManager.pushPlayerOfflineEa=new ActionDispatcher,__reflect(GoCardProcessManager.prototype,"GoCardProcessManager");var HuResultInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this.roleId=void 0,this.card=void 0},t}(BaseServerValueInfo);__reflect(HuResultInfo.prototype,"HuResultInfo");var BuyHorseinfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this.roleId=void 0,this.card1=void 0,this.card2=void 0},t}(BaseServerValueInfo);__reflect(BuyHorseinfo.prototype,"BuyHorseinfo");var OnceResultInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this.roleId=void 0,this.huType=void 0,this.buyHorse=void 0,this.groupList=void 0,this.currScore=void 0},t}(BaseServerValueInfo);__reflect(OnceResultInfo.prototype,"OnceResultInfo");var GameOverInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"roleId",{get:function(){return this._roleId},set:function(e){this._roleId=e,this.playerInfo=RoomManager.getPlayerInfoByRoleId(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(e){if(this._score=e,this._score){this.scoreInfoList||(this.scoreInfoList=new Array),ArrayUtil.Clear(this.scoreInfoList),this.totalScore=0;for(var t=void 0,n=void 0,i=0;i<e.length;i++)n=e[i],t=new OneRoundScoreInfo,t.round=i+1,t.score=n,this.scoreInfoList.push(t),this.totalScore+=n}},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.roleId=void 0,this.score=void 0,this.isMaxWin=void 0},t}(BaseServerValueInfo);__reflect(GameOverInfo.prototype,"GameOverInfo");var OneRoundScoreInfo=function(){function e(){}return e}();__reflect(OneRoundScoreInfo.prototype,"OneRoundScoreInfo");var ScoreChangeInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this.score=0,this.offsetScore=0},t}(BaseServerValueInfo);__reflect(ScoreChangeInfo.prototype,"ScoreChangeInfo");var PlayingFieldManager=function(){function e(){}return e.reqRoomListInfo=function(t){SocketManager.AddCommandListener(Command.Req_RoomInfo_3002,e.RoomListInfoResponse),SocketManager.Send(Command.Req_RoomInfo_3002,{type:t})},e.RoomListInfoResponse=function(t){if(SocketManager.RemoveCommandListener(Command.Req_RoomInfo_3002,e.RoomListInfoResponse),t.data)for(var n=new PlayingFieldRoomInfo,i=new BlindDefinition,a=0,o=t.data.roomList;a<o.length;a++){var r=o[a];i=BlindDefined.GetInstance().getBlindInfoBysBlind(r.smallBlind),n.copyValueFrom(r),n.bigBlind=i.bBlind,n.minBuy=i.sBuyin,n.maxBuy=i.bBuyin,n.tax=i.tax,e.roomList||(e.roomList=new Array),e.roomList.push(n)}e.onGetRoomListEvent.dispatch()},e}();PlayingFieldManager.onGetRoomListEvent=new ActionDispatcher,PlayingFieldManager.onCloseKeyboardEvent=new ActionDispatcher,__reflect(PlayingFieldManager.prototype,"PlayingFieldManager");var PlayingFieldRoomInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){},t}(BaseServerValueInfo);__reflect(PlayingFieldRoomInfo.prototype,"PlayingFieldRoomInfo");var PrefsManager=function(){function e(){}return e.SetAccountPassword=function(t,n){e.setValue(e.Login_Account,t),e.setValue(e.Login_Password,n)},e.setValue=function(t,n,i){void 0===i&&(i=!1),i?egret.localStorage.setItem(e.getUserId()+t,n):egret.localStorage.setItem(t,n)},e.getValue=function(t,n){return void 0===n&&(n=!1),n?egret.localStorage.getItem(e.getUserId()+t):egret.localStorage.getItem(t)},e.setBoolean=function(t,n,i){void 0===i&&(i=!1),e.setValue(t,n.toString(),i)},e.getBoolean=function(t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var a=e.getValue(t,i);return StringUtil.isNullOrEmpty(a)?n:StringUtil.toBoolean(a)},e.setNumber=function(t,n,i){void 0===i&&(i=!1),e.setValue(t,n.toString(),i)},e.getNumber=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var a=e.getValue(t,i);return StringUtil.isNullOrEmpty(a)?n:parseFloat(a)},e.getUserId=function(){return LoginManager.loginInfo?LoginManager.loginInfo.userid.toString():StringConstant.empty},e}();PrefsManager.Login_Account="login_account",PrefsManager.Login_Password="login_password",PrefsManager.Login_Token="login_token",PrefsManager.Login_LoginType="login_loginType",PrefsManager.Sound_Bg_Volume="sound_bg_volume",PrefsManager.Sound_Bg_Enable="sound_bg_enable",PrefsManager.Sound_Effect_Volume="sound_effect_volume",PrefsManager.Sound_Effect_Enable="sound_effect_enable",PrefsManager.Shake_Enable="sound_bg_enable",__reflect(PrefsManager.prototype,"PrefsManager");var LoginInfo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isWhitelist=!1,t.hasAlreadyCreateRole=!1,t}return __extends(t,e),t.prototype.reset=function(){},t.CreateFromProto=function(e){var n=new t(e);return null!=e.status&&(n.isWhitelist=parseInt(e.status)<0),n},t}(BaseServerValueInfo);__reflect(LoginInfo.prototype,"LoginInfo");var RoleInfo=function(){function e(){}return e.CreateFromProto=function(e){var t=e;return t},e}();__reflect(RoleInfo.prototype,"RoleInfo");var LoginManager=function(){function e(){}return Object.defineProperty(e,"loginMode",{get:function(){return e._loginMode},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginInfo",{get:function(){return e._loginInfo},enumerable:!0,configurable:!0}),Object.defineProperty(e,"account",{get:function(){return e._account},enumerable:!0,configurable:!0}),Object.defineProperty(e,"channelToken",{get:function(){return e._channelToken},enumerable:!0,configurable:!0}),e.SetAddress=function(t){t==ChannelLoginType.IntranetAccount?(e._address=ProjectDefined.GetInstance().getValue(ProjectDefined.intranetIp),e._port=ProjectDefined.GetInstance().getValue(ProjectDefined.intranetPort)):(e._address=VersionManager.loginAddress,e._port=VersionManager.loginPort)},e.Dispose=function(){e.OnComplete.clear(),null!=this._socket&&(e.RemoveAllListener(),e._socket.dispose(),e._socket=null)},e.Close=function(){null!=e._socket&&(e.RemoveAllListener(),e._socket.close())},e.RemoveAllListener=function(){UIManager.removeEventListener(UIModuleName.LoadingPanel,UIModuleEvent.OnTimeout,e.OnLoadingTimeout),e._socket.RemoveMessageListener(e.OnLoginMessage),e._socket.RemoveCommandListener(Command.Login_login,e.OnLogin),e._socket.RemoveCommandListener(Command.Login_exchange,e.OnExchange),e._socket.RemoveCommandListener(Command.Login_auth,e.OnAuth),e._socket.RemoveResultListener(e.OnResult)},e.GuestLogin=function(t){e._loginMode=LoginMode.Guest,e._isLogin=1,e._channel=t,e._account="游客",e._password=StringConstant.empty,e.Connect(e._address,e._port)},e.AccountLogin=function(t,n,i){e._loginMode=LoginMode.Account,e._isLogin=1,e._channel=t,e._account=n,e._password=i,e.Connect(e._address,e._port)},e.TokenDebug=function(t,n){e._loginMode=LoginMode.TokenDebug,e._isLogin=1,e._channel=t,e._tokenCode=n,e._tokenLoginCount=0,e.TokenLoginCoroutine()},e.TokenLogin=function(t,n){e._loginMode=LoginMode.Token,e._isLogin=1,e._channel=t,e._tokenCode=n,e._tokenLoginCount=0,clearTimeout(e._loginTimeId),e._loginTimeId=egret.setTimeout(e.TokenLoginCoroutine,this,1e3)},e.TokenLoginCoroutine=function(){e._tokenLoginCount++,clearTimeout(e._loginTimeId),e.Connect(e._address,e._port)},e.AccountRegister=function(t,n,i){e._loginMode=LoginMode.Account,e._isLogin=611,e._channel=t,e._account=n,e._password=i,e.Connect(e._address,e._port)},e.Connect=function(t,n){null==e._socket&&(e._socket=new LoginSocket,e._socket.initialize(GameSetting.LoginBin)),e.Close(),UIManager.addEventListener(UIModuleName.LoadingPanel,UIModuleEvent.OnTimeout,e.OnLoadingTimeout,this),UIManager.showPanel(UIModuleName.LoadingPanel),e._socket.AddMessageListener(e.OnLoginMessage),e._socket.AddResultListener(e.OnResult),e._socket.Connect(t,n)},e.OnLoadingTimeout=function(){e.Close(),AlertManager.showSingleAlert("网络连接超时！",e.OnErrorConfirm,null,null,"网络超时")},e.OnLogin=function(t){e._socket.RemoveCommandListener(Command.Login_login,e.OnLogin);var n=t.data.Version;if(VersionManager.VerifyGameServer(n)){var i=t.data.challenge;t.data.serverkey;e._hexsecret="266f889930929ff7";var a=Crypt.HmacSha1(e._hexsecret,i);e._socket.AddCommandListener(Command.Login_exchange,e.OnExchange),e._socket.Send(Command.Login_exchange,{hmac:a})}else UIManager.closePanel(UIModuleName.LoadingPanel),e.RemoveAllListener()},e.OnExchange=function(t){e._socket.RemoveCommandListener(Command.Login_exchange,e.OnExchange);var n=ChannelManager.deviceId,i=StringConstant.empty;i=e._loginMode==LoginMode.Account?StringUtil.format("{0}@{1}:{2}",Crypt.lb64encode(e._account),Crypt.lb64encode(e._password),e._isLogin):e._loginMode==LoginMode.Guest?n:e._tokenCode,i=Crypt.AESEncrypt(i,e._hexsecret),e._socket.AddCommandListener(Command.Login_auth,e.OnAuth);var a=ChannelManager.bundleId;e._socket.Send(Command.Login_auth,{token:i,channel:e._channel,device:n,bid:a})},e.OnAuth=function(t){e._socket.RemoveCommandListener(Command.Login_auth,e.OnAuth),e.Close(),UIManager.closePanel(UIModuleName.LoadingPanel),e._loginInfo=LoginInfo.CreateFromProto(t.data),e._loginInfo.secret=e._hexsecret,e._loginMode==LoginMode.Token?null!=e._loginInfo.channeldata&&(e._loginInfo.channeldata.hasOwnProperty("account")&&(e._account=e._loginInfo.channeldata.account),e._loginInfo.channeldata.hasOwnProperty("token")?e._channelToken=e._loginInfo.channeldata.token:e._channelToken=StringConstant.empty,ChannelManager.SetChannelData(e._account,e._channelToken)):e._loginMode==LoginMode.Account&&e._account&&PrefsManager.SetAccountPassword(e._account,e._password),SocketManager.Dispose(),e.OnComplete.dispatch()},e.OnLoginMessage=function(t){switch(NetUtil.Log(t),t.type){case SocketMessageType.Connect:console.log("Login服务器连接成功");var n="0.0.0";e._clientKey="xuEaV3HSKms=",e._socket.AddCommandListener(Command.Login_login,e.OnLogin),e._socket.Send(Command.Login_login,{clientkey:e._clientKey,Version:n});break;case SocketMessageType.NetworkError:case SocketMessageType.Failing:UIManager.closePanel(UIModuleName.LoadingPanel),e.Close();var i=new AlertInfo;i.title="网络异常",i.subTitle=t.errorCode,i.message="连接服务器失败",i.OnConfirm=e.OnErrorConfirm,AlertManager.showAlert(i)}},e.OnResult=function(t){if(t.op==SpRpcOp.Response&&0!=t.error)if(e.Close(),UIManager.closePanel(UIModuleName.LoadingPanel),t.error==e.TokenErrorCode&&e._tokenLoginCount<e.TokenLoginTryTimes)clearTimeout(e._loginTimeId),e._loginTimeId=egret.setTimeout(e.TokenLoginCoroutine,this,1e3);else{t.error==e.TokenErrorCode&&(ChannelManager.loginValidateFail(),e.OnValiateFail.dispatch());var n=new AlertInfo;n.title="提示",n.subTitle="protocol:"+t.cmdId+",code:"+t.error,n.message=ErrorDefined.GetInstance().getDetails(t.error),n.OnConfirm=e.OnErrorConfirm,console.warn(StringUtil.format("{0},描述：{1}",n.subTitle,n.message)),AlertManager.showAlert(n)}},e.OnErrorConfirm=function(t){e.OnError.dispatch()},e.reqCreateRole=function(t,n){var i=function(a){SocketManager.RemoveCommandListener(Command.Req_CreateRole_3012,i),UserManager.userInfo.name=n,UserManager.userInfo.sex=t,e.OnCreateRole.dispatch()};SocketManager.AddCommandListener(Command.Req_CreateRole_3012,i),SocketManager.Send(Command.Req_CreateRole_3012,{sex:t,name:n})},e}();LoginManager.TokenLoginTryTimes=3,LoginManager.TokenErrorCode=406,LoginManager._tokenLoginCount=0,LoginManager.OnComplete=new ActionDispatcher,LoginManager.OnError=new ActionDispatcher,LoginManager.OnValiateFail=new ActionDispatcher,LoginManager.OnCreateRole=new ActionDispatcher,__reflect(LoginManager.prototype,"LoginManager");var ServerInfo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roleId=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCrowded",{get:function(){return this._count>ProjectDefined.GetInstance().getValue(ProjectDefined.serverCrowded)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"count",{set:function(e){this._count=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMaintain",{get:function(){return this._isMaintain},enumerable:!0,configurable:!0}),t.prototype.reset=function(){},t.CreateFromProto=function(e,n){var i=new t(e),a=e.status;return 1==a?i._isMaintain=!0:i._isMaintain=!1,i},t}(BaseServerValueInfo);__reflect(ServerInfo.prototype,"ServerInfo");var MailManager=function(){function e(){}return e.Reset=function(){e.unReadCount=0,e.isRequestingFirstComplete=!1,ArrayUtil.Clear(e.mailList),SocketManager.AddCommandListener(Command.Rec_Mail_New_Notify_2024,e.OnMailNewNofityFromServer)},e.clearList=function(){ArrayUtil.Clear(e.mailList)},e.OnMailNewNofityFromServer=function(t){e.unReadCount++},e.initialize=function(t){if(t.data.MailList)for(var n=0,i=t.data.MailList;n<i.length;n++){var a=i[n],o=new MailInfo;o.copyValueFrom(a);for(var r=0,s=JSON.parse(o.attaJson);r<s.length;r++){var l=s[r],c=new AwardInfoDefinition;c.id=l.Id,c.type=l.Type,c.count=l.Count,o.attaList=new Array,o.attaList.push(c)}e.mailList.push(o)}},e.RequestMailList=function(e,t){SocketManager.AddCommandListener(Command.Req_Mail_3097,this.onGetMailList,this),SocketManager.Send(Command.Req_Mail_3097,{StartId:e,Count:t})},e.onGetMailList=function(t){SocketManager.RemoveCommandListener(Command.Req_Mail_3097,this.onGetMailList),e.initialize(t),e.getMailListEvent.dispatch()},e.getMaxMailId=function(){if(e.mailList){for(var t=0,n=0;n<e.mailList.length;n++)e.mailList[n].Id>t&&(t=e.mailList[n].Id);return t}},e.getListByType=function(t){if(e.mailList){for(var n=new Array,i=0,a=e.mailList;i<a.length;i++){var o=a[i];o.Type==t&&n.push(o)}return n}return null},e}();MailManager.mailList=new Array,MailManager.unReadCount=0,MailManager.isRequestingFirstComplete=!1,MailManager.getMailListEvent=new ActionDispatcher,MailManager.getMailPrizeEvent=new ActionDispatcher,__reflect(MailManager.prototype,"MailManager");var MailInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this
}return __extends(t,e),t.prototype.reset=function(){},t}(BaseServerValueInfo);__reflect(MailInfo.prototype,"MailInfo");var PayManager=function(){function e(){}return e.initialize=function(){},e.recCardNumUpdate=function(e){},e.reqBuyCard=function(t){var n={};n.price=t;var i=function(t){var a=e.getPayInfoByPrice(n.price);a&&a.dayCount++,e.dispatchBuyCardEvent(n.price),SocketManager.RemoveCommandListener(Command.Req_BuyCard_3001,i)};SocketManager.AddCommandListener(Command.Req_BuyCard_3001,i),SocketManager.SendDiscRetry(Command.Req_BuyCard_3001,{price:t})},e.getPayInfoByPrice=function(t){for(var n=0,i=e.payList;n<i.length;n++){var a=i[n];if(a.definition.price==t)return a}return null},e.dispatchBuyCardEvent=function(t){e.buyOverAction.dispatch(t)},e.dispatchCardNumEvent=function(t){e.cardNumUpdateAction.dispatch(t)},e}();PayManager.payList=new Array,PayManager.buyOverAction=new ActionDispatcher,PayManager.cardNumUpdateAction=new ActionDispatcher,__reflect(PayManager.prototype,"PayManager");var PayInfo=function(){function e(){this._id=0,this._dayCount=0}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._definition=PayDefined.GetInstance().getDefinition(e,PayDefined.GetInstance().payList)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dayCount",{get:function(){return this._dayCount},set:function(e){this._dayCount=e},enumerable:!0,configurable:!0}),e}();__reflect(PayInfo.prototype,"PayInfo");var SaveManager=function(){function e(){}return e.reqSaveWithdrawGold=function(e,t,n){var i=function(e){console.log(e),SocketManager.RemoveCommandListener(Command.Req_saveORwithdraw_3014,i),1==t?UIManager.showFloatTips("存入成功"):2==t&&UIManager.showFloatTips("取出成功")},a=function(e){SocketManager.RemoveErrorListener(Command.Req_saveORwithdraw_3014,a),3004==e.error&&AlertManager.showSingleAlert("您输入的密码错误，请重新输入！")};SocketManager.AddCommandListener(Command.Req_saveORwithdraw_3014,i),SocketManager.AddErrorListener(Command.Req_saveORwithdraw_3014,a),SocketManager.Send(Command.Req_saveORwithdraw_3014,{num:e,type:t,pwd:n})},e.reqCreatePwd=function(t){var n=function(t){SocketManager.RemoveCommandListener(Command.Req_safePwd_3017,n),e.PwdSuccessEvent.dispatch()};SocketManager.AddCommandListener(Command.Req_safePwd_3017,n),SocketManager.Send(Command.Req_safePwd_3017,{newPwd:t})},e.reqModifyPwd=function(t,n){var i=function(t){SocketManager.RemoveCommandListener(Command.Req_safePwd_3017,i),e.modifyPwdEvent.dispatch()},a=function(e){SocketManager.RemoveErrorListener(Command.Req_safePwd_3017,a),3001==e.error&&AlertManager.showSingleAlert("您的原密码不正确！")};SocketManager.AddErrorListener(Command.Req_safePwd_3017,a),SocketManager.AddCommandListener(Command.Req_safePwd_3017,i),SocketManager.Send(Command.Req_safePwd_3017,{newPwd:t,oldPwd:n})},e}();SaveManager.PwdSuccessEvent=new ActionDispatcher,SaveManager.modifyPwdEvent=new ActionDispatcher,__reflect(SaveManager.prototype,"SaveManager");var ShoppingManager=function(){function e(){}return e.initialize=function(){ArrayUtil.Clear(e.shoppingList);for(var t,n=0;n<ShoppingDefined.GetInstance().shoppingList.length;n++)t=new ShoppingInfo,t.id=ShoppingDefined.GetInstance().shoppingList[n].id,1==t.definition.type?e.goldList.push(t):2==t.definition.type?e.diamondList.push(t):e.vipList.push(t)},e.reqBuyGdOrDmd=function(t){var n=function(t){SocketManager.RemoveCommandListener(Command.Exchange_3113,n),e.buyOverAction.dispatch(),UIManager.showFloatTips("购买成功了,订单已发送"),console.log(t)};SocketManager.AddCommandListener(Command.Exchange_3113,n),SocketManager.Send(Command.Exchange_3113,{Id:t})},e}();ShoppingManager.shoppingList=new Array,ShoppingManager.goldList=new Array,ShoppingManager.diamondList=new Array,ShoppingManager.vipList=new Array,ShoppingManager.buyOverAction=new ActionDispatcher,__reflect(ShoppingManager.prototype,"ShoppingManager");var ShoppingInfo=function(){function e(){this._id=0}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._definition=ShoppingDefined.GetInstance().getDefinition(e,ShoppingDefined.GetInstance().shoppingList)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!0,configurable:!0}),e}();__reflect(ShoppingInfo.prototype,"ShoppingInfo");var ShoppingVipInfo=function(){function e(){this._id=0}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._definition=AwardDefined.GetInstance().getAwardDefinition(this._id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!0,configurable:!0}),e}();__reflect(ShoppingVipInfo.prototype,"ShoppingVipInfo");var ShoppingType;!function(e){e[e.gold=0]="gold",e[e.diamond=1]="diamond"}(ShoppingType||(ShoppingType={}));var VipManager=function(){function e(){}return e.getVipLevel=function(e){for(var t=ProjectDefined.GetInstance().getValue(ProjectDefined.vipLevel),n=0;n<t.length;n++)if(!(e>t[n]))return n},e.getVipType=function(e,t){TimeManager.GetServerUtcTimestamp();return t&&t>0?VipType.YearVip:e&&e>0?VipType.Vip:VipType.NoVip},e.initialize=function(){SocketManager.RemoveCommandListener(Command.Rec_GetVipTime_2001,this.onGetVipTime),SocketManager.AddCommandListener(Command.Rec_GetVipTime_2001,this.onGetVipTime),this.refreshVipInfo()},e.onGetVipTime=function(t){UserManager.userInfo.vipTime=t.data.vipTime,UserManager.userInfo.yearVipTime=t.data.yearVipTime,UserManager.userInfo.vipLevel=t.data.vipLevel,UserManager.userInfo.vipExp=t.data.vipExp,UserManager.userInfo.vipType=e.getVipType(UserManager.userInfo.vipTime,UserManager.userInfo.yearVipTime),UserManager.userInfo.vipSpeed=ProjectDefined.GetInstance().getVipSpeedDefinition(UserManager.userInfo.vipType).speed,e.vipUpgradeEvent.dispatch()},e.refreshVipInfo=function(){UserManager.userInfo.vipType=e.getVipType(UserManager.userInfo.vipTime,UserManager.userInfo.yearVipTime),UserManager.userInfo.vipSpeed=ProjectDefined.GetInstance().getVipSpeedDefinition(UserManager.userInfo.vipType).speed},e.isVip=function(){return null==UserManager.userInfo.vipType||UserManager.userInfo.vipType==VipType.NoVip?!1:!0},e.GetVipTime=function(){var e=TimeManager.GetServerUtcTimestamp();switch(UserManager.userInfo.vipType){case VipType.NoVip:return 0;case VipType.YearVip:return UserManager.userInfo.vipTime>e?UserManager.userInfo.vipTime:UserManager.userInfo.yearVipTime;case VipType.Vip:return UserManager.userInfo.vipTime}},e}();VipManager.vipUpgradeEvent=new ActionDispatcher,__reflect(VipManager.prototype,"VipManager");var VipType;!function(e){e[e.NoVip=0]="NoVip",e[e.Vip=1]="Vip",e[e.YearVip=2]="YearVip"}(VipType||(VipType={}));var ItemGetInfo=function(){function e(){this.size=100}return e.CreateFromAwardInfoDefinition=function(t,n){void 0===n&&(n=65);var i=new e;return null!=t&&(i.id=t.id,i.type=t.type,i.count=t.count,i.size=n),i},e}();__reflect(ItemGetInfo.prototype,"ItemGetInfo");var ItemInfo=function(){function e(){}return Object.defineProperty(e.prototype,"itemId",{get:function(){return this._itemId},set:function(e){this._itemId=e,this._definition=ItemDefined.GetInstance().getItemDefinition(this._itemId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),e}();__reflect(ItemInfo.prototype,"ItemInfo");var PropertyManager=function(){function e(){}return Object.defineProperty(e,"itemGetList",{get:function(){return e._itemGetList},enumerable:!0,configurable:!0}),e.OpenGet=function(){e._isOpen=!0,ArrayUtil.Clear(e._itemGetList),e._goldOffset=UserManager.userInfo.gold,e._diamondOffset=UserManager.userInfo.diamond,e._expOffset=UserManager.userInfo.exp},e.OpenGoldGet=function(){e._goldOffset=UserManager.userInfo.gold},e.OpenDiamondGet=function(){e._diamondOffset=UserManager.userInfo.diamond},e.Clear=function(){e._isOpen=!1},e.ShowGoldPanel=function(){if(0==e._isOpen){var t=UserManager.userInfo.gold-e._goldOffset;t>0&&UIManager.showPanel(UIModuleName.GetCoinTipsPanel,"您获得了"+MathUtil.formatNum(t)+"金币")}},e.ShowItemList=function(){e._isOpen&&(e._goldOffset=UserManager.userInfo.gold-e._goldOffset,e._diamondOffset=UserManager.userInfo.diamond-e._diamondOffset,e._expOffset=UserManager.userInfo.exp=e._expOffset,e.AddBase(PropertyId.gold,e._goldOffset),e.AddBase(PropertyId.diamond,e._diamondOffset),e.AddBase(PropertyId.exp,e._expOffset),e._itemGetList.length>0)},e.AddBase=function(t,n){if(n>0&&e._isOpen){var i=new ItemGetInfo;i.id=t,i.count=n,e._itemGetList.push(i)}},e}();PropertyManager._isOpen=!1,PropertyManager._itemGetList=new Array,__reflect(PropertyManager.prototype,"PropertyManager");var RoomManager=function(){function e(){}return e.setMod=function(){e.roomInfo&&e.roomInfo.playerList&&(e.mod=e.roomInfo.playerList.length)},Object.defineProperty(e,"isMineHost",{get:function(){var t=e.mineInfo;return t?e.isHost(t.roleId):!1},enumerable:!0,configurable:!0}),e.isHost=function(t){return e.roomInfo&&t==e.roomInfo.hostRoleId?!0:!1},e.clear=function(){e.isInRoom=!1,e.roomInfo=null,e.isReqExitRoomIng=!1},e.reLogin=function(){e.roomInfo&&ArrayUtil.Clear(e.roomInfo.playerList),e.clear()},e.clearMaster=function(){if(e.roomInfo&&e.roomInfo.playerList)for(var t=0,n=e.roomInfo.playerList;t<n.length;t++){var i=n[t];i.isMaster=!1,i.hosted=!1}},e.nextRoundOper=function(){if(e.roomInfo)for(var t=0,n=e.roomInfo.playerList;t<n.length;t++){var i=n[t];i.isTing=!1,i.hosted=!1,i.isReady=!1,ArrayUtil.Clear(i.outCard),ArrayUtil.Clear(i.groupList)}},e.roundNumOper=function(){e.roomInfo&&(e.roomInfo.roundNum++,e.roomInfo.roundNum>e.roomInfo.round&&(e.roomInfo.roundNum=e.roomInfo.round))},e.reqJoinRoom=function(t,n){SocketManager.AddCommandListener(Command.Req_JoinInRoom_3004,e.initialize),SocketManager.Send(Command.Req_JoinInRoom_3004,{roomId:t,session:n})},e.initialize=function(t){if(GoCardProcessManager.initialize(),SocketManager.RemoveCommandListener(Command.Req_JoinInRoom_3004,e.initialize),e.clear(),t.data&&t.data.roomId){if(e.isInRoom=!0,e.roomInfo=new RoomInfo(t.data),e.mineInfo&&e.shouPaiOper(),e.roomInfo.play==RoomState.WAIT&&void 0!=e.roomInfo.boomCard){var n=e.getPlayerInfoByPos(e.roomInfo.boomPos);if(n){e.roomInfo.boomPos==e.mineInfo.pos&&(e.roomInfo.myLastCard=void 0,ArrayUtil.RemoveItem(e.roomInfo.boomCard,e.roomInfo.shouPai));var i=e.getGroupCard(e.roomInfo.boomCard,n.groupList);i&&(i.action=ActionType.BuGang)}}if(e.roomInfo&&e.roomInfo.playerList)for(var a=void 0,o=0;o<e.roomInfo.playerList.length;o++)a=e.roomInfo.playerList[o],e.playerNameOper(a),e.roomInfo.play==RoomState.NIL&&(a.isTing=!1),a.roleId!=UserManager.userInfo.roleId&&a.groupList&&a.groupList.sort(SortUtil.sortGroupCard),a.isMaster&&(GoCardProcessManager.lastMastPos=a.pos);e.roomInfo.play==RoomState.NIL&&e.roomInfo.roundNum<1&&e.checkSameIp(),e.dispatchGetRoomInfoEvent()}SocketManager.AddCommandListener(Command.Rec_PushOtherPlayerJoin_2001,e.onPushOtherPlayerEnter),SocketManager.AddCommandListener(Command.Rec_PushReqExitRoom_2002,e.onPushPlayerExitReq),SocketManager.AddCommandListener(Command.Rec_PushExitVoteResult_2003,e.onPushExitVoteResult),SocketManager.AddCommandListener(Command.Rec_PushRoomDisbanded_2015,e.onPushRoomDisbaned),SocketManager.AddCommandListener(Command.Rec_PushPlayerExitRoom_2023,e.onPushOtherPlayerExit),e.dispatchReqJoinRoomEvent()},e.onPushOtherPlayerEnter=function(t){if(t.data){if(!e.roomInfo)return;var n=t.data.roleId,i=e.getPlayerInfoByRoleId(n);i?i.copyValueFrom(t.data):(i=new PlayerInfo(t.data),e.playerNameOper(i),e.roomInfo.playerList.push(i)),e.checkSameIp(),e.setMod(),e.dispatchOtherPlayerJoinEvent(i)}},e.checkSameIp=function(){for(var t,n,i,a=e.roomInfo.playerList.length,o=0;a>o;o++)if(t=e.roomInfo.playerList[o],t.roleId!=UserManager.userInfo.roleId){n=StringConstant.empty;for(var r=0;a>r;r++)i=e.roomInfo.playerList[r],i.roleId!=UserManager.userInfo.roleId&&i.roleId!=t.roleId&&i.ip==t.ip&&(n+=i.name+"、");n&&(n+=t.name,AlertManager.showSingleAlertByString(StringUtil.format("请注意，房间中{0}处于同一IP！",n)))}},e.playerNameOper=function(e,t,n){if(void 0===t&&(t="name"),void 0===n&&(n="roleId"),e&&e.hasOwnProperty(n)){var i=e,a=StringConstant.empty;ChannelManager.loginType==ChannelLoginType.Guest&&"游客"!=i[t]&&(a="游客"),i[t]?i[t]=a+i[t]:i[t]=a+""}},e.onPushPlayerExitReq=function(t){if(t.data){e._reqExitRoleId=t.data.roleId;var n=e.getPlayerInfoByRoleId(e._reqExitRoleId);if(n&&(n.quit=RoomQuitState.ReqQuit),e.roomInfo.quitTime=TimeManager.GetServerUtcTimestamp(),e.roomInfo&&e.roomInfo.playerList&&1==e.roomInfo.playerList.length)return n=e.roomInfo.playerList[0],void(n.roleId==UserManager.userInfo.roleId&&n.quit==RoomQuitState.ReqQuit&&(e.roomInfo.quitTime=void 0,console.log("房间里面只有一个人 接受退出房间结果，直接解散！"),e.exitRoom()));e._reqExitRoleId!=UserManager.userInfo.roleId&&UIManager.showPanel(UIModuleName.RoomDisbandOperPanel)}},e.reqIsAgreeExitRoom=function(t){SocketManager.AddCommandListener(Command.Req_IsAgreeExit_3006,e.onIsAgreeExitRoomResult),SocketManager.Send(Command.Req_IsAgreeExit_3006,{isAgree:t})},e.onIsAgreeExitRoomResult=function(t){SocketManager.RemoveCommandListener(Command.Req_IsAgreeExit_3006,e.onIsAgreeExitRoomResult),e.dispatchVoteSuccessEvent()},e.onPushExitVoteResult=function(t){if(t.data){var n=t.data.roleId,i=t.data.isAgree,a=e.getPlayerInfoByRoleId(n);if(i&&a?a.quit=RoomQuitState.Argree:a&&(a.quit=RoomQuitState.Refuse),e.mineInfo&&e.mineInfo.quit==RoomQuitState.ReqQuit){var o=UIManager.getPanel(UIModuleName.RoomDisbandInfoPanel);o?o.refreshPanel():UIManager.showPanel(UIModuleName.RoomDisbandInfoPanel)}if(e.roomInfo){for(var r=0,s=0,l=e.roomInfo.playerList.length-1,c=0;l+1>c;c++)a=e.roomInfo.playerList[c],a.quit==RoomQuitState.Argree?r++:a.quit==RoomQuitState.Refuse&&s++;var h=StringConstant.empty;if(r>=l){for(var c=0;l+1>c;c++)a=e.roomInfo.playerList[c],a.quit==RoomQuitState.Argree&&(h+=" "+a.name+" ");console.log("解散退出房间！"),e.exitRoom(),AlertManager.showSingleAlert("经"+h+"同意，房间已解散。")}else if(s+r>=e.roomInfo.playerList.length-1){for(var c=0;l+1>c;c++)a=e.roomInfo.playerList[c],a.quit==RoomQuitState.Refuse&&(h+=" "+a.name+" ");var d=e.getPlayerInfoByRoleId(e._reqExitRoleId);d?AlertManager.showSingleAlert(h+"拒绝解散房间，"+d.name+"房间解散申请失败。"):AlertManager.showSingleAlert(h+"拒绝解散房间，解散房间失败。"),e.clearExitRoomRecord()}}e.dispatchPushVoteEvent()}},e.clearExitRoomRecord=function(){for(var t=0,n=e.roomInfo.playerList;t<n.length;t++){var i=n[t];i.quit=RoomQuitState.Wait}UIManager.closePanel(UIModuleName.RoomDisbandInfoPanel),UIManager.closePanel(UIModuleName.RoomDisbandOperPanel),e.isReqExitRoomIng=!1},e.onPushRoomDisbaned=function(t){if(t.data){var n=t.data.type;switch(n){case DisbandRomType.TimeOut:if(e.roomInfo&&e.roomInfo.playerList){for(var i=Math.ceil(ProjectDefined.GetInstance().getValue(ProjectDefined.waitReadyTime)/60),a=void 0,o=0;o<e.roomInfo.playerList.length&&(a=e.roomInfo.playerList[o],a.isReady);o++);a?AlertManager.showSingleAlertByString(a.name+" "+i.toString()+"分钟未准备，房间已解散！"):AlertManager.showSingleAlertByString("有人"+i+"分钟未准备，房间已解散！")}break;case DisbandRomType.HostDisband:e.roomInfo&&(e.isMineHost?AlertManager.showSingleAlertByString("房间已解散！"):AlertManager.showSingleAlertByString("房主已解散房间，请选择其他房间！ "))}console.log("推送房间解散退出房间！"),e.exitRoom()}},e.exitRoom=function(){e.roomInfo&&(e.clearExitRoomRecord(),ArrayUtil.RemoveItem(e.mineInfo,e.roomInfo.playerList),GoCardProcessManager.clear(),e.roomInfo=null,e.dispatchReqExitRoomEvent(),SceneManager.goToHall(),e.clear())},e.onPushOtherPlayerExit=function(t){if(t.data){var n=t.data.roleId;if(e.dispatchPlayerExitRoomEvent(n),n!=UserManager.userInfo.roleId&&e.roomInfo&&e.roomInfo.playerList)for(var i=e.roomInfo.playerList.length,a=void 0,o=0;i>o;o++)if(a=e.roomInfo.playerList[o],a.roleId==n){ArrayUtil.RemoveItem(a,e.roomInfo.playerList);break}}},e.reqCreateRoom=function(t,n,i){var a={};a.round=t,a.type=n,a.ante=i;var o=function(t){e.roomInfo=new RoomInfo(t.data),e.roomInfo.round=a.round,e.roomInfo.ante=a.ante,e.roomInfo.type=a.type,e.roomInfo.roundNum=0,e.roomInfo.head=0,e.roomInfo.tail=0,e.roomInfo.shouPai=new Array,e.roomInfo.play=RoomState.NIL;var n=new PlayerInfo;n.roleId=UserManager.userInfo.roleId,ChannelManager.loginType==ChannelLoginType.Guest?n.name="游客":(n.name=UserManager.userInfo.name,n.head=UserManager.userInfo.head,n.sex=UserManager.userInfo.sex,n.ip=UserManager.userInfo.ip),n.isMaster=!0,GoCardProcessManager.lastMastPos=1,n.pos=1,n.isTing=!1,n.groupList=new Array,e.playerNameOper(n),e.roomInfo.playerList=new Array,e.roomInfo.playerList.push(n),e.roomInfo.pos=1,e.roomInfo.hostRoleId=UserManager.userInfo.roleId,e.dispatchCreateRoomEvent(),SocketManager.RemoveCommandListener(Command.Req_CreateRoom_3003,o),e.isInRoom=!0,e.setMod()};SocketManager.AddCommandListener(Command.Req_CreateRoom_3003,o),SocketManager.Send(Command.Req_CreateRoom_3003,{round:t,type:n,ante:i})},e.reqExitRoom=function(t){if(e.isReqExitRoomIng)return void UIManager.showFloatTips("请求已发出，请等待其他玩家投票结果！");var n=t,i=function(t){SocketManager.RemoveCommandListener(Command.Req_ExitRoom_3005,i),n?(console.log("最后一次直接退出房间！"),e.exitRoom()):(UIManager.closePanel(UIModuleName.SettingPanel),UIManager.showPanel(UIModuleName.RoomDisbandInfoPanel),e.mineInfo&&(e.mineInfo.quit=RoomQuitState.ReqQuit))};SocketManager.AddCommandListener(Command.Req_ExitRoom_3005,i),SocketManager.Send(Command.Req_ExitRoom_3005),e.isReqExitRoomIng=!0},e.findPlayerInfo=function(t,n){if(e.roomInfo){var i=e.getPos(t,n);return e.getPlayerInfoByPos(i)}return null},e.getPlayerInfoByPosType=function(t){return e.mineInfo?e.findPlayerInfo(e.mineInfo.pos,t):null},e.getGroupCard=function(e,t){for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a.card==e)return a}return null},e.getPos=function(e,t){if(e>0){var n=e+this.getPosTypeIndex(t);return n>4&&(n-=4),n}return-1},e.getPosByPosTypeForMine=function(t){return e.mineInfo?e.getPos(e.mineInfo.pos,t):-1},e.getPosTypeIndex=function(e){switch(e){case PosType.BenJia:return 0;case PosType.XiaJia:return 1;case PosType.DuiJia:return 2;case PosType.ShangJia:return 3}return-1},e.getPosType=function(t,n){return t>n?n+=e.mod-t:n>=t&&(n-=t),n+1},e.getPosTypeForMine=function(t){return e.mineInfo?e.getPosType(e.mineInfo.pos,t):0},Object.defineProperty(e,"mineInfo",{get:function(){if(e.roomInfo)for(var t=0,n=e.roomInfo.playerList;t<n.length;t++){var i=n[t];if(i.roleId==UserManager.userInfo.roleId)return i}return null},enumerable:!0,configurable:!0}),e.getPlayerInfoByPos=function(t){if(e.roomInfo)for(var n=0,i=e.roomInfo.playerList;n<i.length;n++){var a=i[n];if(a.pos==t)return a}return null},e.getPlayerInfoByRoleId=function(t){if(e.roomInfo)for(var n=0,i=e.roomInfo.playerList;n<i.length;n++){var a=i[n];if(a.roleId==t)return a}return null},Object.defineProperty(e,"masterInfo",{get:function(){if(e.roomInfo)for(var t=0,n=e.roomInfo.playerList;t<n.length;t++){var i=n[t];if(i.isMaster)return i}return null},enumerable:!0,configurable:!0}),e.shouPaiOper=function(){},e.getShouPaiNum=function(t){if(e.mineInfo){var n=e.getPosByPosTypeForMine(t),i=e.getPlayerInfoByPos(n);if(i)return i.shouPaiNum}return 0},Object.defineProperty(e,"isSelfAction",{get:function(){return e.mineInfo&&e.roomInfo&&e.roomInfo.play==RoomState.PUT&&e.mineInfo.pos==e.roomInfo.pos?!0:!1},enumerable:!0,configurable:!0}),e.getPosTypeByRoleId=function(t){var n=e.getPlayerInfoByRoleId(t);return n?e.getPosTypeForMine(n.pos):PosType.BenJia},e.updateHead=function(t){t&&e.roomInfo.playerList&&(e.roomInfo.head+=t,e.dispatchHeadChangeEvent())},Object.defineProperty(e,"waitReadyTime",{get:function(){if(e.roomInfo){var t=ProjectDefined.GetInstance().getValue(ProjectDefined.waitReadyTime),n=TimeManager.GetServerUtcTimestamp()-e.roomInfo.roundEndTime;return t-n}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"remainTimeStr",{get:function(){if(e.roomInfo){var t=TimeManager.GetServerUtcTimestamp()-e.roomInfo.quitTime,n=ProjectDefined.GetInstance().getValue(ProjectDefined.waitDisbandTime),i=n-t;if(i>=0){var a=Math.floor(i/60),o=DateTimeUtil.formatCountdown(a),r=Math.round(i-60*a);return o+=":"+DateTimeUtil.formatCountdown(r)}return StringConstant.empty}return StringConstant.empty},enumerable:!0,configurable:!0}),e.dispatchCreateRoomEvent=function(){e.createRoomEA.dispatch()},e.dispatchGetRoomInfoEvent=function(){e.getRoomInfoEA.dispatch()},e.dispatchOtherPlayerJoinEvent=function(t){e.otherPlayerJoinEA.dispatch(t)},e.dispatchReqJoinRoomEvent=function(){e.reqJoinRoomEA.dispatch()},e.dispatchReqExitRoomEvent=function(){e.reqExitRoomEA.dispatch()},e.dispatchHeadChangeEvent=function(){e.headChangeEa.dispatch()},e.dispatchPosChangeEvent=function(){e.posChangeEa.dispatch()},e.dispatchPlayerExitRoomEvent=function(t){e.playerExitRoomEa.dispatch(t)},e.dispatchVoteSuccessEvent=function(){e.voteSuccessEa.dispatch()},e.dispatchPushVoteEvent=function(){e.pushVoteResultEa.dispatch()},e}();RoomManager.createRoomEA=new ActionDispatcher,RoomManager.getRoomInfoEA=new ActionDispatcher,RoomManager.otherPlayerJoinEA=new ActionDispatcher,RoomManager.reqJoinRoomEA=new ActionDispatcher,RoomManager.reqExitRoomEA=new ActionDispatcher,RoomManager.headChangeEa=new ActionDispatcher,RoomManager.posChangeEa=new ActionDispatcher,RoomManager.playerExitRoomEa=new ActionDispatcher,RoomManager.voteSuccessEa=new ActionDispatcher,RoomManager.pushVoteResultEa=new ActionDispatcher,__reflect(RoomManager.prototype,"RoomManager");var RoomInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"pos",{get:function(){return this._pos},set:function(e){this._pos=e,RoomManager.dispatchPosChangeEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touziTotalNum",{get:function(){return this.num2+this.num1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minTouziNum",{get:function(){return Math.min(this.num1,this.num2)},enumerable:!0,configurable:!0}),t.prototype.reset=function(){this.myLastCard=void 0},t}(BaseServerValueInfo);__reflect(RoomInfo.prototype,"RoomInfo");var PlayerInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this.score=0,this.pos=0,this.isTing=!1,this.isReady=!1,this.hosted=!1,this.isOutOfCard=!1,this.currScore=0,this.quit=RoomQuitState.Wait},t.prototype.clear=function(){this.isTing=!1,this.hosted=!1,this.isReady=!1},t}(BaseServerValueInfo);__reflect(PlayerInfo.prototype,"PlayerInfo");var GroupCardInfo=function(){function e(){}return e}();__reflect(GroupCardInfo.prototype,"GroupCardInfo");var DisbandRomType;!function(e){e[e.TimeOut=1]="TimeOut",e[e.HostDisband=2]="HostDisband"}(DisbandRomType||(DisbandRomType={}));var CardShowUtil=function(){function e(){}return e.setTilt=function(e,t,n){var i=0,a=0;e&&e%90!=0&&(i=Math.tan(e*Math.PI/180)),t&&t%90!=0&&(a=Math.tan(t*Math.PI/180)),(0!=i||0!=a)&&(n.matrix=n.matrix.append(1,a,i,1,0,0))},e}();__reflect(CardShowUtil.prototype,"CardShowUtil");var GameScene=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.clear=function(){this.onDisable(),GoCardProcessManager.clear()},t.prototype.onEnable=function(){UIManager.addEventListener(UIModuleName.GameScenePanel,UIModuleEvent.COMPLETE,GoCardProcessManager.ready,this)},t.prototype.onDisable=function(){UIManager.removeEventListener(UIModuleName.GameScenePanel,UIModuleEvent.COMPLETE,GoCardProcessManager.ready)},t.prototype.initialize=function(t,n){this._isNeedReady=n,e.prototype.initialize.call(this,t,n)},t.prototype.onResourceLoadComplete=function(){e.prototype.onResourceLoadComplete.call(this);var t=RoomManager.mineInfo;if(t){if(RoomManager.roomInfo.shouPai&&RoomManager.roomInfo.shouPai.length>0&&RoomManager.roomInfo.play!=RoomState.NIL?GoCardProcessManager.state=GameSceneState.Processing:t.isReady&&RoomManager.roomInfo.play==RoomState.NIL?GoCardProcessManager.state=GameSceneState.WaitStart:!t.isReady&&RoomManager.roomInfo.play==RoomState.NIL&&RoomManager.roomInfo.roundNum>0?GoCardProcessManager.state=GameSceneState.OneRoundOver:console.log("房间状态未知!"),this.onEnable(),UIManager.showPanel(UIModuleName.GameScenePanel,this._isNeedReady),!this.gameProcesser){var n=UIManager.getPanel(UIModuleName.GameScenePanel);this.gameProcesser=new GameProcesser(n)}this.gameProcesser.onEnable(),GoCardProcessManager.state!=GameSceneState.Processing||this._isNeedReady||(SceneManager.gameScene.gameProcesser.gameScenePanel.showWaitGroup(!1),RoomManager.roomInfo&&RoomManager.roomInfo.shouPai&&RoomManager.roomInfo.shouPai.length>0&&(RoomManager.roomInfo.head+=53),this.gameProcesser.showCardWall())}},t}(BaseScene);__reflect(GameScene.prototype,"GameScene");var GameSceneState;!function(e){e[e.None=0]="None",e[e.WaitStart=1]="WaitStart",e[e.Processing=2]="Processing",e[e.OneRoundOver=3]="OneRoundOver",e[e.RunFapai=4]="RunFapai"}(GameSceneState||(GameSceneState={}));var HallScene=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.clear=function(){UIManager.closePanel(UIModuleName.GameHallPanel)},t.prototype.initialize=function(t,n){e.prototype.initialize.call(this,t,n)},t.prototype.onResourceLoadComplete=function(){e.prototype.onResourceLoadComplete.call(this),UIManager.showPanel(UIModuleName.GameHallPanel)},t}(BaseScene);__reflect(HallScene.prototype,"HallScene");var LoginScene=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isLoginingAcount=!1,t._lastLoginSuccessDateTime=0,t}return __extends(t,e),t.prototype.clear=function(){this.RemoveChannelEvents(),this.RemoveGameLoginEvents(),this.RemoveLoginBarEvents(),LoginManager.Dispose()},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),ChannelManager.OnInitComplete.addListener(this.OnChannelInitComplete,this),ChannelManager.Initialize()},t.prototype.OnChannelInitComplete=function(){ChannelManager.OnInitComplete.removeListener(this.OnChannelInitComplete),VersionManager.Initialize(),this.InitNetworkVersion()},t.prototype.InitNetworkVersion=function(){t.SkipVersion,ChannelManager.OnHotUpdateComplete.addListener(this.onEnterLogin,this),VersionManager.loadServerVersion()},t.prototype.onEnterLogin=function(){ChannelManager.OnHotUpdateComplete.removeListener(this.onEnterLogin),this._versionDateTime=Date.now(),console.log("渠道初始化完毕，开启静默加载"),RES.loadGroup(ResGroupName.Hall,2),RES.loadGroup(ResGroupName.Carddesk,1),this.EnterLoginStart(GameManager.reenterType==SystemReenterType.Normal)},t.prototype.OnNetworkSelect=function(){UIManager.removeEventListener(UIModuleName.NetworkPanel,UIModuleEvent.COMPLETE,this.OnNetworkSelect),this.EnterLoginStart(GameManager.reenterType==SystemReenterType.Normal)},t.prototype.EnterLoginStart=function(e){if(this._channelLoginList=ChannelLoginType.GetChannelLoginList(!1,VersionManager.isSafe,ChannelManager.operatePlatform,ChannelManager.channelType),this._channelLoginList.length>1){var t=PrefsManager.getValue(PrefsManager.Login_LoginType);e&&t?this.ChannelLoginStart(t,e):this.ShowEnterLoginPanel()}else this.ChannelLoginStart(this._channelLoginList[0],e)},t.prototype.ChannelLoginStart=function(e,t){ChannelManager.OnLogout.addListener(this.OnChannelLogout,this),ChannelManager.loginType=e,LoginManager.SetAddress(e),e==ChannelLoginType.Guest||e==ChannelLoginType.IntranetGuest?this.GameGuestLogin():(this.AddChannelEvents(),ChannelManager.Login(e,t))},t.prototype.ShowEnterLoginPanel=function(){UIManager.addEventListener(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,this.OnEnterLoginSelect,this),UIManager.showPanel(UIModuleName.LoginPanel,this._channelLoginList)},t.prototype.HideEnterLoginPanel=function(){UIManager.removeEventListener(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,this.OnEnterLoginSelect),UIManager.closePanel(UIModuleName.LoginPanel)},t.prototype.OnEnterLoginSelect=function(e){this.HideEnterLoginPanel(),this.ChannelLoginStart(e,!1)},t.prototype.GameGuestLogin=function(){this.AddGameLoginEvents(),LoginManager.GuestLogin(ChannelType.guest)},t.prototype.AddGameLoginEvents=function(){this.RemoveGameLoginEvents(),LoginManager.OnComplete.addListener(this.OnGameLoginComplete,this),LoginManager.OnError.addListener(this.OnGameLoginError,this)},t.prototype.RemoveGameLoginEvents=function(){LoginManager.OnComplete.removeListener(this.OnGameLoginComplete),LoginManager.OnError.removeListener(this.OnGameLoginError)},t.prototype.AddChannelEvents=function(){this.RemoveChannelEvents(),ChannelManager.OnAccountLoginSucceed.addListener(this.OnAccountLoginSucceed,this),ChannelManager.OnTokenLoginSucceed.addListener(this.OnTokenLoginSucceed,this),ChannelManager.OnTokenDebug.addListener(this.OnTokenDebug,this),ChannelManager.OnLoginFailed.addListener(this.OnChannelLoginFailure,this),ChannelManager.OnBackToApplication.addListener(this.OnBackToApplication,this),this._isLoginingAcount=!0},t.prototype.RemoveChannelEvents=function(){ChannelManager.OnAccountLoginSucceed.removeListener(this.OnAccountLoginSucceed),ChannelManager.OnTokenLoginSucceed.removeListener(this.OnTokenLoginSucceed),ChannelManager.OnTokenDebug.removeListener(this.OnTokenDebug),ChannelManager.OnLoginFailed.removeListener(this.OnChannelLoginFailure),ChannelManager.OnBackToApplication.removeListener(this.OnBackToApplication),this._isLoginingAcount=!1,this.ClearBackApplicationTimer()},t.prototype.OnTokenDebug=function(e){this.RemoveChannelEvents(),this.GameTokenDebug(e)},t.prototype.GameTokenDebug=function(e){this.AddGameLoginEvents(),LoginManager.TokenDebug(ChannelManager.GetLoginChannel(),e)},t.prototype.OnChannelLoginFailure=function(){this.RemoveChannelEvents(),PrefsManager.setValue(PrefsManager.Login_LoginType,ChannelLoginType.Normal),this.ShowEnterLoginPanel()},t.prototype.OnBackToApplication=function(){this.ClearBackApplicationTimer(),this._backToApplicationTimer=egret.setTimeout(this.CallBackToLoginLaterCoroutine,this,5e3)},t.prototype.ClearBackApplicationTimer=function(){clearTimeout(this._backToApplicationTimer)},t.prototype.CallBackToLoginLaterCoroutine=function(){clearTimeout(this._backToApplicationTimer),this._isLoginingAcount&&(UIManager.showFloatTips("登录失败"),this.OnChannelLoginFailure())},t.prototype.OnAccountLoginSucceed=function(e){this.RemoveChannelEvents(),e[2]?this.GameAccountRegister(e[0],e[1]):this.GameAccountLogin(e[0],e[1])},t.prototype.OnTokenLoginSucceed=function(e){this.RemoveChannelEvents(),this.GameTokenLogin(e)},t.prototype.OnChannelLogout=function(){this.RemoveChannelEvents(),ChannelManager.OnLogout.removeListener(this.OnChannelLogout),PrefsManager.setValue(PrefsManager.Login_LoginType,ChannelLoginType.Normal),this.EnterLoginStart(!1)},t.prototype.GameAccountRegister=function(e,t){this.AddGameLoginEvents(),LoginManager.AccountRegister(ChannelManager.channelType,e,t)},t.prototype.GameAccountLogin=function(e,t){this.AddGameLoginEvents(),LoginManager.AccountLogin(ChannelManager.channelType,e,t)},t.prototype.GameTokenLogin=function(e){this.AddGameLoginEvents(),LoginManager.TokenLogin(ChannelManager.GetLoginChannel(),e)},t.prototype.OnGameLoginComplete=function(){this._lastLoginSuccessDateTime=Date.now(),this.RemoveGameLoginEvents(),UIManager.closePanel(UIModuleName.LoginPanel),UIManager.closePanel(UIModuleName.RegisterPanel),PrefsManager.setValue(PrefsManager.Login_LoginType,ChannelManager.loginType),this.ShowLoginBar()},t.prototype.OnGameLoginError=function(){this.RemoveGameLoginEvents(),this.ShowEnterLoginPanel()},t.prototype.ShowLoginBar=function(){this.AddLoginBarEvents(),UIManager.showPanel(UIModuleName.LoginBar,LoginManager.loginInfo)},t.prototype.AddLoginBarEvents=function(){this.RemoveLoginBarEvents(),GameManager.stage.addEventListener(egret.Event.ACTIVATE,this.OnLoginGamePause,this),UIManager.addEventListener(UIModuleName.LoginBar,UIModuleEvent.COMPLETE,this.OnLoginBarComplete,this),UIManager.addEventListener(UIModuleName.LoginBar,UIModuleEvent.CHANGE,this.OnLoginBarChanged,this)
},t.prototype.RemoveLoginBarEvents=function(){GameManager.stage.removeEventListener(egret.Event.ACTIVATE,this.OnLoginGamePause,this),UIManager.removeEventListener(UIModuleName.LoginBar,UIModuleEvent.COMPLETE,this.OnLoginBarComplete),UIManager.removeEventListener(UIModuleName.LoginBar,UIModuleEvent.CHANGE,this.OnLoginBarChanged)},t.prototype.OnLoginBarComplete=function(e){this.RemoveLoginBarEvents(),GameManager.reenterType=SystemReenterType.Normal;var t=Date.now()-this._versionDateTime;t>=3e5?AlertManager.showSingleAlert("登录验证已失效，请重新登录游戏！",this.OnLoginBarBack.bind(this),null,null,null,null,"重新登录"):this.InitServer(e)},t.prototype.OnLoginBarBack=function(e){UIManager.closePanel(UIModuleName.LoginBar),this.RemoveLoginBarEvents(),this.InitNetworkVersion()},t.prototype.OnLoginBarChanged=function(){UIManager.closePanel(UIModuleName.LoginBar),this.RemoveLoginBarEvents(),ChannelManager.Logout()},t.prototype.OnLoginGamePause=function(e){(0==this._lastLoginSuccessDateTime||Date.now()-this._lastLoginSuccessDateTime>3e4)&&this.OnLoginBarBack(null)},t.prototype.InitServer=function(e){this.RemoveInitEvents(),GameManager.OnInitComplete.addListener(this.OnInitComplete,this),GameManager.OnInitError.addListener(this.OnInitError,this),GameManager.InitServer(LoginManager.loginInfo,e)},t.prototype.RemoveInitEvents=function(){GameManager.OnInitComplete.removeListener(this.OnInitComplete),GameManager.OnInitError.removeListener(this.OnInitError)},t.prototype.OnInitComplete=function(){this.RemoveInitEvents(),this.EnterGame()},t.prototype.OnInitError=function(){UIManager.closePanel(UIModuleName.LoginBar),this.RemoveInitEvents(),this.InitNetworkVersion()},t.prototype.EnterGame=function(){ChannelManager.SetExtData(),SceneManager.onEnable(),ChatManager.initialzie(),RoomManager.roomInfo?SceneManager.goToGame(!0):SceneManager.goToHall()},t}(BaseScene);LoginScene.SkipVersion=!0,__reflect(LoginScene.prototype,"LoginScene");var SceneManager=function(){function e(){}return Object.defineProperty(e,"gameScene",{get:function(){return e._gameScene},enumerable:!0,configurable:!0}),e.reLogin=function(){e._gameScene&&e._gameScene.gameProcesser.clear()},e.goToLogin=function(){e._currentSceneType=SceneType.Login,e.switcScene()},e.goToHall=function(){e._currentSceneType=SceneType.Hall,e.switcScene()},e.goToGame=function(t){e._currentSceneType=SceneType.Game,e.switcScene(t)},e.onEnable=function(){RoomManager.otherPlayerJoinEA.addListener(e.onPlayerJoin)},e.onDisable=function(){RoomManager.otherPlayerJoinEA.removeListener(e.onPlayerJoin)},e.onPlayerJoin=function(){e._currentSceneType==SceneType.Hall&&AlertManager.showDoubleAlert("你的小伙伴已进入房间，是否立即返回房间？",e.goBackRoom)},e.goBackRoom=function(){e.goToGame(!1)},e.switcScene=function(t){switch(e._currentScene&&e._currentScene.clear(),e._currentSceneType){case SceneType.Login:e._loginScene||(e._loginScene=new LoginScene),UIManager.showPanel(UIModuleName.LoginSceneBgPanel),e._loginScene.initialize(),e._currentScene=e._loginScene;break;case SceneType.Hall:e._hallScene||(e._hallScene=new HallScene),e._hallScene.initialize(ResGroupName.Hall),e._currentScene=e._hallScene,UIManager.closePanel(UIModuleName.LoginSceneBgPanel);break;case SceneType.Game:e._gameScene||(e._gameScene=new GameScene),e._gameScene.initialize(ResGroupName.Carddesk,t),e._currentScene=e._gameScene,UIManager.closePanel(UIModuleName.LoginSceneBgPanel)}SoundManager.playBgMusic(e._currentSceneType)},e.updateProgress=function(t,n){if(UIManager.isShowPanelObj(e.switchPanel)||UIManager.showPanel(UIModuleName.LoadingSwitchPanel),e.switchPanel||(e.switchPanel=UIManager.getPanel(UIModuleName.LoadingSwitchPanel)),e.switchPanel){var i=t.itemsLoaded/t.itemsTotal;e.switchPanel.updateProgress(i,n),i>=1&&UIManager.closePanel(UIModuleName.LoadingSwitchPanel)}},e}();__reflect(SceneManager.prototype,"SceneManager");var SoundManager=function(){function e(){}return Object.defineProperty(e,"bgEnabled",{get:function(){return void 0!=e._bgEnabled?e._bgEnabled:PrefsManager.getBoolean(PrefsManager.Sound_Bg_Enable)},set:function(t){e._bgEnabled=t,PrefsManager.setBoolean(PrefsManager.Sound_Bg_Enable,t),t?e.playBgMusic(e._currentSceneType):e.stopBgMusic()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"effectEnabled",{get:function(){return void 0!=e._effectEnabled?e._effectEnabled:PrefsManager.getBoolean(PrefsManager.Sound_Effect_Enable)},set:function(t){e._effectEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"bgVolume",{get:function(){return void 0!=e._bgVolume?e._bgVolume:PrefsManager.getNumber(PrefsManager.Sound_Bg_Volume,.7)},set:function(t){e._bgVolume=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"effectVolume",{get:function(){return void 0!=e._effectVolume?e._effectVolume:PrefsManager.getNumber(PrefsManager.Sound_Effect_Volume,1)},set:function(t){e._effectVolume=t},enumerable:!0,configurable:!0}),e.playBgMusic=function(t){if(e._currentSceneType=t,e.bgEnabled){e._lastPos=0,e._bgSoundList||(e._bgSoundList=new Dictionary),e._bgSoundChannelList||(e._bgSoundChannelList=new Dictionary),t==SceneType.Login&&(t=SceneType.Hall),e._lastBgSoundChannel&&e._lastBgSoundChannel.stop();var n=e._bgSoundChannelList.getValue(t),i=e._bgSoundList.getValue(t);if(i&&i.length>0)n=i.play(0,e._playTimes),n.volume=e.bgVolume,n.addEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this);else{i||(i=new egret.Sound,e._bgSoundList.add(t,i)),i.addEventListener(egret.Event.COMPLETE,e.onSoundLoadComplete,this);var a=PathName.Sound+MusicResEnum.getBgSoundRes(t)+ResSuffixName.Mp3Suffix;i.load(RES.getVersionController().getVirtualUrl(a))}e._lastBgSound=i,e._lastBgSoundChannel=n,e._bgSoundChannelList.add(t,n),e._bgSoundList.add(t,i)}},e.changeBgMusic=function(t){this._lastBgSoundChannel&&void 0!=t&&e.bgEnabled&&(this._lastBgSoundChannel.volume=t)},e.bgMusicOpen=function(t){e._currentSceneType=t,this._lastBgSoundChannel&&this._lastBgSound?(e._bgEnabled||(e._lastPos=this._lastBgSoundChannel.position),this._lastBgSoundChannel.stop(),this._lastBgSoundChannel.removeEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this),e._bgEnabled&&(this._lastBgSoundChannel=this._lastBgSound.play(e._lastPos,this._playTimes),this._lastBgSoundChannel.volume=e.bgVolume,this._lastBgSoundChannel.addEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this),e._bgSoundChannelList.add(e._currentSceneType,this._lastBgSoundChannel),e._bgSoundList.add(e._currentSceneType,this._lastBgSound))):e._bgEnabled&&e.playBgMusic(e._currentSceneType)},e.onSoundLoadComplete=function(t){var n=t.target;n.removeEventListener(egret.Event.COMPLETE,e.onSoundLoadComplete,this);var i=e._bgSoundList.getKey(n);if(i){var a=n.play(0,e._playTimes);a.volume=e.bgVolume,e._bgSoundChannelList.add(i,a),a.addEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this),e._lastBgSoundChannel=a,e._lastBgSound=n}},e.onSoundPlayComplete=function(t){var n=t.target,i=e._bgSoundChannelList.getKey(n);n.removeEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this),i&&(this._lastBgSound=e._bgSoundList.getValue(i),this._lastBgSoundChannel=this._lastBgSound.play(0,e._playTimes),this._lastBgSoundChannel.volume=e.bgVolume,this._lastBgSoundChannel.addEventListener(egret.Event.SOUND_COMPLETE,e.onSoundPlayComplete,this),e._bgSoundChannelList.add(e._currentSceneType,this._lastBgSoundChannel),e._bgSoundList.add(e._currentSceneType,this._lastBgSound),n=null)},e.stopBgMusic=function(){e._lastBgSoundChannel&&e._lastBgSoundChannel.stop()},e.playEffect=function(t,n,i){if(e.effectEnabled){e._effectSoundList||(e._effectSoundList=new Dictionary),t||(t=Sex.Male);var a=MusicDefined.GetInstance().getSexMusicDefinition(t,n,i);if(a){var o=void 0;o=void 0!=i?t.toString()+n+i.toString()+a:t.toString()+n+a;var r=e._effectSoundList.getValue(o);if(r&&r.length>0){var s=r.play(0,1);s.volume=e.effectVolume}else{r||(r=new egret.Sound,e._effectSoundList.add(o,r)),r.addEventListener(egret.Event.COMPLETE,e.onEffectSoundLoadComplete,this);var l=PathName.Sound+a+ResSuffixName.Mp3Suffix;r.load(RES.getVersionController().getVirtualUrl(l))}}}},e.onEffectSoundLoadComplete=function(t){var n=t.target;n.removeEventListener(egret.Event.COMPLETE,e.onEffectSoundLoadComplete,this);var i=n.play(0,1);i.volume=e.effectVolume},e.playButtonEffect=function(t){t instanceof eui.Button&&e.playEffect(Sex.Male,MusicAction.buttonClick)},e}();SoundManager._playTimes=1,SoundManager._lastPos=0,__reflect(SoundManager.prototype,"SoundManager");var AlertManager=function(){function e(){}return e.showSingleAlert=function(t,n,i,a,o,r,s,l,c){var h=PoolUtil.GetObject(AlertInfo);h.title=o,h.subTitle=r,h.message=t,h.OnConfirm=n,h.OnCancel=i,h.confirmParam=a,h.cancleParam=c,h.confirmLabel=s,h.cancelLabel=l,e.showAlert(h)},e.showDoubleAlert=function(t,n,i,a,o,r,s,l,c){var h=PoolUtil.GetObject(AlertInfo);h.title=o,h.subTitle=r,h.message=t,h.OnConfirm=n,h.OnCancel=i,h.confirmParam=a,h.cancleParam=c,h.confirmLabel=s,h.cancelLabel=l,h.isSingle=!1,e.showAlert(h)},e.showAlert=function(e){UIManager.showPanel(UIModuleName.AlertInfoPanel,e)},e.showAlertObj=function(e){UIManager.showPanel(UIModuleName.AlertInfoPanel,e)},e.showSingleAlertByString=function(e){UIManager.showPanel(UIModuleName.AlertInfoPanel,{isSingle:!0,message:e})},e.showDoubleAlertByString=function(e){UIManager.showPanel(UIModuleName.AlertInfoPanel,{message:e})},e}();__reflect(AlertManager.prototype,"AlertManager");var OutCard=function(e){function t(t,n,i){var a=e.call(this)||this;if(t)switch(a._outCardDef=t,a._isUnByHorse=i,a.posIndex=t.pos,a.x=t.x,a.y=t.y,t.scale&&(a.scaleX=a.scaleY=t.scale),a.init(n),t.posType){case PosType.BenJia:a.skinName=OutCardSkinName.BenJiaOutCard;break;case PosType.XiaJia:a.skinName=OutCardSkinName.XiaJiaOutCard;break;case PosType.DuiJia:a.skinName=OutCardSkinName.DuiJiaOutCard;break;case PosType.ShangJia:a.skinName=OutCardSkinName.ShangJiaOutCard}return a}return __extends(t,e),Object.defineProperty(t.prototype,"outCardDef",{get:function(){return this._outCardDef},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"card",{get:function(){return this.bindData},enumerable:!0,configurable:!0}),t.prototype.rendererStart=function(t){if(e.prototype.rendererStart.call(this,t),this.bindData&&this.face){var n=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);this.face.source=n.img+ResSuffixName.PNGSuffix,this.maskImg.visible=!this._isUnByHorse,this._matrix||(this._matrix=this.face.matrix),this.face.matrix=this._matrix,CardShowUtil.setTilt(this._outCardDef.tiltH,this._outCardDef.tiltV,this.face)}},t.prototype.init=function(e){this.bindData=e,this.face&&this.rendererStart(null)},t.prototype.setScale=function(e){e&&(this.scaleX=this.scaleY=e)},t}(BaseComponent);__reflect(OutCard.prototype,"OutCard");var LiangCard=function(e){function t(n){var i=e.call(this)||this;return n&&(i._cardDef=n,i.x=n.x,i.y=n.y,i.setScale(n.scale),i.skinName=t.paiSource[n.posType]),i}return __extends(t,e),Object.defineProperty(t.prototype,"card",{get:function(){return this.bindData},enumerable:!0,configurable:!0}),t.prototype.rendererStart=function(t){if(e.prototype.rendererStart.call(this,t),this.bindData&&this.face){var n=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);this.face.source=n.img+ResSuffixName.PNGSuffix,this._matrix||(this._matrix=this.face.matrix),this.face.matrix=this._matrix,CardShowUtil.setTilt(this._cardDef.tiltH,this._cardDef.tiltV,this.face)}},t.prototype.init=function(e){this.bindData=e,this.face&&this.rendererStart(null)},t.prototype.setScale=function(e){e&&(this.scaleX=this.scaleY=e)},t}(BaseComponent);LiangCard.paiSource=["",LiangPaiSkiName.BenJiaLiangCard,LiangPaiSkiName.XiaJiaLiangCard,LiangPaiSkiName.DuiJiaLiangCard,LiangPaiSkiName.ShangJiaLiangCard],__reflect(LiangCard.prototype,"LiangCard");var GroupCard=function(e){function t(t,n,i,a,o){var r=e.call(this)||this;return t&&(r._cardDef=t,r._offsetX=i,r._offsetY=a,r._groupCount=o,r.x=r._cardDef.x+r._offsetX,r.y=r._cardDef.y+r._offsetY,r._cardDef.scale&&(r.scaleX=r.scaleY=r._cardDef.scale),r.init(n),r.skinName=ResPrefixName.CardGroup+t.skinName+".exml"),r}return __extends(t,e),Object.defineProperty(t.prototype,"card",{get:function(){return this.bindData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cardDef",{get:function(){return this._cardDef},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupCount",{get:function(){return this._groupCount},enumerable:!0,configurable:!0}),t.prototype.rendererStart=function(t){if(e.prototype.rendererStart.call(this,t),this.bindData&&this.face){var n=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);this.face.source=n.img+ResSuffixName.PNGSuffix,CardShowUtil.setTilt(this._cardDef.tiltH,this._cardDef.tiltV,this.face)}},t.prototype.init=function(e){this.bindData=e,this.face&&this.rendererStart(null)},t.prototype.setScale=function(e){e&&(this.scaleX=this.scaleY=e)},t}(BaseComponent);__reflect(GroupCard.prototype,"GroupCard");var aaa=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.CommonIcon,t}return __extends(t,e),t}(BaseComponent);__reflect(aaa.prototype,"aaa");var ActionEffectComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.ActionEffectComponent,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.effectTweenGroup.stop()},t.prototype.rendererStart=function(t){e.prototype.rendererStart.call(this,t),this.imgBg.alpha=0,this.imgAction.alpha=0,this.imgAction.source=ImageSource.getActionEffectImgSource(this.bindData.actionType)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.imgAction.addEventListener(egret.Event.COMPLETE,this.onComplete,this),this.effectTweenGroup.addEventListener(egret.Event.COMPLETE,this.onTweenComplete,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.effectTweenGroup.removeEventListener(egret.Event.COMPLETE,this.onTweenComplete,this),this.imgAction.removeEventListener(egret.Event.COMPLETE,this.onComplete,this)},t.prototype.onComplete=function(e){this.imgAction.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),this.effectTweenGroup.play()},t.prototype.onTweenComplete=function(e){this.parent&&this.parent.removeChild(this),this.destroy()},t}(BaseComponent);__reflect(ActionEffectComponent.prototype,"ActionEffectComponent");var BenJiaShouCard=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._face=new eui.Image,i.addChild(i._face),i._arrow=new eui.Image,i._arrow.x=35,i._arrow.y=-25,i.addChild(i._arrow),i}return __extends(t,e),t.prototype.init=function(){this.isTingCard=!1,e.prototype.init.call(this)},t.prototype.refreshFace=function(t){if(e.prototype.refreshFace.call(this,t),this._card=t,this._card){var n=PaiDefined.GetInstance().getDefinition(this.cardNum,PaiDefined.GetInstance().paiList);n&&(this._face.source=n.img+ResSuffixName.PNGSuffix,this._face.width=72,this._face.height=96,this._face.x=10,this._face.y=10)}},t.prototype.setScale=function(t){t&&(e.prototype.setScale.call(this,t),this._face.scaleX=this._face.scaleY=t)},t.prototype.setArrow=function(e){this._arrow.source||(this._arrow.source=ImageSource.ListenerArrow),this._arrow.visible=e,this.isTingCard=e},t.prototype.clear=function(){this.setArrow(!1)},t}(OtherShouCard);__reflect(BenJiaShouCard.prototype,"BenJiaShouCard");var CommonIcon=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.CommonIcon,t}return __extends(t,e),t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t.prototype.Init=function(t){e.prototype.init.call(this,t)},t.prototype.rendererStart=function(e){UIUtil.ShowHead(this.icon,this.bindData.head)},t.prototype.SetMove=function(e,t){this.x=e,this.y=t},t.prototype.GetIconWidth=function(){return null!=this.icon?this.icon.width:0},t.prototype.GetIconHeight=function(){return null!=this.icon.height?this.icon.height:0},t.prototype.SetGray=function(e){e?FilterUtil.setGray(this.icon):FilterUtil.setEraseGray(this.icon)},t}(BaseComponent);__reflect(CommonIcon.prototype,"CommonIcon");var GameButton=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onEnable,t),t.btnProxy=t,t}return __extends(t,e),t.prototype.createChildren=function(){this._isTweenOver=!0,this._initSx=this.scaleX,this._initSy=this.scaleY},t.prototype.onTouchBegin=function(t){e.prototype.onTouchBegin.call(this,t),this._isTweenOver=!1,egret.Tween.removeTweens(this.btnProxy.btnImg);var n=egret.Tween.get(this.btnProxy.btnImg,{onChange:this.update.bind(this)});n.to({scaleX:1.05,scaleY:1.05},255).call(this.tweenComplete.bind(this)),UIUtil.setGlowerFilter(this.btnProxy.btnImg)},t.prototype.tweenComplete=function(){this._isTweenOver=!0},t.prototype.onTouchCancle=function(t){e.prototype.onTouchCancle.call(this,t),this.buttonReleased()},t.prototype.buttonReleased=function(){egret.Tween.removeTweens(this.btnProxy.btnImg);var e=egret.Tween.get(this.btnProxy.btnImg,{onChange:this.update.bind(this)});e.to({scaleX:1,scaleY:1},255),UIUtil.clearFilters(this.btnProxy.btnImg)},t.prototype.update=function(){if(void 0!=this._initW&&void 0!=this._initH){var e=this.btnProxy.btnImg.scaleX*this._initW,t=this.btnProxy.btnImg.scaleY*this._initH,n=-(e-this._initW)/2,i=-(t-this._initH)/2;this.btnProxy.btnImg.x=n,this.btnProxy.btnImg.y=i}},t.prototype.rendererStart=function(e){this._initW=this.btnProxy.btnImg.width,this._initH=this.btnProxy.btnImg.height,this.removeEventListener(egret.Event.RENDER,this.rendererStart,this)},t.prototype.onEnable=function(e){this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.buttonReleased,this),this.addEventListener(egret.Event.RENDER,this.rendererStart,this),this.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this)},t.prototype.onDisable=function(e){this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.buttonReleased,this),this.removeEventListener(egret.TouchEvent.RENDER,this.rendererStart,this),this.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this),this.btnProxy.btnImg.x=this.btnProxy.btnImg.y=0},t}(eui.Button);__reflect(GameButton.prototype,"GameButton");var GameButtonGroup=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onEnable,t),t}return __extends(t,e),t.prototype.createChildren=function(){this._isTweenOver=!0,this._initSx=this.scaleX,this._initSy=this.scaleY,this.numChildren>0&&(this.btnGroup=this.getChildAt(0))},t.prototype.onTouchBegin=function(e){this._isTweenOver=!1,egret.Tween.removeTweens(this.btnGroup);var t=egret.Tween.get(this.btnGroup,{onChange:this.update.bind(this)});t.to({scaleX:1.05,scaleY:1.05},255).call(this.tweenComplete.bind(this));for(var n,i=0;i<this.btnGroup.numChildren;i++)n=this.btnGroup.getChildAt(i),n instanceof eui.Button||UIUtil.setGlowerFilter(n)},t.prototype.tweenComplete=function(){this._isTweenOver=!0},t.prototype.onTouchCancle=function(e){this.buttonReleased(e)},t.prototype.buttonReleased=function(e){egret.Tween.removeTweens(this.btnGroup);var t=egret.Tween.get(this.btnGroup,{onChange:this.update.bind(this)});t.to({scaleX:1,scaleY:1},255);for(var n=0;n<this.btnGroup.numChildren;n++)UIUtil.clearFilters(this.btnGroup.getChildAt(n))},t.prototype.update=function(){if(void 0!=this._initW&&void 0!=this._initH){var e=this.btnGroup.scaleX*this._initW,t=this.btnGroup.scaleY*this._initH,n=-(e-this._initW)/2,i=-(t-this._initH)/2;this.btnGroup.x=n,this.btnGroup.y=i}},t.prototype.rendererStart=function(e){this._initW=this.btnGroup.width,this._initH=this.btnGroup.height,this.removeEventListener(egret.Event.RENDER,this.rendererStart,this)},t.prototype.onEnable=function(e){this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.buttonReleased,this),this.addEventListener(egret.Event.RENDER,this.rendererStart,this),this.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.buttonReleased,this)},t.prototype.onDisable=function(e){this.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.buttonReleased,this),this.removeEventListener(egret.Event.RENDER,this.rendererStart,this),this.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onDisable,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.buttonReleased,this),this.btnGroup&&(this.btnGroup.x=this.btnGroup.y=0)},t}(eui.Group);__reflect(GameButtonGroup.prototype,"GameButtonGroup");var NumComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.NumComponent,t}return __extends(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.bindData&&(this.label1.text=this.bindData.toString())},t.prototype.refresh=function(e){this.label1&&(void 0!=e?this.label1.text=e.toString():this.label1.text=StringConstant.empty)},t}(BaseComponent);__reflect(NumComponent.prototype,"NumComponent");var OnceResultCardComponet=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.OnceResultCardComponet,t}return __extends(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t),this.refreshFace()},t.prototype.rendererStart=function(t){e.prototype.rendererStart.call(this,t),this.refreshFace()},t.prototype.refreshFace=function(){if(this.bindData&&this.face){var e=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);this.face.source=e.img+ResSuffixName.PNGSuffix}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.face.source=StringConstant.empty},t}(BaseComponent);__reflect(OnceResultCardComponet.prototype,"OnceResultCardComponet");var RoomUserHeadInfoComponent=function(e){function t(){var t=e.call(this)||this;return t.touchChildren=!1,t.skinName=UIComponentSkinName.RoomUserHeadInfoComponent,t}return __extends(t,e),t.prototype.clear=function(){this.bindData&&(this.headImg.source=StringConstant.empty,this.nameLabel.text=StringConstant.empty,UIUtil.ShowScoreImg(0,this.scoreLabel,.6,.6,!1),this.sexImg.source=StringConstant.empty,this.zhuangImg.visible=!1,this.tingpaiImg.visible=!1,this.showReadyImg(!1),this.grayBg.height=58)},t.prototype.createChildren=function(){e.prototype.createChildren.call(this)},t.prototype.init=function(e){this.clear(),this.bindData=e,this.rendererStart(null)},t.prototype.rendererStart=function(t){e.prototype.rendererStart.call(this,t),t&&this.showPlayRecordState(!1),this.bindData?(UIUtil.ShowHead(this.headImg,this.bindData.head),this.bindData.name?this.nameLabel.text=this.bindData.name:this.nameLabel.text=this.bindData.roleId.toString(),this.bindData.score<0?UIUtil.ShowScoreImg(this.bindData.score,this.scoreLabel,.6,.6,!0):UIUtil.ShowScoreImg(this.bindData.score,this.scoreLabel,.6,.6,!1),this.fangZhu.visible=RoomManager.isHost(this.bindData.roleId),this.sexImg.source=UIUtil.getSexImgSource(this.bindData.sex),this.tingpaiImg.visible=this.bindData.isTing,this.tingpaiImg.visible?this.grayBg.height=90:this.grayBg.height=58,this.refreshReadyState(),this.refreshZhuang(),this.refreshHostedState(),this.refreshOfflineState()):(this.grayBg.height=58,this.showReadyImg(!1),this.showHostedImg(!1),this.showOfflineImg(!1),this.zhuangImg.visible=!1,this.headImg.texture=null,this.sexImg.texture=null,this.nameLabel.text=StringConstant.empty,UIUtil.ShowScoreImg(0,this.scoreLabel,.6,.6,!1),this.tingpaiImg.visible=!1,this.fangZhu.visible=!1)},t.prototype.refreshReadyState=function(){this._readyImg&&(this.showReadyImg(!1),GoCardProcessManager.state!=GameSceneState.Processing&&this.showReadyImg(this.bindData.isReady))},t.prototype.refreshHostedState=function(){this._hostedImg&&(this.showHostedImg(!1),GoCardProcessManager.state==GameSceneState.Processing&&this.showHostedImg(this.bindData.hosted))},t.prototype.refreshOfflineState=function(){this.offlineImg&&(this.offlineImg.visible=this.bindData.offline)},t.prototype.showReadyImg=function(e){this._readyImg.visible=e},t.prototype.showHostedImg=function(e){this._hostedImg.visible=e},t.prototype.showOfflineImg=function(e){this.offlineImg&&(this.offlineImg.visible=e)},t.prototype.showPlayRecordState=function(e){for(var t=0;2>=t;t++)this["playRecordImage"+t.toString()].visible=e,e?this.play.play():this.play.pause()},t.prototype.refreshZhuang=function(){this.zhuangImg.visible=this.bindData.isMaster},t.prototype.updateTing=function(){this.bindData&&this.tingpaiImg&&(this.tingpaiImg.visible=this.bindData.isTing)},t.prototype.tingMove=function(e,t){this.move(this.tingpaiImg,e,t)},t.prototype.setReadyImg=function(e){this._readyImg=e},t.prototype.setHostedImg=function(e){this._hostedImg=e},t.prototype.move=function(e,t,n){e&&(e.x=t,e.y=n)},t.prototype.updateScore=function(e){this.bindData&&this.scoreLabel&&(0>e?UIUtil.ShowScoreImg(e,this.scoreLabel,.6,.6,!0):UIUtil.ShowScoreImg(e,this.scoreLabel,.6,.6,!1))},t}(BaseComponent);__reflect(RoomUserHeadInfoComponent.prototype,"RoomUserHeadInfoComponent");var ScoreEffectComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.ScoreEffectComponent,t}return __extends(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.rendererStart=function(t){void 0!=this.bindData.offsetScore&&UIUtil.ShowScoreImg(this.bindData.offsetScore,this.group,1,1,!0,!0),this.effectGroup.play(),e.prototype.rendererStart.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.effectGroup.addEventListener(egret.Event.COMPLETE,this.onCompletehandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.effectGroup.removeEventListener(egret.Event.COMPLETE,this.onCompletehandler,this)},t.prototype.onCompletehandler=function(e){this.effectGroup.removeEventListener(egret.Event.COMPLETE,this.onCompletehandler,this),this.parent&&(this.parent.removeChild(this),this.destroy())},t}(BaseComponent);__reflect(ScoreEffectComponent.prototype,"ScoreEffectComponent");var TabComponent=function(e){function t(){var t=e.call(this)||this;return t.isTween=!0,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.viewStack=new eui.ViewStack,this.tabBar=new eui.TabBar,this.tabBar.horizontalCenter=0,this.viewStack.horizontalCenter=0,this.disableTabIndex=-1,this.disableTabDes="",this.enterTabindex=-1},t.prototype.init=function(e,t){this.bindData=e,t&&(t.tabSkinName&&(this.tabSkinName=t.tabSkinName),void 0!=t.enterTabindex&&(this.enterTabindex=t.enterTabindex))},t.prototype.rendererStart=function(t){if(e.prototype.rendererStart.call(this,t),!this.bindData)return void console.log("传入数据为空");if("string"==typeof this.bindData[0]&&this.bindData[0].constructor==String){var n=new eui.ArrayCollection(this.bindData);this.tabBar.dataProvider=n}else{if(!(this.bindData[0]instanceof eui.Group))return void console.log("传入类型错误");for(var i=0;i<this.bindData.length;i++)this.viewStack.addChild(this.bindData[i]);this.tabBar.dataProvider=this.viewStack,-1!=this.enterTabindex&&(this.viewStack.selectedIndex=this.enterTabindex),this.addChild(this.viewStack)}this.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBarItemTap,this),this.tabSkinName?this.tabBar.itemRendererSkinName=this.tabSkinName:this.tabBar.itemRendererSkinName=UIComponentSkinName.ButtonSkin2,-1!=this.enterTabindex&&(this.tabBar.selectedIndex=this.enterTabindex),this.addChild(this.tabBar)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.isTween&&this.setEnterAnime(),this.tabBar.addEventListener(egret.Event.CHANGING,this.disableChanging,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.tabBar.removeEventListener(egret.Event.CHANGING,this.disableChanging,this),this.tabBar.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBarItemTap,this)},t.prototype.onBarItemTap=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick)},t.prototype.setDisableTabIndex=function(e){this.disableTabIndex=e},t.prototype.disableChanging=function(e){this.tabBar.selectedIndex==this.disableTabIndex&&(e.preventDefault(),AlertManager.showSingleAlertByString(this.disableTabDes))},t.prototype.setEnterTabGroup=function(e){if(!this.bindData)return void console.log("传入数据为空");for(var t=0;t<this.bindData.length;t++)this.bindData[t]==e&&(this.enterTabindex=t)},t.prototype.setEnterAnime=function(){egret.Tween.removeTweens(this.tabBar),egret.Tween.removeTweens(this.viewStack),this.tabBar.scaleX=0,this.tabBar.scaleY=0,egret.Tween.get(this.tabBar).wait(100).to({scaleX:1,scaleY:1},200),this.viewStack.y=1280,egret.Tween.get(this.viewStack).wait(200).to({y:this.tabBar.y-100},250)},t}(BaseComponent);__reflect(TabComponent.prototype,"TabComponent");var TouZiComponent=function(e){function t(){var t=e.call(this)||this;return t.onTouZiComplete=new ActionDispatcher,t.skinName=UIComponentSkinName.TouZiComponent,t}return __extends(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t),this.stop(),this._startPlayTime=egret.getTimer(),this.touziImg1.visible=!1,this.play()},t.prototype.rendererStart=function(t){e.prototype.rendererStart.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.Event.ENTER_FRAME,this.onFrameHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrameHandler,this),this._startPlayTime=0},t.prototype.onFrameHandler=function(e){if(0!=this._startPlayTime){var t=egret.getTimer()-this._startPlayTime;t>2e3&&(this.stop(),this.touziImg1.visible=!0,this.touziImg1.source=PathName.Touzi+this.bindData+ResSuffixName.PNGSuffix,this.onTouZiComplete.dispatch(),this.onDisable(null))}},t.prototype.play=function(){this.touziAnimate&&this.touziAnimate.play()},t.prototype.stop=function(){this.touziAnimate&&this.touziAnimate.pause()},t}(BaseComponent);__reflect(TouZiComponent.prototype,"TouZiComponent");var UserInfoComponent=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIComponentSkinName.UserInfoComponent,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.rendererStart=function(e){this.bindData.name?this.nameLabel.text=this.bindData.name:this.nameLabel.text=this.bindData.roleId.toString(),this.commonIcon.init(this.bindData),this.idLabel.text=this.bindData.roleId.toString(),this.sexImg.source=UIUtil.getSexImgSource(this.bindData.sex)},t}(BaseComponent);__reflect(UserInfoComponent.prototype,"UserInfoComponent");var UIModuleEvent=function(e){function t(t,n){var i=e.call(this,t)||this;return i.panelName=StringConstant.empty,i.panelName=n,i}return __extends(t,e),t}(egret.Event);UIModuleEvent.OnTimeout="OnTimeout",__reflect(UIModuleEvent.prototype,"UIModuleEvent");var ModelPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName="",t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t}(BasePanel);__reflect(ModelPanel.prototype,"ModelPanel");var AlertInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.maskAlpha=0,t.layer=UILayerType.Tips,t.skinName=UISkinName.AlertInfoPanel,t
}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t);var n=new eui.HorizontalLayout;n.horizontalAlign=egret.HorizontalAlign.CENTER,n.gap=66,this.group.layout=n,this._htmlTxtParser=new egret.HtmlTextParser},t.prototype.init=function(t){e.prototype.init.call(this,t);var n=new ActionInfo;n.actionType=1,n.posType=1,this.onRender(null)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.infoTxt.text=StringConstant.empty,this.subTxt.text=StringConstant.empty,this.infoTxt.textAlign=egret.HorizontalAlign.CENTER,this.panelData&&(this.panelData.title,this.panelData.subTitle&&(this.subTxt.text=this.panelData.subTitle),this.panelData.message&&(this.infoTxt.textFlow=this._htmlTxtParser.parser(this.panelData.message)),this.panelData.confirmLabel&&(this.confirmBtn.label=this.panelData.confirmLabel),this.panelData.cancelLabel&&(this.cancelBtn.label=this.panelData.cancelLabel),this.panelData.alignment&&(this.infoTxt.textAlign=this.panelData.alignment),this.panelData.isSingle?(this.cancelBtn.visible=!1,this.addChild(this.cancelBtn)):(this.cancelBtn.visible=!0,this.group.addChildAt(this.cancelBtn,0)))},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.confirmBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onConfirmClick,this),this.cancelBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelClick,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.confirmBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onConfirmClick,this),this.cancelBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCancelClick,this),this.panelData instanceof AlertInfo&&PoolUtil.PutObject(this.panelData)},t.prototype.onConfirmClick=function(t){this.panelData&&this.panelData.OnConfirm&&this.panelData.OnConfirm(this.panelData.confirmParam),e.prototype.onCloseBtnClickHandler.call(this,t),t||SoundManager.playEffect(Sex.Male,MusicAction.buttonClick)},t.prototype.onCancelClick=function(t){this.panelData&&this.panelData.OnCancel&&this.panelData.OnCancel(this.panelData.cancleParam),e.prototype.onCloseBtnClickHandler.call(this,t),t||SoundManager.playEffect(Sex.Male,MusicAction.buttonClick)},t}(BasePanel);__reflect(AlertInfoPanel.prototype,"AlertInfoPanel");var AlertInfo=function(){function e(){this.title=StringConstant.empty,this.subTitle=StringConstant.empty,this.message=StringConstant.empty,this.confirmLabel=StringConstant.empty,this.cancelLabel=StringConstant.empty,this.OnConfirm=null,this.OnCancel=null,this.confirmParam=null,this.cancleParam=null,this.extraData=null,this.alignment=egret.HorizontalAlign.CENTER,this.isSingle=!0}return e.prototype.reset=function(){this.title=StringConstant.empty,this.subTitle=StringConstant.empty,this.message=StringConstant.empty,this.confirmLabel=StringConstant.empty,this.cancelLabel=StringConstant.empty,this.OnConfirm=null,this.OnCancel=null,this.confirmParam=null,this.cancleParam=null,this.extraData=null,this.alignment=egret.HorizontalAlign.CENTER,this.isSingle=!0},e}();__reflect(AlertInfo.prototype,"AlertInfo",["IPoolObject","Object"]);var AudioRecordingPanel=function(e){function t(){var t=e.call(this)||this;return t.setGrayMask(!1),t.skinName=UISkinName.AudioRecordingPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.ShowValue=function(){this.play.play()},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.ShowValue()},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.play.pause(),RecordAudioManager.ClearData()},t}(BasePanel);__reflect(AudioRecordingPanel.prototype,"AudioRecordingPanel");var ChangeUserNamePanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.ChangeUserNamePanel,t}return __extends(t,e),t.prototype.onRender=function(e){this.nameText.text=UserManager.userInfo.name},t.prototype.onEnable=function(e){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.onDisable=function(e){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.randomBtn:this.nameText.text=UserUtil.randomNickName(UserManager.userInfo.sex);case this.changeNameBtn:UserUtil.isLegalNickName(this.nameText.text)}},t}(BasePanel);__reflect(ChangeUserNamePanel.prototype,"ChangeUserNamePanel");var ChatPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.ChatPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),UIUtil.listRenderer(this.list,this.scroller,ChatItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.faceList,this.faceScroller,FaceItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.fastList,this.fastScroller,FastChatItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),this.scroller.scrollPolicyH=this.faceScroller.scrollPolicyH=this.fastScroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.disGroup.visible=this.faceGroup.visible=this.fastGroup.visible=!1,this.faceBtn.selected=!0,this.fastChatFlag=!0},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.setChatInfo(),this.refreshUI()},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.sendBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.faceBtn.addEventListener(egret.Event.CHANGE,this.changeActive,this),this.writeLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.getFocus,this),this.scroller.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closePanel,this),this.faceList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onFaceClick,this),this.fastList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onFastChatClick,this),ChatManager.pushChatMessageEa.addListener(this.setChatInfo,this),this.writeLabel.dispatchEvent(new egret.TouchEvent(egret.TouchEvent.TOUCH_TAP)),ChatManager.onSendChatMsgEvent.addListener(this.showChatMsg,this),this.fastEnterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.setFastChatInfo,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.sendBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),this.faceBtn.removeEventListener(egret.Event.CHANGE,this.changeActive,this),this.writeLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.getFocus,this),this.scroller.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closePanel,this),this.faceList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onFaceClick,this),this.fastList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onFastChatClick,this),ChatManager.pushChatMessageEa.removeListener(this.setChatInfo),ChatManager.onSendChatMsgEvent.removeListener(this.showChatMsg),this.fastEnterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.setFastChatInfo,this)},t.prototype.onFastChatClick=function(e){this.fastList.selectedItem&&ChatManager.reqSendChatMsg(this.fastList.selectedItem.des,ChatMessageType.Maquee)},t.prototype.setFastChatInfo=function(){this.fastChatFlag&&(this.fastList.dataProvider=new eui.ArrayCollection(FastChatDefined.GetInstance().fastChatList),this.fastChatFlag=!1)},t.prototype.showChatMsg=function(e){e.type==ChatMessageType.Maquee?(ChatManager.messageList.push(e),this.refreshUI()):e.type==ChatMessageType.InRoom&&UIManager.showFloatTips(e.message)},t.prototype.sendMsg=function(e){this.writeLabel.text.trim()&&(ChatManager.reqSendChatMsg(this.writeLabel.text,ChatMessageType.Maquee),UIManager.showFloatTips(this.writeLabel.text),this.writeLabel.text="")},t.prototype.onFaceClick=function(e){this.faceList.selectedItem&&(ChatManager.reqSendChatMsg(this.faceList.selectedItem.id,ChatMessageType.InRoom),UIManager.showFloatTips("发送表情"+this.faceList.selectedItem.id),console.log(this.faceList.selectedItem))},t.prototype.getFocus=function(){this.writeLabel.setFocus()},t.prototype.changeActive=function(){if(this.fastGroup.visible=!1,this.faceBtn.selected)this.faceGroup.visible=!1,this.writeLabel.setFocus(),UIManager.showFloatTips("系统键盘调出");else{if(ChatManager.faceList||(ChatManager.faceList=new Array),ChatManager.faceList.length<=0){for(var e=1;50>e;e++)ChatManager.faceList[e-1]=new Face,ChatManager.faceList[e-1].id=e,ChatManager.faceList[e-1].source="fangka_png";this.faceList.dataProvider=new eui.ArrayCollection(ChatManager.faceList)}this.faceGroup.visible=!0,this.disGroup.visible=!1}},t.prototype.onClickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.fastEnterBtn:this.fastGroup.visible=!0,this.faceGroup.visible=!1;break;case this.keyBoradGroup:this.closePanel()}},t.prototype.setChatInfo=function(){ChatManager.messageList||(ChatManager.messageList=new Array);var e=new ChatInfo;e.name="1111",e.message="1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111",e.type=1;var t=new ChatInfo;t.name="2222",t.message="222222222222222222222222222222222222222222",t.type=1,ChatManager.messageList.push(e),ChatManager.messageList.push(t),ChatManager.messageList.length>0&&this.refreshUI()},t.prototype.refreshUI=function(){this.list.dataProvider=new eui.ArrayCollection(ChatManager.messageList)},t.prototype.closePanel=function(){UIManager.closePanel(UIModuleName.ChatPanel)},t}(BasePanel);__reflect(ChatPanel.prototype,"ChatPanel");var CreateRolePanel=function(e){function t(){var t=e.call(this)||this;return t.radioGroup=new eui.RadioButtonGroup,t.layer=UILayerType.Tips,t.skinName=UISkinName.CreateRolePanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.nickNameLable.type=egret.TextFieldType.INPUT,this.manRadioBtn.label="男",this.manRadioBtn.value=Sex.Male,this.manRadioBtn.selected=!0,this.sex=this.manRadioBtn.value,this.manRadioBtn.group=this.radioGroup,this.womanRadioBtn.label="女",this.womanRadioBtn.value=Sex.Female,this.womanRadioBtn.group=this.radioGroup},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.nickNameLable.text=UserUtil.randomNickName(this.sex)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.radioGroup.addEventListener(eui.UIEvent.CHANGE,this.sexRadioChangeHandler,this),this.manRadioBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sexRadioClickHandler,this),this.womanRadioBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sexRadioClickHandler,this),this.randomBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.randomNameHandler,this),this.enterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.enterHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.radioGroup.removeEventListener(eui.UIEvent.CHANGE,this.sexRadioChangeHandler,this),this.manRadioBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sexRadioClickHandler,this),this.womanRadioBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.sexRadioClickHandler,this),this.randomBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.randomNameHandler,this),this.enterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.enterHandler,this)},t.prototype.sexRadioChangeHandler=function(e){var t=e.target;this.sex=t.selectedValue,this.nickNameLable.text=UserUtil.randomNickName(this.sex)},t.prototype.sexRadioClickHandler=function(e){SoundManager.playButtonEffect(e.target)},t.prototype.randomNameHandler=function(e){SoundManager.playButtonEffect(e.target),this.nickNameLable.text=UserUtil.randomNickName(this.sex)},t.prototype.enterHandler=function(e){SoundManager.playButtonEffect(e.target),UserUtil.isLegalNickName(this.nickNameLable.text)&&LoginManager.reqCreateRole(this.sex,this.nickNameLable.text)},t}(BasePanel);__reflect(CreateRolePanel.prototype,"CreateRolePanel");var CreateRoomPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.CreateRoomPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t);var n=new eui.ArrayCollection(ProjectDefined.GetInstance().round);this.roundList.dataProvider=n,n=new eui.ArrayCollection(ProjectDefined.GetInstance().playWay),this.playWayList.dataProvider=n,n=new eui.ArrayCollection(ProjectDefined.GetInstance().antes),this.antesList.dataProvider=n,this.roundList.itemRenderer=CreateRoomPanelItemRenderer,this.playWayList.itemRenderer=CreateRoomPanelItemRenderer,this.antesList.itemRenderer=CreateRoomPanelItemRenderer,this.playWayScroller.scrollPolicyH=eui.ScrollPolicy.AUTO,this.roundScroller.scrollPolicyH=eui.ScrollPolicy.AUTO,this.antesScroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.antesScroller.scrollPolicyV=eui.ScrollPolicy.AUTO},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.createRoomBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateRoomHandler,this),RoomManager.createRoomEA.addListener(this.createRoomResult,this),this.roundList.addEventListener(egret.Event.CHANGE,this.onSelectItemChange,this),this.playWayList.addEventListener(egret.Event.CHANGE,this.onSelectItemChange,this),this.antesList.addEventListener(egret.Event.CHANGE,this.onSelectItemChange,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.createRoomBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCreateRoomHandler,this),RoomManager.createRoomEA.removeListener(this.createRoomResult),this.roundList.removeEventListener(egret.Event.CHANGE,this.onSelectItemChange,this),this.playWayList.removeEventListener(egret.Event.CHANGE,this.onSelectItemChange,this),this.antesList.removeEventListener(egret.Event.CHANGE,this.onSelectItemChange,this)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),UIUtil.hideScrollerBar(this.roundScroller),UIUtil.hideScrollerBar(this.playWayScroller),UIUtil.hideScrollerBar(this.antesScroller),this.refreshUI(),this.onSelectItemChange(null,this.roundList),this.onSelectItemChange(null,this.playWayList),this.onSelectItemChange(null,this.antesList)},t.prototype.refreshUI=function(){var e;if(!RoomManager.roomInfo)return this.roundList.selectedIndex=0,this.playWayList.selectedIndex=0,this.antesList.selectedIndex=0,e=this.roundList.getElementAt(0),e&&(e.radioBtn1.selected=!0),e=this.playWayList.getElementAt(0),e&&(e.radioBtn1.selected=!0),e=this.antesList.getElementAt(0),void(e&&(e.radioBtn1.selected=!0));var t=ArrayUtil.getIndex(RoomManager.roomInfo.round,ProjectDefined.GetInstance().round,"num");-1!=t?(this.roundList.selectedIndex=t,e=this.roundList.getElementAt(t),e&&(e.radioBtn1.selected=!0)):this.roundList.selectedIndex=0,t=ArrayUtil.getIndex(RoomManager.roomInfo.type,ProjectDefined.GetInstance().playWay,"type"),-1!=t?(this.playWayList.selectedIndex=t,e=this.playWayList.getElementAt(t),e&&(e.radioBtn1.selected=!0)):this.playWayList.selectedIndex=0,t=ArrayUtil.getIndex(RoomManager.roomInfo.ante,ProjectDefined.GetInstance().antes,"score"),-1!=t?(this.antesList.selectedIndex=t,e=this.antesList.getElementAt(t),e&&(e.radioBtn1.selected=!0)):this.antesList.selectedIndex=0},t.prototype.createRoomResult=function(){UIManager.showFloatTips("创建房间成功！"),SceneManager.goToGame(!0),this.onCloseBtnClickHandler(null)},t.prototype.onCreateRoomHandler=function(e){return SoundManager.playButtonEffect(e.target),this.roundList.selectedItem?this.playWayList.selectedItem?this.antesList.selectedItem?void RoomManager.reqCreateRoom(this.roundList.selectedItem.num,this.playWayList.selectedItem.type,this.antesList.selectedItem.score):void UIManager.showFloatTips("请选择底分！"):void UIManager.showFloatTips("请选择玩法！"):void UIManager.showFloatTips("请选择局数！")},t.prototype.onSelectItemChange=function(e,t){var n;if(n=void 0!=t?t:e.target,n instanceof eui.List){var i=n.selectedIndex;-1==i&&(i=0),this.setListUnSelect(n);var a=n.getElementAt(i);a&&(a.radioBtn1.labelDisplay.textColor=1866515),e&&SoundManager.playEffect(Sex.Male,MusicAction.buttonClick)}},t.prototype.setListUnSelect=function(e){for(var t,n=0;n<e.numElements;n++)t=e.getElementAt(n),t&&(t.radioBtn1.labelDisplay.textColor=10572331)},t}(BasePanel);__reflect(CreateRoomPanel.prototype,"CreateRoomPanel");var CreateRoomPwdPanel=function(e){function t(){var t=e.call(this,!0)||this;return t.skinName=UISkinName.CreateRoomPwdPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.openPanelName=UIModuleName.CreateRoomPwdPanel},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.createBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.createRoom,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.createBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.createRoom,this)},t.prototype.enterPwd=function(e,t){if(t){var n=this.getUnWriteLabel();n&&n.refresh(parseInt(t))}if(2==e){var i=this.getWirteLabel();i&&i.refresh()}else 3==e&&this.resetLabel()},t.prototype.createRoom=function(){var e=this.getRoomPwd(),t=parseInt(e);return 0>=t||t.toString().length<6?void AlertManager.showSingleAlert("请先输入6位数的密码再创建房间！"):void UIManager.showFloatTips("发送创建房间请求")},t}(EnterRoomPwdPanel);__reflect(CreateRoomPwdPanel.prototype,"CreateRoomPwdPanel");var EditUserInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.EditUserInfoPanel,t}return __extends(t,e),t.prototype.init=function(t){e.prototype.init.call(this,t),this.sexButtonGroup=new eui.RadioButtonGroup,this.sexMaleButton.group=this.sexButtonGroup,this.sexMaleButton.value=Sex.Male,this.sexFemaleButton.group=this.sexButtonGroup,this.sexFemaleButton.value=Sex.Female,this.sexUnkonwnButton.group=this.sexButtonGroup,this.sexUnkonwnButton.value=Sex.Unknown,this.sexUnkonwnButton.selected=!0,this.ageLabel.inputType=egret.TextFieldInputType.TEL,this.ageLabel.restrict="0-9"},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.refreshAddressInfo()},t.prototype.refreshAddressInfo=function(){this.userDesLabel.text=UserManager.userInfo.des,this.ageLabel.text=UserManager.userInfo.age.toString(),this.sexLabel.text=this.sexButtonGroup.getRadioButtonAt(UserManager.userInfo.sex).label},t.prototype.saveEdit=function(){UserManager.userInfo.des=this.userDesLabel.text,UserManager.userInfo.age=parseInt(this.ageLabel.text),UserManager.userInfo.sex=this.sexButtonGroup.selectedValue},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),this.sexButtonGroup.addEventListener(egret.Event.CHANGE,this.changeActive,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),this.sexButtonGroup.removeEventListener(egret.Event.CHANGE,this.changeActive,this)},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),this.sexGroup.visible&&(this.sexGroup.visible=!1),e.target){case this.closeButton:this.saveEdit();break;case this.sexLabel:case this.showSexSelect:this.sexGroup.visible=!0}},t.prototype.changeActive=function(e){this.sexLabel.text=this.sexButtonGroup.selection.label},t}(BasePanel);__reflect(EditUserInfoPanel.prototype,"EditUserInfoPanel");var EnterLoginPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.EnterLoginPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.weixinLoginBtn:UIManager.showFloatTips("功能还未开放！");break;case this.guestBtn:UIManager.showFloatTips("功能还未开放！");break;case this.intranetAccountBtn:UIManager.dispatchEvent(UIModuleName.EnterLoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.IntranetAccount)}},t}(BasePanel);__reflect(EnterLoginPanel.prototype,"EnterLoginPanel");var LoadConfig=function(){function e(){}return e.startLoad=function(t,n){e.loadComplete=t,e.thisObj=n,RES.getResAsync("config_zip",function(t){if(null!=t){var n=new JSZip(t),i=JSON.parse(n.file("config.json").asText());DefinedManager.SetConfigData(i),e.loadLoginProtcolfile()}else console.log("配置数据载入失败！","config_zip")},this)},e.startLoadDevelopModeConfig=function(){var t=e.loadList[e.loadIndex];RES.getResByUrl(PathName.Config+t+ResSuffixName.Json,e.loadNext,this,RES.ResourceItem.TYPE_JSON)},e.loadNext=function(t,n){var i=e.loadList[e.loadIndex];DefinedManager.setData(i,t),e.loadIndex==e.loadList.length?e.loadLoginProtcolfile():(e.loadIndex++,e.startLoadDevelopModeConfig())},e.loadLoginProtcolfile=function(){RES.getResAsync("loginall_bin",function(t){null!=t?(GameSetting.LoginBin=t,e.loadc2sProtcolfile()):console.log("协议获取失败!loginall_bin")},this)},e.loadc2sProtcolfile=function(){RES.getResAsync("c2s_bin",function(t){null!=t?(GameSetting.Gamec2sBin=t,e.loads2cProtocolfile()):console.log("协议数据获取失败！c2s_bin")},this)},e.loads2cProtocolfile=function(){RES.getResAsync("s2c_bin",function(t){null!=t?(GameSetting.Games2cBin=t,e.loadComplete&&(e.thisObj?e.loadComplete.call(e.thisObj):e.loadComplete())):console.log("协议数据获取失败！s2c_bin")},this)},e}();LoadConfig.loadList=["project","cardGroup","cardWall","error","liangPai","music","outCard","pai","payList","shouPai","text","exp","name","forbidden","award","blind","fastChat"],__reflect(LoadConfig.prototype,"LoadConfig");var FriendPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.FriendPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this._ly=UIUtil.getVTileLayout(1,1,egret.VerticalAlign.TOP),this._giftly=UIUtil.getVTileLayout(1,1,egret.VerticalAlign.TOP),this._requestly=UIUtil.getVTileLayout(1,1,egret.VerticalAlign.TOP),this._addly=UIUtil.getVTileLayout(1,1,egret.VerticalAlign.TOP),this.list.layout=this._ly,this.giftList.layout=this._giftly,this.requestList.layout=this._requestly,this.addList.layout=this._addly,UIUtil.listRenderer(this.list,this.scroller,FriendItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.giftList,this.giftScroller,GiftItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.requestList,this.requestScroller,FriendRequestItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.addList,this.addScroller,AddFriendItemRenderer,ScrollViewDirection.Vertical_T_D),this.scroller.scrollPolicyH=this.giftScroller.scrollPolicyH=this.requestScroller.scrollPolicyH=this.addScroller.scrollPolicyH=eui.ScrollPolicy.OFF;var n=new Array;n.push(this.tabGroup),n.push(this.giftTabGroup),n.push(this.requestTabGroup),n.push(this.addTabGroup),this.friendTabCompontent.init(n)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.hasFriendGroup.visible=!1,this.noFriendGroup.visible=!1,this.hasGiftGroup.visible=!1,this.noGiftGroup.visible=!1,this.hasRequestGroup.visible=!1,this.noRequestGroup.visible=!1,this.setFriendListInfo()},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),FriendManager.onGetFriendListEvent.addListener(this.setFriendListInfo,this),UserManager.getOtherUserInfoEa.addListener(this.setFriendDetailInfo,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListClickHandler,this),this.addList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onAddListClickHandler,this),this.requestList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRequestListClickHandler,this),this.giftList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onGiftListClickHandler,this),this.inviteLabel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.inviteFriend,this),this.friendTabCompontent.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTabClickHandler,this),FriendManager.onReceiveGiftEvent.addListener(this.receiveGiftSuccess,this),this.fastReceiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.fastReceive,this),FriendManager.onFriendRequestEvent.addListener(this.setFriendRequestList,this),FriendManager.onReceiveFriendRequestEvent.addListener(this.refreshFriendRequestList,this),this.searchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.searchPlayer,this),this.searchText.addEventListener(eui.UIEvent.CHANGE,this.searchTextChange,this),FriendManager.onSearchPlayerEvent.addListener(this.setAddList,this),FriendManager.onFastReceiveEvent.addListener(this.fastReceiveSuccess,this),FriendManager.onRemovePlayerEvent.addListener(this.removePlayerSuccess,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),FriendManager.onGetFriendListEvent.removeListener(this.setFriendListInfo),UserManager.getOtherUserInfoEa.removeListener(this.setFriendDetailInfo),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListClickHandler,this),this.addList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onAddListClickHandler,this),this.requestList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRequestListClickHandler,this),this.inviteLabel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.inviteFriend,this),this.friendTabCompontent.tabBar.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTabClickHandler,this),FriendManager.onReceiveGiftEvent.removeListener(this.receiveGiftSuccess),this.fastReceiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.fastReceive,this),FriendManager.onFriendRequestEvent.removeListener(this.setFriendRequestList),FriendManager.onReceiveFriendRequestEvent.removeListener(this.refreshFriendRequestList),this.searchBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.searchPlayer,this),this.searchText.removeEventListener(eui.UIEvent.CHANGE,this.searchTextChange,this),FriendManager.onSearchPlayerEvent.removeListener(this.setAddList),FriendManager.onFastReceiveEvent.removeListener(this.fastReceiveSuccess),FriendManager.onRemovePlayerEvent.removeListener(this.removePlayerSuccess)},t.prototype.removePlayerSuccess=function(e){for(var t=0;t<FriendManager.friendList.length;t++)e==FriendManager.friendList[t].id&&FriendManager.friendList.splice(t,1);FriendManager.giftList.length<=0&&(this.hasFriendGroup.visible=!1,this.noFriendGroup.visible=!0),this._dp=new eui.ArrayCollection(FriendManager.friendList),this.list.dataProvider=this._dp},t.prototype.searchTextChange=function(e){this.searchText.text.trim().length<=0?this.searchBtn.visible=!1:(this.searchText.text.trim().length>=15&&(this.searchText.text=this.searchText.text.slice(0,15)),this.searchBtn.visible=!0)},t.prototype.setAddList=function(){var e=new FriendInfo;e.id=0,e.headImg="",e.goldNum=1e3,e.isCanGet=0,e.isHadGiven=0,e.isOnline=1,e.name="seven";var t=new FriendInfo;t.id=1,t.headImg="",t.goldNum=1e3,t.isCanGet=0,t.isHadGiven=1,t.isOnline=0,t.name="aaaaaa",FriendManager.searchList=new Array,FriendManager.searchList.push(e),FriendManager.searchList.push(t),FriendManager.searchList.length>0&&(this._dp=new eui.ArrayCollection(FriendManager.searchList),this.addList.dataProvider=this._dp)},t.prototype.searchPlayer=function(e){SoundManager.playButtonEffect(e.target),this.searchText.text.trim().length>0&&this.setAddList()},t.prototype.refreshFriendRequestList=function(){if(FriendManager.isReceive?AlertManager.showSingleAlertByString("您已成功添加此好友。"):AlertManager.showSingleAlertByString("您已拒绝此条好友申请。"),FriendManager.requestFriendList.length>0){for(var e=0;e<FriendManager.requestFriendList.length;e++)FriendManager.requestFriendList[e].id==FriendManager.requestFriendId&&FriendManager.requestFriendList.splice(e,1);FriendManager.requestFriendList.length<=0&&(this.hasRequestGroup.visible=!1,this.noRequestGroup.visible=!0),this._dp=new eui.ArrayCollection(FriendManager.requestFriendList),this.requestList.dataProvider=this._dp}else this.noRequestGroup.visible=!0,this.hasRequestGroup.visible=!1},t.prototype.setFriendRequestList=function(){var e=new FriendInfo;e.id=0,e.headImg="",e.goldNum=1e3,e.isCanGet=0,e.isHadGiven=0,e.isOnline=1,e.name="seven";var t=new FriendInfo;t.id=1,t.headImg="",t.goldNum=1e3,t.isCanGet=0,t.isHadGiven=1,t.isOnline=0,t.name="aaaaaa";var n=new FriendInfo;n.id=2,n.headImg="",n.goldNum=1e3,n.isCanGet=0,n.isHadGiven=1,n.isOnline=0,n.name="bbbbbb";var i=new FriendInfo;i.id=3,i.headImg="",i.goldNum=1e3,i.isCanGet=0,i.isHadGiven=1,i.isOnline=0,i.name="cccccc",FriendManager.requestFriendList=new Array,FriendManager.requestFriendList.push(e),FriendManager.requestFriendList.push(t),FriendManager.requestFriendList.push(n),FriendManager.requestFriendList.push(i),FriendManager.requestFriendList&&FriendManager.requestFriendList.length>0?(this._dp=new eui.ArrayCollection(FriendManager.requestFriendList),this.requestList.dataProvider=this._dp,this.hasRequestGroup.visible=!0):this.noRequestGroup.visible=!0},t.prototype.fastReceiveSuccess=function(){var e=FriendManager.giveOnceGoldNum*FriendManager.giftList.length;FriendManager.giftList=[],this._dp=new eui.ArrayCollection(FriendManager.giftList),this.giftList.dataProvider=this._dp,this.hasGiftGroup.visible=!1,this.noGiftGroup.visible=!0,this.fastReceiveBtn.enabled=!1,AlertManager.showSingleAlert("您已成功领取好友赠送的"+e+"金币！")},t.prototype.fastReceive=function(e){SoundManager.playButtonEffect(e.target),this.fastReceiveSuccess()},t.prototype.onGiftListClickHandler=function(e){FriendManager.friendId=this.giftList.selectedItem.id,this.receiveGiftSuccess()},t.prototype.receiveGiftSuccess=function(){for(var e=0;e<FriendManager.giftList.length;e++)FriendManager.friendId==FriendManager.giftList[e].id&&FriendManager.giftList.splice(e,1);FriendManager.giftList.length<=0&&(this.hasGiftGroup.visible=!1,this.noGiftGroup.visible=!0,this.fastReceiveBtn.enabled=!1),this._dp=new eui.ArrayCollection(FriendManager.giftList),this.giftList.dataProvider=this._dp,AlertManager.showSingleAlert("您已成功领取好友赠送的"+FriendManager.giveOnceGoldNum+"金币！")},t.prototype.onTabClickHandler=function(e){if(0==e.itemIndex);else if(1==e.itemIndex)if(FriendManager.giftList=[],FriendManager.friendList.length>0){for(var t=0,n=FriendManager.friendList;t<n.length;t++){var i=n[t];1==i.isHadGiven&&(FriendManager.giftList||(FriendManager.giftList=new Array),FriendManager.giftList.push(i))}FriendManager.giftList.length>0?(this._dp=new eui.ArrayCollection(FriendManager.giftList),this.giftList.dataProvider=this._dp,this.hasGiftGroup.visible=!0,this.fastReceiveBtn.enabled=!0,this.noGiftGroup.visible=!1):(this.noGiftGroup.visible=!0,this.fastReceiveBtn.enabled=!1)}else this.noGiftGroup.visible=!0,this.fastReceiveBtn.enabled=!1;else 2==e.itemIndex?this.setFriendRequestList():3==e.itemIndex&&(this.searchText.text="",FriendManager.searchList=[],this._dp=new eui.ArrayCollection(FriendManager.searchList),this.addList.dataProvider=this._dp,this.searchText.setFocus(),this.searchBtn.visible=!1)},t.prototype.inviteFriend=function(){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),ChannelManager.hasWeixin?UIManager.showFloatTips("打开微信"):AlertManager.showSingleAlert("您未安装微信，分享失败。")},t.prototype.onListClickHandler=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.list.selectedItem&&(FriendManager.userInfoPanelStyle=0,UIManager.showFloatTips("发送获取好友详请的请求"+this.list.selectedItem.id))},t.prototype.onAddListClickHandler=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.addList.selectedItem&&(FriendManager.userInfoPanelStyle=FriendInfoType.Send,UIManager.showFloatTips("发送获取用户详请的请求"+this.addList.selectedItem.id))
},t.prototype.onRequestListClickHandler=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.requestList.selectedItem&&(FriendManager.userInfoPanelStyle=FriendInfoType.Receive,UIManager.showFloatTips("发送获取好友详请的请求"+this.requestList.selectedItem.id))},t.prototype.setFriendDetailInfo=function(){FriendManager.userInfoPanelStyle==FriendInfoType.Receive||FriendManager.userInfoPanelStyle==FriendInfoType.Send?UIManager.showPanel(UIModuleName.UserInfoPanel,{type:FriendManager.userInfoPanelStyle}):UIManager.showPanel(UIModuleName.UserInfoPanel)},t.prototype.setFriendListInfo=function(){var e=new FriendInfo;e.id=0,e.headImg="",e.goldNum=1e3,e.isCanGet=0,e.isHadGiven=0,e.isOnline=1,e.name="seven";var t=new FriendInfo;t.id=1,t.headImg="",t.goldNum=1e3,t.isCanGet=0,t.isHadGiven=1,t.isOnline=0,t.name="aaaaaa";var n=new FriendInfo;n.id=2,n.headImg="",n.goldNum=1e3,n.isCanGet=0,n.isHadGiven=1,n.isOnline=0,n.name="bbbbbb";var i=new FriendInfo;i.id=3,i.headImg="",i.goldNum=1e3,i.isCanGet=0,i.isHadGiven=1,i.isOnline=0,i.name="cccccc",FriendManager.friendList=new Array,FriendManager.friendList.push(e),FriendManager.friendList.push(t),FriendManager.friendList.push(n),FriendManager.friendList.push(i),FriendManager.friendList&&FriendManager.friendList.length>0?(this._dp=new eui.ArrayCollection(FriendManager.friendList),this.list.dataProvider=this._dp,this.hasFriendGroup.visible=!0):this.noFriendGroup.visible=!0},t}(BackHomeAnimePanel);__reflect(FriendPanel.prototype,"FriendPanel");var GameHallPanel=function(e){function t(){var t=e.call(this)||this;return t.animeList=new Array,t.setGrayMask(!1),t.skinName=UISkinName.GameHallPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.moreGroup.visible=!1},t.prototype.init=function(t){e.prototype.init.call(this,t),this.refreshUserInfoUI(),(!UserManager.userInfo.name||UserManager.userInfo.name.length<=0)&&this.showCreateRolePanel()},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.refreshUserInfoUI=function(){this.userNameLabel.text=UserManager.userInfo.name.toString(),VipManager.isVip()?this.vipLevelLabel.text="VIP"+UserManager.userInfo.vipLevel:this.vipLevelLabel.visible=!1,this.refreshGold()},t.prototype.refreshGold=function(e){this.goldNumLabel.text=MathUtil.formatNum(UserManager.userInfo.gold),this.diamondNumLabel.text=MathUtil.formatNum(UserManager.userInfo.diamond)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.setEnterAnime(),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),PayManager.buyOverAction.addListener(this.refreshUserInfoUI,this),PayManager.cardNumUpdateAction.addListener(this.refreshGold,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.setOutAnime(),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),PayManager.buyOverAction.removeListener(this.refreshUserInfoUI),PayManager.cardNumUpdateAction.removeListener(this.refreshGold)},t.prototype.onClickHandler=function(e){switch(this.moreGroup.visible&&e.target!=this.moreBtn&&(this.moreGroup.visible=!1),e.target){case this.borderImg:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),UIManager.showPanel(UIModuleName.UserInfoPanel);break;case this.addDiamondBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.ShoppingPanel,{tab:1});break;case this.addGoldBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.ShoppingPanel,{tab:0});break;case this.pokerBtn:SoundManager.playButtonEffect(e.target),RoomManager.isInRoom?AlertManager.showDoubleAlert("你已加入有房间，是否确定进入？",this.goToGame.bind(this)):UIManager.showPanel(UIModuleName.PlayingFieldPanel);break;case this.matchBtn:SoundManager.playButtonEffect(e.target),RoomManager.isInRoom?AlertManager.showDoubleAlert("你已加入有房间，是否确定进入？",this.goToGame.bind(this)):UIManager.showPanel(UIModuleName.JoinInRoomPanel);break;case this.hundredBattle:SoundManager.playButtonEffect(e.target),RoomManager.isInRoom?AlertManager.showDoubleAlert("你已加入有房间，是否确定进入？",this.goToGame.bind(this)):UIManager.showPanel(UIModuleName.JoinInRoomPanel);break;case this.signBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick);break;case this.activityBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick);break;case this.mailBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),UIManager.showPanel(UIModuleName.MailPanel);break;case this.shopBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.ShoppingPanel);break;case this.friendBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.FriendPanel);break;case this.questBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick);break;case this.moreBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.moreGroup.visible=!this.moreGroup.visible;break;case this.freeGoldBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick);break;case this.safeBoxBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),VipManager.isVip()?(this.setOutAnime(),UIManager.showPanel(UIModuleName.SavePanel)):AlertManager.showDoubleAlert("保险箱功能仅对VIP用户开放",this.goShoppingPanel.bind(this));break;case this.gameRuleBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.GameRulePanel);break;case this.settingBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.setOutAnime(),UIManager.showPanel(UIModuleName.SetPanel)}},t.prototype.goToGame=function(){SceneManager.goToGame(!1)},t.prototype.setEnterAnime=function(){this.removeEnterAnime(),this.userinfoGroup.y=-100,this.animeList.push(egret.Tween.get(this.userinfoGroup).to({y:0},600,egret.Ease.backOut)),this.rightMenu.x=720,this.animeList.push(egret.Tween.get(this.rightMenu).to({x:570},600,egret.Ease.backOut)),this.ranking.x=-100,this.animeList.push(egret.Tween.get(this.ranking).to({x:0},600,egret.Ease.backOut)),this.gameButton.y=1280,this.animeList.push(egret.Tween.get(this.gameButton).to({y:810},800,egret.Ease.backOut)),this.bottomButton.y=1280,this.animeList.push(egret.Tween.get(this.bottomButton).to({y:1130},600,egret.Ease.backOut)),this.kanbanImg.alpha=0,this.animeList.push(egret.Tween.get(this.kanbanImg).to({alpha:1},200))},t.prototype.setOutAnime=function(){this.removeEnterAnime(),this.userinfoGroup.y=0,this.animeList.push(egret.Tween.get(this.userinfoGroup).to({y:-100},600)),this.rightMenu.x=570,this.animeList.push(egret.Tween.get(this.rightMenu).to({x:720},600)),this.ranking.x=0,this.animeList.push(egret.Tween.get(this.ranking).to({x:-100},600)),this.gameButton.y=810,this.animeList.push(egret.Tween.get(this.gameButton).to({y:1280},800)),this.bottomButton.y=1130,this.animeList.push(egret.Tween.get(this.bottomButton).to({y:1280},600)),this.kanbanImg.alpha=1,this.animeList.push(egret.Tween.get(this.kanbanImg).to({alpha:0},200).call(this.onCloseAnmComplete,this))},t.prototype.removeEnterAnime=function(){egret.Tween.removeTweens(this.userinfoGroup),egret.Tween.removeTweens(this.rightMenu),egret.Tween.removeTweens(this.ranking),egret.Tween.removeTweens(this.gameButton),egret.Tween.removeTweens(this.bottomButton),egret.Tween.removeTweens(this.kanbanImg)},t.prototype.onCloseAnmComplete=function(){UIManager.closePanel(this)},t.prototype.goShoppingPanel=function(){this.setOutAnime(),UIManager.showPanel(UIModuleName.ShoppingPanel)},t.prototype.goSavePanel=function(){this.setOutAnime(),UIManager.showPanel(UIModuleName.SavePanel)},t.prototype.showCreateRolePanel=function(){LoginManager.OnCreateRole.addListener(this.onCreateRoleComplete,this),UIManager.showPanel(UIModuleName.CreateRolePanel)},t.prototype.onCreateRoleComplete=function(){LoginManager.OnCreateRole.removeListener(this.onCreateRoleComplete),UIManager.closePanel(UIModuleName.CreateRolePanel)},t}(BasePanel);__reflect(GameHallPanel.prototype,"GameHallPanel");var PiaoHuaAnime=function(){function e(e){this.piaoHuaTween=new Array,this.startY=0,this.endY=750,this.maxX=500,this.timer=new egret.Timer(2500),this.piaoHuaList=e}return e.prototype.StartTween=function(){this.index=0,this.timer.addEventListener(egret.TimerEvent.TIMER,this.SetTweenRandom,this),this.timer.start()},e.prototype.SetTweenRandom=function(){if(this.index==this.piaoHuaList.length)return void this.timer.stop();var e=this.piaoHuaList[this.index];this.index++;var t=egret.Tween.get(e,{loop:!0});e.x=Math.random()*(this.maxX/2)+this.maxX/2,e.y=this.startY,t.to({x:Math.random()*e.x/2,y:this.endY,rotation:360*Math.random()},1e4),t.play(),this.piaoHuaTween.push(t)},e.prototype.PauseTween=function(){for(var e=0;e<this.piaoHuaList.length;e++)this.piaoHuaTween[e]&&this.piaoHuaTween[e].pause()},e}();__reflect(PiaoHuaAnime.prototype,"PiaoHuaAnime");var Anime=function(){function e(e){this.animeItem=e}return e.prototype.SetTween=function(e,t,n,i,a){var o=egret.Tween.get(this.animeItem,{loop:n});a?o.to(e,t).call(a,this):o.to(e,t),this.itemTween=o,i?(this.isDelay=!0,this.delayTime=i):this.isDelay=!1},e.prototype.PlayTween=function(){if(this.isDelay){var e=new egret.Timer(this.delayTime);e.addEventListener(egret.TimerEvent.TIMER,this.TweenDelay,this),this.timer=e,this.timer.start()}else this.itemTween.setPaused(!1)},e.prototype.PauseTween=function(){this.itemTween.setPaused(!0)},e.prototype.TweenDelay=function(){this.timer.stop(),this.itemTween.setPaused(!1)},e}();__reflect(Anime.prototype,"Anime");var GameOverPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.GameOverPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.infoGroup.layout=UIUtil.getHTileLayout(-18,1,egret.HorizontalAlign.LEFT),VersionManager.setComponentVisibleBySafe(this.shareBtn),this.shareBtn.visible?this.exitBtn.horizontalCenter="121.5":this.exitBtn.horizontalCenter="0",e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),UIUtil.bindRender(this.infoGroup,GameOverItemRenderer,GoCardProcessManager.gameOverList)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t);var n=TimeManager.GetServerLocalDateTime();this.timeLabel.text=DateTimeUtil.formatDate(n),RoomManager.roomInfo&&(this.roomInfoLabel.text="房间号:"+RoomManager.roomInfo.roomId+"局数 "+RoomManager.roomInfo.roundNum+"/"+RoomManager.roomInfo.round)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.shareBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareHandler,this),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareHandler,this),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onExitHandler,this)},t.prototype.onShareHandler=function(e){UIManager.showFloatTips("正在开发中!"),SoundManager.playButtonEffect(e.target)},t.prototype.onExitHandler=function(e){RoomManager.reqExitRoom(!0),SoundManager.playButtonEffect(e.target)},t}(BasePanel);__reflect(GameOverPanel.prototype,"GameOverPanel");var GameRulePanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.GameRulePanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t);var n=new Array;n.push(this.RuleIntroGroup),n.push(this.cardTypeGroup),n.push(this.funcKeyIntroGroup),this.gameRullTab.init(n)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t}(BackHomeAnimePanel);__reflect(GameRulePanel.prototype,"GameRulePanel");var GameScenePanel=function(e){function t(){var t=e.call(this)||this;return t._startPlayTouziTime=0,t._playTouziGap=500,t._exactlyBenJiaGap=300,t.tingOutCardTime=0,t.tingGap=800,t._refreshStateGap=500,t.actionWidth=157,t.isTween=!1,t.setGrayMask(!1),t._benjia_info=new RoomUserHeadInfoComponent,t._benjia_info.x=3,t._benjia_info.y=498,t._xiajia_info=new RoomUserHeadInfoComponent,t._xiajia_info.x=1178,t._xiajia_info.y=137,t._duijia_info=new RoomUserHeadInfoComponent,t._duijia_info.x=950,t._duijia_info.y=0,t._shangjia_info=new RoomUserHeadInfoComponent,t._shangjia_info.x=-1,t._shangjia_info.y=175,t._userInfoRendererList=new Array,t._userInfoRendererList.push(t._benjia_info),t._userInfoRendererList.push(t._xiajia_info),t._userInfoRendererList.push(t._duijia_info),t._userInfoRendererList.push(t._shangjia_info),t._touziCompent1=t.createTouziComponent(18,-70),t._touziCompent2=t.createTouziComponent(-21,-70),t._audioRecordBtnOper=new AudioRecordButton,t.skinName=UISkinName.GameScenePanel,t}return __extends(t,e),t.prototype.createTouziComponent=function(e,t){var n=new TouZiComponent;return n.scaleX=n.scaleY=.4,n.horizontalCenter=e,n.verticalCenter=t,n},t.prototype.onAwake=function(t){this._windImgList=new Array,this.benJiaWind.touchEnabled=this.xiaJiaWind.touchEnabled=this.duiJiaWind.touchEnabled=this.shangJiaWind.touchEnabled=!1,this.actionTimeLabel.touchEnabled=!1,this._windImgList.push(this.benJiaWind),this._windImgList.push(this.xiaJiaWind),this._windImgList.push(this.duiJiaWind),this._windImgList.push(this.shangJiaWind);for(var n=0,i=this._userInfoRendererList;n<i.length;n++){var a=i[n];a.visible=!1,this.pubGroup.addChildAt(a,0)}this.timeLogic=new TimeShowLogic(this.actionTimeLabel),this.timeLogic.setWaitTimeGroup(this.waitShowGroup),this.waitShowGroup.visible=!1,this.gameEffectLogic=new GameEffectLogic(this.tweenGroup),this._windAnimateList=new Array,this._windAnimateList.push(this.benjiaAnimate),this._windAnimateList.push(this.xiajiaAnimate),this._windAnimateList.push(this.duijiaAnimate),this._windAnimateList.push(this.shangjiaAnimate),this._duijia_info.setReadyImg(this.duiJiaReadyImg),this._benjia_info.setReadyImg(this.benJiaReadyImg),this._xiajia_info.setReadyImg(this.xiaJiaReadyImg),this._shangjia_info.setReadyImg(this.shangJiaReadyImg),this._duijia_info.setHostedImg(this.duiJiaHostedImg),this._benjia_info.setHostedImg(this.hostGroup),this._xiajia_info.setHostedImg(this.xiaJiaHostedImg),this._shangjia_info.setHostedImg(this.shangJiaHostedImg),this.actionTimeLabel.visible=!1,VersionManager.setComponentVisibleBySafe(this.invitBtn),this._audioRecordBtnOper.initialize(this.voiceBtn),e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.panelData&&this.headInit(),this.waitShowGroup.visible=!1,this.hideWindTween(),this.hideActionBtn(),this.showPaiPosGroup(!1),this.showWaitGroup(!0),t&&this.refreshWaitBtnState(),this.maimaComponent.visible=!1},t.prototype.showWaitGroup=function(e){this.waitGroup.visible=e},t.prototype.nextRound=function(){this.actionTimeLabel.visible=!1,this.maimaComponent.visible=!1,this.showWaitGroup(!1),clearTimeout(this._refreshTimeId),GoCardProcessManager.state=GameSceneState.WaitStart,this.initRound(),this.onRender(null),this.refreshHeadInfo(),this.refreshHotedBtn(),UIManager.closePanel(UIModuleName.TingInfoPanel)},t.prototype.clear=function(){this._exactlyBenJiaTime=0,this.tingOutCardTime=0,this._isRunFaPai=!1,this._isTouziPlay=!1,GoCardProcessManager.isDispatchInit=!1},t.prototype.initRoomInfo=function(){if(RoomManager.roomInfo){var e=ProjectDefined.GetInstance().getPlayWayDefinition(RoomManager.roomInfo.type);e&&(this.roundTypeLabel.text=e.des),this.roundNumLabel.text="第"+RoomManager.roomInfo.roundNum+"/"+RoomManager.roomInfo.round+"局",this.refreshRemainLabel()}this.refreshTingHelpBtn(!1)},t.prototype.refreshRemainLabel=function(){if(RoomManager.roomInfo){var e=GameSetting.CardTotalNum-RoomManager.roomInfo.head;e?this.remainLabel.text=e.toString():this.remainLabel.text="0"}},t.prototype.initRound=function(){this.hideActionBtn(),GoCardProcessManager.isDispatchInit=!1,this._exactlyBenJiaTime=0,this._startPlayTouziTime=0,this.showPaiPosGroup(!1)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),RoomManager.roomInfo&&(this.refreshPubGroup(),this.refreshState(),this.initRoomInfo())},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),Tick.getInstance().AddSecondsInvoke(this.refreshTimeInfo,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),this.addEventListener(egret.Event.ENTER_FRAME,this.update,this),CardWallHandler.runAd.addListener(this.onRunCardWallComplete,this),CardWallHandler.faMoAd.addListener(this.onFaMoCardWallComplete,this),this._touziCompent1.onTouZiComplete.addListener(this.onTouZiComplete,this),OutCardHandler.onOutCardChange.addListener(this.onRefresh,this),this._audioRecordBtnOper.OnEnable(),this.timeLogic.onEnable(),RecordAudioManager.OnPrepearPlay.addListener(this.prepearPlayRecordHandler,this),RecordAudioManager.OnPlayRecordComplete.addListener(this.playRecordCompleteHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),Tick.getInstance().RemoveSecondsInvoke(this.refreshTimeInfo),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.update,this),CardWallHandler.runAd.removeListener(this.onRunCardWallComplete),CardWallHandler.faMoAd.removeListener(this.onFaMoCardWallComplete),this._touziCompent1.onTouZiComplete.removeListener(this.onTouZiComplete),OutCardHandler.onOutCardChange.removeListener(this.onRefresh),clearTimeout(this._lastCardShowTimeId),this.tingOutCardTime=0,this.timeLogic.onDisable(),this._audioRecordBtnOper.OnDisable(),this.maimaComponent.animate.stop(),RecordAudioManager.OnPrepearPlay.removeListener(this.prepearPlayRecordHandler),RecordAudioManager.OnPlayRecordComplete.removeListener(this.playRecordCompleteHandler)},t.prototype.onPanelClick=function(e){if(e.target instanceof RoomUserHeadInfoComponent){var t=e.target;t.bindData&&UserManager.reqGetOtherUserInfo(t.bindData.roleId),SoundManager.playEffect(Sex.Male,MusicAction.buttonClick)}else switch(SoundManager.playButtonEffect(e.target),e.target){case this.invitBtn:UIManager.showFloatTips("正在开发中！");break;case this.exitBtn:case this.disbandedBtn:RoomManager.roomInfo&&(RoomManager.roomInfo.roundNum<=0?RoomManager.isMineHost?AlertManager.showDoubleAlert("第一局未开启前解散房间不扣除房卡，是否确认解散？",RoomManager.reqExitRoom):RoomManager.reqExitRoom():RoomManager.isMineHost?AlertManager.showDoubleAlert("解散房间需要其他玩家同意，是否发送解散申请？",RoomManager.reqExitRoom):AlertManager.showDoubleAlert("退出房间需要其他玩家同意，是否发送退出申请？",RoomManager.reqExitRoom));break;case this.moPaiBtn:this.mopai=MathUtil.getRandom(1,28);break;case this.daPaiBtn:break;case this.insertPaiBtn:break;case this.benJiaSortBtn:break;case this.testPengBtn:this._exactlyBenJiaTime=1;break;case this.testGangBtn:SceneManager.gameScene.gameProcesser.testShowPeng(PosType.BenJia);break;case this.pengBtn:GoCardProcessManager.reqPengCard();break;case this.gangBtn:var n=SceneManager.gameScene.gameProcesser.canGangList;n&&n.length>1?(this._gangPanelVisible=!0,this.recordBtnsVisible(),this.hideActionBtn(),this.showCancelBtn(!0),UIManager.showPanel(UIModuleName.GangSelectPanel,n)):GoCardProcessManager.reqGangCard();break;case this.huBtn:GoCardProcessManager.reqHuCard();break;case this.tingBtn:this.recordBtnsVisible(),this.hideActionBtn(),this.showCancelBtn(!0),GoCardProcessManager.isClickTingBtn=!0;break;case this.cancelBtn:this.backUpBtnVisible(),this.showGuoBtn(!0),this.showCancelBtn(!1),GoCardProcessManager.isClickTingBtn=!1;break;case this.guoBtn:GoCardProcessManager.isInActionSelect?GoCardProcessManager.reqPass():(SceneManager.gameScene.gameProcesser.isCanHu&&RoomManager.roomInfo&&RoomManager.mineInfo&&RoomManager.mineInfo.isTing&&(console.log("胡牌过牌出牌了："),GoCardProcessManager.reqPutOutCard(null,RoomManager.roomInfo.myLastCard)),this.hideActionBtn(),this.showGuoBtn(!1));break;case this.tweenGroup:case this.cardGroup:UIManager.closePanel(UIModuleName.TingInfoPanel);break;case this.tingHelpBtn:SceneManager.gameScene.gameProcesser.showTingInfoPanel();break;case this.cancelHostedBtn:GoCardProcessManager.reqCancelHosted();break;case this.settingBtn:UIManager.showPanel(UIModuleName.SettingPanel)}},t.prototype.onCloseBtnClickHandler=function(e){this.tryGoBackHall()},t.prototype.tryGoBackHall=function(){AlertManager.showDoubleAlert("返回大厅，房间仍会保留，快邀请伙伴来玩吧！",this.goBackHall)},t.prototype.goBackHall=function(){SceneManager.goToHall()},t.prototype.update=function(e){!GoCardProcessManager.isDispatchInit&&this._touziCompent1.isLoadComplete&&this._touziCompent2.isLoadComplete&&(GoCardProcessManager.isDispatchInit=!0,this.panelData&&UIManager.dispatchEvent(UIModuleName.GameScenePanel,UIModuleEvent.COMPLETE)),!this._isTouziPlay&&0!=this._startPlayTouziTime&&egret.getTimer()-this._startPlayTouziTime>=this._playTouziGap&&(this._isTouziPlay=!0,this.playTouziAnimate()),0!=this._exactlyBenJiaTime&&egret.getTimer()-this._exactlyBenJiaTime>=this._exactlyBenJiaGap&&(this._exactlyBenJiaTime=0,SceneManager.gameScene.gameProcesser.exactlyBenJiaCard(),clearTimeout(this._lastCardShowTimeId),this._lastCardShowTimeId=egret.setTimeout(this.tryShowLastCard,this,500)),0!=this.tingOutCardTime&&egret.getTimer()-this.tingOutCardTime>=this.tingGap&&(this.tingOutCardTime=0,RoomManager.roomInfo&&!SceneManager.gameScene.gameProcesser.isCanHu&&(console.log("听牌自动出牌"),GoCardProcessManager.reqPutOutCard(null,RoomManager.roomInfo.myLastCard)))},t.prototype.onPlayerJoin=function(e,t){var n;n=this._userInfoRendererList[t-1],n.visible=!0,n.init(e)},t.prototype.refreshPubGroup=function(){this.refreshTimeInfo(),this.roomIdLabel.text=RoomManager.roomInfo.roomId.toString(),this.refreshWind(!0)},t.prototype.refreshTimeInfo=function(){var e=TimeManager.GetServerLocalDateTime();this.timeLabel.text=DateTimeUtil.formatCountdown(e.getHours())+":"+DateTimeUtil.formatCountdown(e.getMinutes())+":"+DateTimeUtil.formatCountdown(e.getSeconds())},t.prototype.showScoreEffect=function(){this.gameEffectLogic&&this.gameEffectLogic.showScoreEffect(),this.refreshHeadInfo()},t.prototype.showActionEffect=function(e,t){e==ActionType.MaiMa?this.maimaComponent&&(this.maimaComponent.image0.alpha=1,this.maimaComponent.image.alpha=1,this.maimaComponent.visible=!0,this.maimaComponent.animate.stop(),this.maimaComponent.animate.play()):this.gameEffectLogic&&this.gameEffectLogic.showActionEffect(e,t)},t.prototype.refreshTime=function(e,t){this.timeLogic&&(this.timeLogic.nowTotal=e+TimeManager.GetServerUtcTimestamp(),void 0!=t&&(this.actionTimeLabel.visible=t))},t.prototype.refreshHeadInfo=function(){var e,t,n=RoomManager.mineInfo;if(n)for(var i=PosType.BenJia;i<=PosType.ShangJia;i++)e=this._userInfoRendererList[i-1],t=RoomManager.findPlayerInfo(n.pos,i),t?(e.visible=!0,e.init(t)):e.visible=!1},t.prototype.hidePlayerHead=function(e){var t=RoomManager.getPosTypeByRoleId(e);if(t>=PosType.BenJia&&t<=PosType.ShangJia){var n=this._userInfoRendererList[t-1];n.visible=!1,n.init(null)}},t.prototype.headInit=function(){for(var e,t=0;t<this._userInfoRendererList.length;t++)e=this._userInfoRendererList[t],e.init(null)},t.prototype.refreshWind=function(e){void 0===e&&(e=!1);var n=RoomManager.mineInfo;if(n&&RoomManager.roomInfo){var i,a;GoCardProcessManager.state==GameSceneState.Processing?(a=!0,i=RoomManager.roomInfo.pos):(a=!1,i=RoomManager.mineInfo.pos);for(var o,r,s,l=RoomManager.getPosTypeForMine(i),c=0,h=0,d=PosType.BenJia;d<=PosType.ShangJia;d++)c=RoomManager.getPosByPosTypeForMine(d),r=t._windNameList[c-1],o=t._directionNameList[d-1],s=this._windImgList[d-1],h=0,d==l?a?(h=1,this.hideWindTween(),e||(this._lastWindTween=this._windAnimateList[l-1],this._lastWindTween.play())):(this.hideWindTween(),s.alpha=1,h=1):h=0,0==h&&(s.alpha=1),s.source=r+"_"+o+"_"+h+ResSuffixName.PNGSuffix}},t.prototype.hideWindTween=function(){this._lastWindTween&&this._lastWindTween.stop()},t.prototype.refreshState=function(){switch(clearTimeout(this._refreshTimeId),this.gameGroup.visible=!1,this.waitGroup.touchEnabled=!1,GoCardProcessManager.state){case GameSceneState.Processing:case GameSceneState.RunFapai:this.gameGroup.visible=!0,this.btnGroup.visible=!0;break;case GameSceneState.WaitStart:this._touziCompent1.visible=this._touziCompent2.visible=!1}},t.prototype.showTing=function(e,t){this.refreshHeadInfo()},t.prototype.showCardGroup=function(e){this.cardGroup.visible=e},t.prototype.refreshWaitTime=function(e){void 0==this._waitOtherReadyTime&&(this._waitOtherReadyTime=ProjectDefined.GetInstance().getValue(ProjectDefined.waitReadyTime)),(e<=this._waitOtherReadyTime||void 0==e)&&(this.timeLogic.waitTime=e+TimeManager.GetServerUtcTimestamp(),e>0&&this.showPaiPosGroup(!1))},t.prototype.playTouziAnimate=function(){this._touziCompent1.visible=this._touziCompent2.visible=!0,this._touziCompent1.init(RoomManager.roomInfo.num1),this._touziCompent2.init(RoomManager.roomInfo.num2),this.addChild(this._touziCompent1),this.addChild(this._touziCompent2)},t.prototype.onTouZiComplete=function(){this._isRunFaPai||(this._startPlayTouziTime=0,this._isRunFaPai=!0,SceneManager.gameScene.gameProcesser.shouCardHandlerInit(!1),SceneManager.gameScene.gameProcesser.runFaPai())},t.prototype.onRunCardWallComplete=function(){this._startPlayTouziTime=egret.getTimer(),this._isTouziPlay=!1,this._isRunFaPai=!1},t.prototype.onFaMoCardWallComplete=function(){GoCardProcessManager.state=GameSceneState.Processing,this._refreshTimeId=egret.setTimeout(this.refreshState,this,this._refreshStateGap),this._exactlyBenJiaTime=egret.getTimer()},t.prototype.onRefresh=function(e){this.paiPosGroup.x=e.x,this.paiPosGroup.y=e.y,this.showPaiPosGroup(!0),this.paiPosGroup.parent.addChild(this.paiPosGroup)},t.prototype.tryShowLastCard=function(){GoCardProcessManager.isReady=!0,RoomManager.updateHead(1),this._touziCompent1.parent&&(this.removeChild(this._touziCompent1),this.removeChild(this._touziCompent2)),this.actionTimeLabel.visible=!0,SceneManager.gameScene.gameProcesser.showLastCard(),clearTimeout(this._lastCardShowTimeId),this.refreshWind()},t.prototype.hideActionBtn=function(){this.pengBtn.visible=!1,this.gangBtn.visible=!1,this.tingBtn.visible=!1,this.huBtn.visible=!1,this.cancelBtn.visible=!1,this.guoBtn.visible=!1},t.prototype.recordBtnsVisible=function(){this._pengVisible=this.pengBtn.visible,this._gangVisible=this.gangBtn.visible,this._huVisible=this.huBtn.visible,this._tingVisible=this.tingBtn.visible},t.prototype.backUpBtnVisible=function(){this.pengBtn.visible=this._pengVisible,this.gangBtn.visible=this._gangVisible,this.huBtn.visible=this._huVisible,this.tingBtn.visible=this._tingVisible,this._gangPanelVisible&&(this._gangPanelVisible=!1,UIManager.closePanel(UIModuleName.GangSelectPanel))},t.prototype.refreshHotedBtn=function(){RoomManager.mineInfo&&(this.hostGroup.visible=!1,RoomManager.mineInfo.hosted&&(this.hostGroup.visible=!0))},t.prototype.showBtnState=function(e,t){e.visible=t,this.showBtnAnimate(e,t);for(var n,i=3,a=0;a<this.btnGroup.numChildren;a++)n=this.btnGroup.getChildAt(a),n&&n.visible&&(n.x=157*i,i--)},t.prototype.showPaiPosGroup=function(e){this.paiPosGroup.visible=e,e||(this.promptComponet.y=29),this.showBtnAnimate(this.promptComponet,e)},t.prototype.showCancelBtn=function(e){this.cancelBtn.visible=e,this.showBtnAnimate(this.cancelBtn,e)},t.prototype.showGuoBtn=function(e){this.guoBtn.visible=e,this.showBtnAnimate(this.guoBtn,e)},t.prototype.refreshTingHelpBtn=function(e){this.tingHelpBtn.visible=e,this.showBtnAnimate(this.tingHelpBtn,e)},t.prototype.refreshWaitBtnState=function(){RoomManager.mineInfo&&(this.exitBtn.visible=!1,this.disbandedBtn.visible=!1,this.invitBtn.visible=!1,RoomManager.isMineHost?(this.disbandedBtn.visible=!0,this.invitBtn.visible=!0):this.exitBtn.visible=!0),VersionManager.setComponentVisibleBySafe(this.invitBtn)},t.prototype.showBtnAnimate=function(e,t){var n=e;t?n.animate&&(n.animate.pause(),n.animate.play(0)):n.animate&&n.animate.pause()},t.prototype.prepearPlayRecordHandler=function(e){var t=ChatManager.getRecordChatInfo(e);if(t){var n=this.getHeadComponent(t.roleId);n&&n.showPlayRecordState(!0)}},t.prototype.playRecordCompleteHandler=function(e){var t=ChatManager.getRecordChatInfo(e);if(t){var n=this.getHeadComponent(t.roleId);n&&n.showPlayRecordState(!1)}},t.prototype.getHeadComponent=function(e){var t,n,i=RoomManager.mineInfo;if(!i)return null;for(var a=PosType.BenJia;a<=PosType.ShangJia;a++)if(t=this._userInfoRendererList[a-1],n=RoomManager.findPlayerInfo(i.pos,a),n&&n.roleId==e)return t;return null},t}(BasePanel);GameScenePanel._windNameList=["e","s","w","n"],GameScenePanel._directionNameList=["down","right","up","left"],__reflect(GameScenePanel.prototype,"GameScenePanel");var AudioRecordButton=function(){function e(){this._isRecording=!1,this._isOnRecord=!1,this._isPress=!1}return e.prototype.initialize=function(e){this._recordButton=e},e.prototype.OnEnable=function(){this._recordButton.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onOutSide,this),this._recordButton.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRecordBtnBegin,this),this._recordButton.addEventListener(egret.TouchEvent.TOUCH_END,this.onRecordBtnEnd,this),this._recordButton.addEventListener(egret.TouchEvent.LEAVE_STAGE,this.onLevelStage,this),GameManager.stage.addEventListener(egret.Event.DEACTIVATE,this.SystemManager_OnGamePause,this),ChannelManager.OnApplicationFocus.addListener(this.OnApplicationFocus,this)},e.prototype.OnDisable=function(){this._recordButton.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onOutSide,this),this._recordButton.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRecordBtnBegin,this),this._recordButton.removeEventListener(egret.TouchEvent.TOUCH_END,this.onRecordBtnEnd,this),this._recordButton.removeEventListener(egret.TouchEvent.LEAVE_STAGE,this.onLevelStage,this),GameManager.stage.removeEventListener(egret.Event.DEACTIVATE,this.SystemManager_OnGamePause,this),ChannelManager.OnApplicationFocus.removeListener(this.OnApplicationFocus),RecordAudioManager.RestoreMusicSetting()},e.prototype.SystemManager_OnGamePause=function(e){1==this._isRecording&&this.StopRecording(!0)},e.prototype.OnApplicationFocus=function(e){0==e&&1==this._isRecording&&this.StopRecording(!0)},e.prototype.onRecordBtnBegin=function(e){e.currentTarget;if(RecordAudioManager.CheckMicrophone(!0))return RecordAudioManager.IsStillHandling()?void UIManager.showFloatTips("上一条音频数据上传中"):void(0==this._isRecording&&(this._isRecording=!0,ChannelManager.recordAudio(AudioRecordActions.StartRecord),this.StopRecordLater(),UIManager.showPanel(UIModuleName.AudioRecordingPanel,!0)))},e.prototype.onRecordBtnEnd=function(e){this.StopRecording(!1)},e.prototype.onOutSide=function(e){this.StopRecording(!0)},e.prototype.onLevelStage=function(e){this.StopRecording(!0)},e.prototype.StopRecordLater=function(){egret.clearTimeout(this._recordTimer),this._recordTimer=egret.setTimeout(this.StopRecording,this,ProjectDefined.GetInstance().getValue(ProjectDefined.chatMaxRecordTime),!1)},e.prototype.StopRecording=function(e){egret.clearTimeout(this._recordTimer),this._isRecording&&(this._isRecording=!1,UIManager.closePanel(UIModuleName.AudioRecordingPanel),e?(ChannelManager.recordAudio(AudioRecordActions.CancelRecord),RecordAudioManager.RecordVoice(AudioRecordActions.CancelRecord),console.log("取消录音")):(ChannelManager.recordAudio(AudioRecordActions.StopRecord),RecordAudioManager.RecordVoice(AudioRecordActions.StopRecord),console.log("停止录音")))},e.prototype.SetGray=function(e){e?FilterUtil.setGray(this._recordButton):FilterUtil.setEraseGray(this._recordButton),this._recordButton.touchEnabled=!e},e}();__reflect(AudioRecordButton.prototype,"AudioRecordButton");var GameEffectLogic=function(){function e(e){this.index=0,this.tweenGroup=e}return e.prototype.showScoreEffect=function(){for(var e,t,n,i,a=0;a<GoCardProcessManager.scroeInfoList.length;a++)t=GoCardProcessManager.scroeInfoList[a],0!=t.offsetScore&&(e=new ScoreEffectComponent,e.init(t),i=RoomManager.getPlayerInfoByRoleId(t.roleId),i&&(n=RoomManager.getPosTypeForMine(i.pos),this.setPos(e,n)),this.tweenGroup.addChild(e))
},e.prototype.showActionEffect=function(e,t){if(t>=PosType.BenJia&&t<=PosType.ShangJia){this._actionInfo||(this._actionInfo=new ActionInfo);var n=new ActionEffectComponent;this._actionInfo.actionType=e,this._actionInfo.posType=t,n.init(this._actionInfo),this.setActionPos(n,t),this.tweenGroup.addChild(n)}},e.prototype.setPos=function(e,t){switch(t){case PosType.BenJia:e.horizontalCenter=-3,e.y=496;break;case PosType.XiaJia:e.horizontalCenter=363,e.verticalCenter=-50;break;case PosType.DuiJia:e.horizontalCenter=10,e.y=95;break;case PosType.ShangJia:e.verticalCenter=-50,e.x=200}},e.prototype.setActionPos=function(e,t){switch(t){case PosType.BenJia:e.horizontalCenter=-3,e.y=300;break;case PosType.XiaJia:e.horizontalCenter=250,e.y=150;break;case PosType.DuiJia:e.horizontalCenter=10,e.y=30;break;case PosType.ShangJia:e.verticalCenter=-50,e.x=160}},e}();__reflect(GameEffectLogic.prototype,"GameEffectLogic");var ActionInfo=function(){function e(){}return e}();__reflect(ActionInfo.prototype,"ActionInfo");var TimeShowLogic=function(){function e(e){this.timeLabel=e,this.timeLabel.text=StringConstant.empty}return Object.defineProperty(e.prototype,"waitTime",{get:function(){return this._waitTime},set:function(e){this._waitTime=e,void 0==e?this._waitTimeGroup.visible=!1:this.refreshTime()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nowTotal",{get:function(){return this._nowTotal},set:function(e){this._nowTotal=e,this.refreshTime()},enumerable:!0,configurable:!0}),e.prototype.setWaitTimeGroup=function(e){this._waitTimeGroup=e},e.prototype.onEnable=function(){Tick.getInstance().AddSecondsInvoke(this.refreshTime,this)},e.prototype.onDisable=function(){Tick.getInstance().RemoveSecondsInvoke(this.refreshTime)},e.prototype.refreshTime=function(){void 0!=this.nowTotal?(this._offsetTime=Math.round(this.nowTotal-TimeManager.GetServerUtcTimestamp()),this._offsetTime>=0&&(this.timeLabel.text=DateTimeUtil.formatCountdown(this._offsetTime))):this.timeLabel.text=StringConstant.empty,void 0!=this.waitTime&&0/0!=this.waitTime?(this._offsetTime=Math.round(this.waitTime-TimeManager.GetServerUtcTimestamp()),this._offsetTime>=0?this._waitTimeGroup.visible=!0:this._waitTimeGroup.visible=!1):this._waitTimeGroup.visible=!1},e}();__reflect(TimeShowLogic.prototype,"TimeShowLogic");var GangSelectPanel=function(e){function t(){var t=e.call(this)||this;return t.setGrayMask(!1),t.offsetV=20,t.skinName=UISkinName.GangSelectPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.contentGroup.layout=UIUtil.getHTileLayout(10,1,egret.HorizontalAlign.CENTER),e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),UIUtil.bindRender(this.contentGroup,GangPaiSelectItemRenderer,this.panelData)},t.prototype.onEnable=function(t){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),e.prototype.onDisable.call(this,t)},t.prototype.onPanelClick=function(e){if(SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),e.target instanceof GangPaiSelectItemRenderer){var t=e.target;GoCardProcessManager.reqGangCard(t.bindData)}},t}(BasePanel);__reflect(GangSelectPanel.prototype,"GangSelectPanel");var GetCoinTipsPanel=function(e){function t(){var t=e.call(this)||this;return t.layer=UILayerType.Tips,t.setTouchChildren(!1),t.setTouchEnable(!1),t.setGrayMask(!1),t.skinName=UISkinName.GetCoinTipsPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.panelData&&(this.textLabel.text=this.panelData,this.removeTweenEvents(),this.creatCoinTween(),this.createTween())},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.creatCoinTween=function(){for(var e=0;10>e;e++){var t=new eui.Image("hua"+(e%4+1)+"_png");t.y=-100,t.x=720*Math.random(),t.scaleX=3,t.scaleY=3,egret.Tween.get(t).wait(50*e).to({y:1280},1e3,egret.Ease.cubicIn),this.coinGroup.addChild(t)}},t.prototype.createTween=function(){this.alpha=1,this._disappearTween=new egret.Tween(this,null,null),this._disappearTween.wait(1e3).to({alpha:0},2e3,egret.Ease.quadOut).call(this.onPlayOver,this),this._disappearTween.play()},t.prototype.onPlayOver=function(e){this.onCloseBtnClickHandler(null),this._disappearTween=null},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeTweenEvents()},t.prototype.removeTweenEvents=function(){this._disappearTween&&(egret.Tween.removeTweens(this),this._disappearTween=null)},t}(BasePanel);__reflect(GetCoinTipsPanel.prototype,"GetCoinTipsPanel");var JoinInRoomPanel=function(e){function t(){for(var t=e.call(this)||this,n=1;6>=n;n++)t["label"+n.toString()]=new NumComponent;return t.skinName=UISkinName.JoinInRoomPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this._labelList=new Array;for(var n=1;6>=n;n++)this._labelList.push(this["label"+n.toString()]),this.labelGroup.addChild(this["label"+n.toString()]);this._btnList=new Array;for(var n=0;9>=n;n++)this._btnList.push(this["numBtn"+n.toString()])},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.resetLabel()},t.prototype.resetLabel=function(){for(var e=0,t=this._labelList;e<t.length;e++){var n=t[e];n.refresh()}},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),RoomManager.reqJoinRoomEA.addListener(this.onJoinRoomResult,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandler,this),RoomManager.reqJoinRoomEA.removeListener(this.onJoinRoomResult)},t.prototype.onClickHandler=function(e){SoundManager.playButtonEffect(e.target);var t=this._btnList.indexOf(e.target);if(t>=0){var n=this.getUnWriteLabel();n&&(n.refresh(t),this.tryJoinRoom(!1))}else switch(e.target){case this.reLoseBtn:this.resetLabel();break;case this.delBtn:var i=this.getWirteLabel();i&&i.refresh()}},t.prototype.tryJoinRoom=function(e){if(this.getUnWriteLabel()&&e)return void UIManager.showFloatTips("房间号码位数不对！");var t=this.getRoomNum();if(t.length>5){var n=parseInt(t);if(0>=n||n.toString().length<6)return void UIManager.showFloatTips("房间号码不对！");RoomManager.reqJoinRoom(n,SocketManager.requestSessionMax)}},t.prototype.getUnWriteLabel=function(){for(var e,t=0;t<this._labelList.length;t++)if(e=this._labelList[t],e.label1&&!e.label1.text)return e;return null},t.prototype.getWirteLabel=function(){for(var e,t=this._labelList.length-1;t>=0;t--)if(e=this._labelList[t],e.label1&&e.label1.text)return e;return null},t.prototype.getRoomNum=function(){for(var e=StringConstant.empty,t=0;t<this._labelList.length;t++)e+=this._labelList[t].label1.text;return e},t.prototype.onJoinRoomResult=function(){RoomManager.roomInfo&&(UIManager.showFloatTips(StringUtil.format("加入房间成功！房间号：{0}",RoomManager.roomInfo.roomId)),SceneManager.goToGame(!0)),this.onCloseBtnClickHandler(null)},t}(BasePanel);__reflect(JoinInRoomPanel.prototype,"JoinInRoomPanel");var KeyBoardPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.KeyBoardPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.maskAlpha=.1,this._btnList=new Array;for(var n=0;9>=n;n++)this._btnList.push(this["numBtn"+n.toString()])},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.isbgNotCanClick=!1,this.isNotHasMask=!1,this.searchLabelFlag="",1==this.panelData.isbgNotCanClick&&(this.isbgNotCanClick=!0),1==this.panelData.isNotHasMask&&(this.isNotHasMask=!0),this.isNotHasMask?this.setGrayMask(!1):this.setGrayMask(!0),this.panelData.searchLabelFlag&&(this.searchLabelFlag=this.panelData.searchLabelFlag),egret.Tween.removeTweens(this.anmGroup);var n=egret.Tween.get(this.anmGroup);this.anmGroup.y=1286,n.to({y:816},200)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.keyboardClickHandler,this),PlayingFieldManager.onCloseKeyboardEvent.addListener(this.immediatelyClose,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.keyboardClickHandler,this),PlayingFieldManager.onCloseKeyboardEvent.removeListener(this.immediatelyClose)},t.prototype.immediatelyClose=function(){this.anmGroup.y=1286,UIManager.closePanel(UIModuleName.KeyBoardPanel)},t.prototype.outAnime=function(){var e=egret.Tween.get(this.anmGroup);this.anmGroup.y=816,e.to({y:1286},200).call(this.onCloseAnmComplete,this)},t.prototype.onCloseAnmComplete=function(){UIManager.closePanel(UIModuleName.KeyBoardPanel)},t.prototype.keyboardClickHandler=function(e){SoundManager.playButtonEffect(e.target),this.type=-1;var t=this._btnList.indexOf(e.target);if(t>=0)this.type=1,this.panelData.callback&&(this.panelData.target?this.searchLabelFlag?this.panelData.callback.call(this.panelData.target,this.type,this.searchLabelFlag,t.toString()):this.panelData.callback.call(this.panelData.target,this.type,t.toString()):this.searchLabelFlag?this.panelData.callback(this.type,this.searchLabelFlag,t.toString()):this.panelData.callback(this.type,t.toString()));else{switch(e.target){case this.resetBtn:this.type=3;break;case this.delBtn:this.type=2;break;case this.anmGroup:break;case this.bgImg:break;default:this.type=4,this.isbgNotCanClick||this.outAnime()}this.panelData.callback&&(this.panelData.target?this.searchLabelFlag?this.panelData.callback.call(this.panelData.target,this.type,this.searchLabelFlag):this.panelData.callback.call(this.panelData.target,this.type):this.searchLabelFlag?this.panelData.callback(this.type,this.searchLabelFlag):this.panelData.callback(this.type))}},t}(BasePanel);__reflect(KeyBoardPanel.prototype,"KeyBoardPanel");var LoadingPanel=function(e){function t(){var t=e.call(this)||this;return t._timeStamp=0,t.maskAlpha=.01,t.skinName=UISkinName.LoadingPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.isTween=!1,e.prototype.onAwake.call(this,t)},t.prototype.init=function(e){this._allowTimeout=!0,e&&(this._allowTimeout=e),this._time=egret.getTimer(),this._isOut=!1},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.loading.play(),this.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.loading.pause(),this.removeEventListener(egret.Event.ENTER_FRAME,this.update,this)},t.prototype.update=function(e){if(this._allowTimeout&&0==this._isOut){var t=egret.getTimer()-this._time;t>=ProjectDefined.GetInstance().getValue(ProjectDefined.onTimeOut)&&(this._isOut=!0,UIManager.closePanel(UIModuleName.LoadingPanel),UIManager.dispatchEvent(UIModuleName.LoadingPanel,UIModuleEvent.OnTimeout))}},t}(BasePanel);__reflect(LoadingPanel.prototype,"LoadingPanel");var LoadingSwitchPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.LoadingSwitchPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t);var n=RES.getRes(MovieClipData.SaiZi_Json),i=RES.getRes(MovieClipData.SaiZi_Png);this._mcFactory=new egret.MovieClipDataFactory(n,i),this._saiziMc=new egret.MovieClip(this._mcFactory.generateMovieClipData()),this.mcGroup.addChild(this._saiziMc),this._saiziMc.play()},t.prototype.init=function(t){e.prototype.init.call(this,t),this.updateProgress(0,StringConstant.empty),t&&this.updateProgress(t.value,t.info),this.loading.play()},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this._saiziMc.addEventListener(egret.Event.COMPLETE,this.onPlayComplete,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this._saiziMc.removeEventListener(egret.Event.COMPLETE,this.onPlayComplete,this),this.loading.pause()},t.prototype.onPlayComplete=function(e){this._saiziMc.gotoAndPlay(1)},t.prototype.updateProgress=function(e,t){this.isLoadComplete&&e},t}(BasePanel);__reflect(LoadingSwitchPanel.prototype,"LoadingSwitchPanel");var LoginBar=function(e){function t(){var t=e.call(this)||this;return t.isTween=!0,t.skinName=UISkinName.LoginBar,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t);var n=t;if(null!=n.ServerList&&n.ServerList.length>0){if(n.LastSId>0)for(var i=0;i<n.ServerList.length;i++){var a=n.ServerList[i];if(a.id==n.LastSId){this._serverInfo=a;break}}if(null==this._serverInfo){for(var i=n.ServerList.length-1;i>=0;i--){var a=n.ServerList[i];if(0==a.isMaintain){this._serverInfo=a;break}}null==this._serverInfo&&(this._serverInfo=n.ServerList[n.ServerList.length-1])}}ChannelLoginType.IsViewAccount(ChannelManager.loginType)&&(this.accountLabel.text=LoginManager.account)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.switchAccountButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchClickHandler,this),this.enterBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.enterClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.switchAccountButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchClickHandler,this),this.enterBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.enterClickHandler,this)},t.prototype.switchClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.dispatchEvent(UIModuleName.LoginBar,UIModuleEvent.CHANGE)},t.prototype.enterClickHandler=function(t){SoundManager.playButtonEffect(t.target),UIManager.dispatchEvent(UIModuleName.LoginBar,UIModuleEvent.COMPLETE,this._serverInfo),e.prototype.onCloseBtnClickHandler.call(this,t)},t}(BasePanel);__reflect(LoginBar.prototype,"LoginBar");var LoginLocalPanel=function(e){function t(){var t=e.call(this)||this;return t.isTween=!0,t.skinName=UISkinName.LoginLocalPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.accountLabel.type=egret.TextFieldType.INPUT,this.pwdLabel.type=egret.TextFieldType.INPUT,this.pwdLabel.inputType=egret.TextFieldInputType.PASSWORD,this.accountLabel.text=PrefsManager.getValue(PrefsManager.Login_Account),this.pwdLabel.text=PrefsManager.getValue(PrefsManager.Login_Password)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.loginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.loginHandler,this),this.registerBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.registerHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.loginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.loginHandler,this),this.registerBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.registerHandler,this)},t.prototype.loginHandler=function(e){var t=this.accountLabel.text.trim(),n=this.pwdLabel.text.trim();return SoundManager.playButtonEffect(e.target),t&&n?(this.onCloseBtnClickHandler(e),void ChannelManager.DispatchAccountLoginSucceed(t,n,!1)):void AlertManager.showSingleAlert("您的账号或密码为空，请重新输入！")},t.prototype.registerHandler=function(e){SoundManager.playButtonEffect(e.target),this.onCloseBtnClickHandler(e),UIManager.showPanel(UIModuleName.RegisterPanel)},t}(BasePanel);__reflect(LoginLocalPanel.prototype,"LoginLocalPanel");var LoginPanel=function(e){function t(){var t=e.call(this)||this;return t.setGrayMask(!1),t.skinName=UISkinName.LoginPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.isTween=!1,e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t);var n=ChannelLoginType.GetChannelLoginList(!1,VersionManager.isSafe,ChannelManager.operatePlatform,ChannelManager.channelType);this.agreeCheckBox.selected=!0,GameSetting.IsAgreeUserAgreement=this.agreeCheckBox.selected;for(var i=0,a=n;i<a.length;i++){var o=a[i];o==ChannelLoginType.Guest?(this.guestLoginBtn.visible=!0,this.guestLoginBtn.includeInLayout=!0):o==ChannelLoginType.IntranetAccount?(this.intranetAccountBtn.visible=!0,this.intranetAccountBtn.includeInLayout=!0):o==ChannelLoginType.Weixin?(this.weixinLoginBtn.visible=!0,this.weixinLoginBtn.includeInLayout=!0):o==ChannelLoginType.Account?(this.accountBtn.visible=!0,this.accountBtn.includeInLayout=!0):o==ChannelLoginType.IntranetGuest&&(this.intranetGuestBtn.visible=!0,this.intranetGuestBtn.includeInLayout=!0)}},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.weixinLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.weixinClickHandler,this),this.guestLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.guestLoginClickHandler,this),this.intranetAccountBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.intranetAccountClickHandler,this),this.userBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.userBtnClickHandler,this),this.accountBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.accountBtnClickHandler,this),this.intranetGuestBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.intranetGuestBtnClickHandler,this),this.agreeCheckBox.addEventListener(egret.TouchEvent.TOUCH_TAP,this.agreeCheckBoxClickHandler,this),UIManager.addEventListener(UIModuleName.UserAngreementPanel,UIModuleEvent.CHANGE,this.outAngree,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.weixinLoginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.weixinClickHandler,this),this.guestLoginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.guestLoginClickHandler,this),this.intranetAccountBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.intranetAccountClickHandler,this),this.userBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.userBtnClickHandler,this),this.accountBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.accountBtnClickHandler,this),this.intranetGuestBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.intranetGuestBtnClickHandler,this),this.agreeCheckBox.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.agreeCheckBoxClickHandler,this),UIManager.removeEventListener(UIModuleName.UserAngreementPanel,UIModuleEvent.CHANGE,this.outAngree)},t.prototype.guestLoginClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.dispatchEvent(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.Guest)},t.prototype.accountBtnClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.dispatchEvent(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.Account)},t.prototype.intranetGuestBtnClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.dispatchEvent(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.IntranetGuest)},t.prototype.intranetAccountClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.dispatchEvent(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.IntranetAccount)},t.prototype.weixinClickHandler=function(e){SoundManager.playButtonEffect(e.target),GameSetting.IsAgreeUserAgreement?ChannelManager.hasWeixin?UIManager.dispatchEvent(UIModuleName.LoginPanel,UIModuleEvent.COMPLETE,ChannelLoginType.Weixin):UIManager.showFloatTips("请安装微信后重启本游戏！"):UIManager.showFloatTips("用户必须同意用户协议才可进行登录！")},t.prototype.userBtnClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.showPanel(UIModuleName.UserAngreementPanel)},t.prototype.agreeCheckBoxClickHandler=function(e){SoundManager.playButtonEffect(e.target),GameSetting.IsAgreeUserAgreement=this.agreeCheckBox.selected},t.prototype.outAngree=function(){this.agreeCheckBox.selected=!0,GameSetting.IsAgreeUserAgreement=this.agreeCheckBox.selected},t}(BasePanel);__reflect(LoginPanel.prototype,"LoginPanel");var LoginSceneBgPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.LoginSceneBgPanel,t}return __extends(t,e),t.prototype.onRender=function(t){egret.ExternalInterface.call(ExtFuncName.SwitchToGame,"message load res complete"),e.prototype.onRender.call(this,t)},t}(BasePanel);__reflect(LoginSceneBgPanel.prototype,"LoginSceneBgPanel");var MailPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.MailPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.isCloseButtonTween=!1},t.prototype.init=function(t){e.prototype.init.call(this,t);var n=new Array("系统邮箱","系统通知","私人邮箱");this.tab.init(n),UIUtil.listRenderer(this.mailList,this.mailScroller,MailItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),MailManager.RequestMailList(0,GameSetting.MaxMailNum),MailManager.isRequestingFirstComplete=!0},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.tab.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBarItemTap,this),MailManager.getMailListEvent.addListener(this.getMailList,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.tab.tabBar.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onBarItemTap,this),MailManager.clearList()},t.prototype.getMailList=function(){this.refreshUI()},t.prototype.refreshUI=function(){this.mailList.dataProvider=new eui.ArrayCollection(MailManager.mailList)},t.prototype.onBarItemTap=function(e){this.mailList.dataProvider=new eui.ArrayCollection(MailManager.getListByType(e.itemIndex))},t}(BasePanel);__reflect(MailPanel.prototype,"MailPanel");var MarqueePanel=function(e){function t(){var t=e.call(this)||this;return t.isTween=!1,t.panelAlignType=PanelAlignType.Center_Top,t.offsetV=200,t.layer=UILayerType.Tips,t.setTouchChildren(!1),t.setTouchEnable(!1),t.setGrayMask(!1),t.skinName=UISkinName.MarqueePanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.scroller.viewport=this.textGroup,e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),egret.Tween.removeTweens(this.scroller.viewport),t&&(this.textLabel.text=t)},t.prototype.onRender=function(t){ChatManager.isOnMessage=!0,this.move=new egret.Tween(this.scroller.viewport,null,null);var n=20*this.textLabel.textWidth,i=this.textLabel.textWidth;this.scroller.viewport.scrollH=-620,1e4>n&&(n=1e4),this.move.to({scrollH:i},n).call(this.onTweenGroupComplete,this),this.move.play(),e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),UIUtil.hideScrollerBar(this.scroller,!0,!0),this.panelData||(UIManager.showFloatTips("跑马灯内容为空！"),this.onTweenGroupComplete())},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),ChatManager.isOnMessage=!1,egret.Tween.removeTweens(this.scroller.viewport)},t.prototype.onTweenGroupComplete=function(){egret.Tween.removeTweens(this.textGroup),this.onCloseBtnClickHandler(null),ChatManager.nextMessage()},t}(BasePanel);__reflect(MarqueePanel.prototype,"MarqueePanel");var OnceResultPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.OnceResultPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.resultGroup.layout=UIUtil.getVTileLayout(-6,1,egret.VerticalAlign.TOP)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.anteLabel.text="底分："+RoomManager.roomInfo.ante;var n=ProjectDefined.GetInstance().getPlayWayDefinition(RoomManager.roomInfo.type);if(n&&(this.anteLabel.text+="  "+n.des),this.roundNumLabel.text="第"+RoomManager.roomInfo.roundNum+"/"+RoomManager.roomInfo.round+"局",UIUtil.bindRender(this.resultGroup,OnceResultItemRenderer,GoCardProcessManager.onceResultInfoList),this.winImg.visible=!1,this.loseImg.visible=!1,this.liuJuImg.visible=!1,GoCardProcessManager.onceResultInfoList&&GoCardProcessManager.onceResultInfoList.length>0){for(var i=void 0,a=GoCardProcessManager.onceResultInfoList.length,o=0;a>o&&(i=GoCardProcessManager.onceResultInfoList[o],!RoomManager.mineInfo||i.roleId!=RoomManager.mineInfo.roleId);o++);i&&(i.huType==HuResultType.LiuJu?this.liuJuImg.visible=!0:i.currScore>-1?(this.winImg.visible=!0,SoundManager.playEffect(Sex.Male,MusicAction.win)):(this.loseImg.visible=!0,SoundManager.playEffect(Sex.Male,MusicAction.lost)))}else this.winImg.visible=!0;this.exitBtn.visible=!1,this.goOnBtn.visible=!1,this.gameOverBtn.visible=!1,RoomManager.roomInfo.roundNum==RoomManager.roomInfo.round?this.gameOverBtn.visible=!0:this.exitBtn.visible=this.goOnBtn.visible=!0},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.exitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.exitClickHandler,this),this.goOnBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goOnClickHandler,this),this.gameOverBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goOnClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.exitBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.exitClickHandler,this),this.goOnBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goOnClickHandler,this),this.gameOverBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goOnClickHandler,this)},t.prototype.exitClickHandler=function(e){SoundManager.playButtonEffect(e.target),RoomManager.reqExitRoom()},t.prototype.goOnClickHandler=function(e){SoundManager.playButtonEffect(e.target),GoCardProcessManager.reqGoOnGame()},t}(BasePanel);__reflect(OnceResultPanel.prototype,"OnceResultPanel");var PayPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.PayPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this._ly=UIUtil.getHTileLayout(30,1,egret.HorizontalAlign.LEFT),this.list.layout=this._ly,UIUtil.listRenderer(this.list,this.scroller,PayPanelItemRenderer,ScrollViewDirection.Horizontal_L_R),this.scroller.scrollPolicyV=eui.ScrollPolicy.OFF;var n=TextDefined.GetInstance().getDefinition(TextId.RoomCard,TextDefined.GetInstance().textList);n?this.roomCardInfoLabel.text=n.text:this.roomCardInfoLabel.text=StringConstant.empty,n=TextDefined.GetInstance().getDefinition(TextId.Info,TextDefined.GetInstance().textList),n?this.serverLabel.text=n.text:this.serverLabel.text=StringConstant.empty,e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this._dp||(this._dp=new eui.ArrayCollection),this.list.visible=!1,this.refreshUI()},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),PayManager.buyOverAction.addListener(this.refreshUI,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onPayClickHandler,this),UIUtil.hideScrollerBar(this.scroller)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),PayManager.buyOverAction.removeListener(this.refreshUI),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onPayClickHandler,this)},t.prototype.onPayClickHandler=function(e){if(SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.list.selectedItem)if(this.list.selectedItem.definition.get){if(this.list.selectedItem.dayCount>=this.list.selectedItem.definition.limit)return void UIManager.showFloatTips("今日购买次数已达上限！");AlertManager.showAlertObj({message:StringUtil.format("是否花费{0}元，购买{1}张房卡？",this.list.selectedItem.definition.price,this.list.selectedItem.definition.get),OnConfirm:this.tryPay,confirmParam:this.list.selectedItem,isSingle:!1})}else AlertManager.showAlertObj({message:StringUtil.format("是否花费{0}元，开通会员？",this.list.selectedItem.definition.price),OnConfirm:this.tryPay,confirmParam:this.list.selectedItem,isSingle:!1})},t.prototype.tryPay=function(e){console.log(555)},t.prototype.refreshUI=function(e){var t=PayManager.getPayInfoByPrice(e);if(t)if(t.id==VipCard.WeekVip||t.id==VipCard.MonthVip){var n=VipManager.GetVipTime(),i=new Date(1e3*n);AlertManager.showAlertObj({message:StringUtil.format("您购买{0}成功，限期至{1}，您将享受创建房间免房卡等多种福利。",t.definition.name,DateTimeUtil.formatDate(i,DateTimeUtil.Format_China_NoSecond)),subTitle:"购买成功",OnConfirm:this.GotoWaelthPanel,confirmParam:this.list.selectedItem,isSingle:!1})}else{var a=StringUtil.format("你花费了{0}元，购买了{1}张房卡！",e,t.definition.get);UIManager.showFloatTips(a)}this._dp=new eui.ArrayCollection(PayManager.payList),this.list.dataProvider=this._dp,this.list.visible=!0},t.prototype.GotoWaelthPanel=function(){UIManager.showPanel(UIModuleName.VipPanel)},t}(BasePanel);__reflect(PayPanel.prototype,"PayPanel");var PlayingFieldPanel=function(e){function t(){var t=e.call(this)||this;return t.blindIsUpSort=!0,t.playNumIsUpSort=!0,t.roomIdIsUpSort=!0,t.buyIsUpSort=!0,t.skinName=UISkinName.PlayingFieldPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this._ly=UIUtil.getVTileLayout(1,1,egret.VerticalAlign.TOP),this.list.layout=this._ly,UIUtil.listRenderer(this.list,this.scroller,PlayingFieldItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),this.scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.searchLable.type=egret.TextFieldType.INPUT,this.playingFieldTabCompontent.init(["初级场","中级场","高级场"])},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.searchLable.text="",this.roomInfoList=new Array,this.setRoomListInfo()},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRoomClickHandler,this),this.searchLable.addEventListener(egret.TouchEvent.FOCUS_IN,this.showKeyboard,this),this.playingFieldTabCompontent.tabBar.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTabClickHandler,this),PlayingFieldManager.onGetRoomListEvent.addListener(this.setRoomListInfo,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onRoomClickHandler,this),this.searchLable.removeEventListener(egret.TouchEvent.FOCUS_IN,this.showKeyboard,this),this.playingFieldTabCompontent.tabBar.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.onTabClickHandler,this),PlayingFieldManager.onGetRoomListEvent.removeListener(this.setRoomListInfo)},t.prototype.onTabClickHandler=function(e){0==e.itemIndex?UIManager.showFloatTips("1"):1==e.itemIndex?UIManager.showFloatTips("2"):UIManager.showFloatTips("3")},t.prototype.setRoomListInfo=function(){var e=new PlayingFieldRoomInfo;e.pattern=1,e.id=1,e.maxPlayer=5,e.player=4,e.smallBlind=5,e.bigBlind=10,e.minBuy=200,e.maxBuy=2e3,e.tax=1,e.type=1;var t=new PlayingFieldRoomInfo;t.pattern=0,t.id=2,t.maxPlayer=4,t.player=4,t.smallBlind=25,t.bigBlind=50,t.minBuy=1e3,t.maxBuy=1e4,t.tax=10,t.type=1;var n=new PlayingFieldRoomInfo;n.pattern=2,n.id=3,n.maxPlayer=3,n.player=2,n.smallBlind=25,n.bigBlind=50,n.minBuy=1e3,n.maxBuy=1e4,n.tax=10,n.type=11;var i=new PlayingFieldRoomInfo;if(i.pattern=3,i.id=33333,i.maxPlayer=3,i.player=2,i.smallBlind=25,i.bigBlind=50,i.minBuy=1e3,i.maxBuy=1e4,i.tax=10,i.type=11,PlayingFieldManager.roomList=new Array,PlayingFieldManager.roomList.push(e),PlayingFieldManager.roomList.push(t),PlayingFieldManager.roomList.push(n),PlayingFieldManager.roomList.push(i),PlayingFieldManager.roomList.length>0)for(var a=0,o=PlayingFieldManager.roomList;a<o.length;a++){var r=o[a];this.roomInfoList.push(r)}this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindUpSort)),this.list.dataProvider=this._dp},t.prototype.showKeyboard=function(){UIManager.showPanel(UIModuleName.KeyBoardPanel,{callback:this.searchRoom,target:this})},t.prototype.roomIdSort=function(){this.roomIdIsUpSort?this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.roomIdUpSort)):this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.roomIdDownSort)),this.roomIdIsUpSort=!this.roomIdIsUpSort,this.refreshUI()
},t.prototype.playerNumSort=function(){this.playNumIsUpSort?this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.roomPlayNumUpSort)):this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.roomPlayNumDownSort)),this.playNumIsUpSort=!this.playNumIsUpSort,this.refreshUI()},t.prototype.blindSort=function(){this.blindIsUpSort?this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindUpSort)):this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindDownSort)),this.blindIsUpSort=!this.blindIsUpSort,this.refreshUI()},t.prototype.buySort=function(){this.buyIsUpSort?this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindUpSort)):this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindDownSort)),this.buyIsUpSort=!this.buyIsUpSort,this.refreshUI()},t.prototype.refreshUI=function(){this.list.dataProvider=this._dp},t.prototype.clickHandler=function(e){switch(e.target){case this.roomIdLable:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.roomIdSort();break;case this.playerNumLable:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.playerNumSort();break;case this.blindLable:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.blindSort();break;case this.buyLable:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.buySort();break;case this.startGameBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),UIManager.showFloatTips("快速加入游戏");break;case this.createPrivateRoomBtn:SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.createPrivateRoom()}},t.prototype.createPrivateRoom=function(){VipManager.isVip()?UIManager.showPanel(UIModuleName.CreateRoomPwdPanel):AlertManager.showDoubleAlert("私人房仅对VIP开放，您现在还不是VIP，是否马上开通？",this.openShoppingPanel)},t.prototype.searchRoom=function(e,t){if(1==e)this.searchLable.text.length<5&&(this.searchLable.text=this.searchLable.text+t);else if(2==e)this.searchLable.text.length>0&&(this.searchLable.text=this.searchLable.text.slice(0,this.searchLable.text.length-1));else{if(3!=e)return;this.searchLable.text=""}var n=this.searchLable.text;if(n.length>0){var i=new Array;if(PlayingFieldManager.roomList.length>0){for(var a=0,o=PlayingFieldManager.roomList;a<o.length;a++){var r=o[a];(Array(5).join("0")+r.id).slice(-5).toString().indexOf(n)>=0&&i.push(r)}this._dp=new eui.ArrayCollection(i.sort(SortUtil.blindUpSort))}}else this._dp=new eui.ArrayCollection(this.roomInfoList.sort(SortUtil.blindUpSort));this.refreshUI()},t.prototype.onRoomClickHandler=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick),this.list.selectedItem&&(UserManager.userInfo.gold>=this.list.selectedItem.minBuy?11==this.list.selectedItem.type?(PlayingFieldManager.roomId=this.list.selectedItem.id,UIManager.showPanel(UIModuleName.EnterRoomPwdPanel)):UIManager.showFloatTips("发送加入房间请求"+this.list.selectedItem.id):AlertManager.showDoubleAlert("提示：金币不足，是否花费648购买1200万金币？",this.openShoppingPanel))},t.prototype.openShoppingPanel=function(){UIManager.showPanel(UIModuleName.ShoppingPanel),UIManager.closePanel(UIModuleName.PlayingFieldPanel)},t}(BackHomeAnimePanel);__reflect(PlayingFieldPanel.prototype,"PlayingFieldPanel");var RegisterPanel=function(e){function t(){var t=e.call(this)||this;return t._isMaskClickClose=!0,t.skinName=UISkinName.RegisterPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.accountLabel.type=egret.TextFieldType.INPUT,this.pwdLabel.type=egret.TextFieldType.INPUT,this.pwdLabel.inputType=egret.TextFieldInputType.PASSWORD},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.registerBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.registerClickHandler,this),this.backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.registerBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.registerClickHandler,this),this.backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.backClickHandler,this)},t.prototype.registerClickHandler=function(e){SoundManager.playButtonEffect(e.target);var t=this.accountLabel.text.trim(),n=this.pwdLabel.text.trim();t&&n&&(ChannelManager.DispatchAccountLoginSucceed(t,n,!0),this.onCloseBtnClickHandler(e))},t.prototype.backClickHandler=function(e){SoundManager.playButtonEffect(e.target),UIManager.showPanel(UIModuleName.LoginLocalPanel),this.onCloseBtnClickHandler(e)},t}(BasePanel);__reflect(RegisterPanel.prototype,"RegisterPanel");var AwardManager=function(){function e(){}return e.Initialize=function(t){e.Reset();var n=t.data.DataList;if(n)for(var i,a=0;a<n.length;a++){i=n[a];var o=parseInt(i.Id);e._map.containsKey(o)&&(e._map[o].times=parseInt(i.Count),null!=i.Time?e._map[o].lastTimes=parseInt(i.Time):e._map[o].lastTimes=0)}},e.OnExchangeNotifyFromServer=function(t){var n,i=parseInt(t.data.Id);e._map.getValue(i)&&(n=e._map.getValue(i),n.times=parseInt(t.data.Count),n.lastTimes=TimeManager.GetServerUtcTimestamp()),e.OnAwardValueChanged.dispatch()},e.Exchange=function(t,n,i){void 0===n&&(n=1),void 0===i&&(i=!0);var a=e.GetNotFitErrorType(t);return a!=AwardExchangeErrorType.NoError?void egret.log("[兑换错误，错误id]："+a.toString()):(SocketManager.AddCommandListener(Command.Exchange_3113,function(n){SocketManager.RemoveCommandListener(Command.Exchange_3113,e.OnExchangeNotifyFromServer),this.OnExchangeFromServer(t,i)},this),i&&PropertyManager.OpenGet(),1>n&&(n=1),void SocketManager.Send(Command.Exchange_3113,{Id:t,Count:n}))},e.prototype.OnExchangeFromServer=function(t,n){var i=null;e._map.containsKey(t)&&(i=e._map[t],e.OnExchanged.dispatch(i)),n&&PropertyManager.ShowItemList()},e.GetNotFitErrorType=function(t){var n=AwardExchangeErrorType.NoError,i=e.GetExchangeInfo(t);i||(n|=AwardExchangeErrorType.NullAward);var a=e.GetAwardLimit(t);0!=a&&i.times>=a&&(n|=AwardExchangeErrorType.OverTimes);TimeManager.GetServerLocalDateTime();if(i.definition.level>UserManager.userInfo.level&&(n|=AwardExchangeErrorType.LevelNotEnough),!AwardDefined.GetInstance().getPrevIdIsNull(t)){var o=e.GetExchangeInfo(i.definition.preId);a=e.GetAwardLimit(i.definition.preId),o.times<a&&(n|=AwardExchangeErrorType.PreNotComplete)}return n},e.GetAwardDiamondCost=function(e){var t=AwardDefined.GetInstance().getAwardDefinition(e);return t&&StringUtil.isNullOrEmpty(t.costName)?t.costNum:void 0},e.IsToLimitClient=function(t){var n=e.GetAwardLimit(t),i=e.GetTimes(t);return i>=n&&0!=n?!0:!1},e.GetTimes=function(t){var n=e.GetExchangeInfo(t);return n?n.times:0},e.GetAwardLimit=function(e){var t=AwardDefined.GetInstance().getAwardDefinition(e);return t?StringUtil.isNullOrEmpty(t.costName)?t.limit:0:void 0},e.GetLastAlterDate=function(t){var n=e.GetExchangeInfo(t);return n?n.lastTimes:0},e.GetExchangeInfo=function(t){var n;return e._map.getValue(t)?n=e._map.getValue(t):null},e.IsCanExchange=function(t){var n=AwardDefined.GetInstance().getAwardDefinition(t);return n?e.HaveDefinitionCount(n):!1},e.HaveDefinitionCount=function(t){return e.VerifyCount(t.costId,t.costNum)},e.VerifyCount=function(e,t){if(e==PropertyId.diamond){if(UserManager.userInfo.diamond>=t)return!0}else if(e==PropertyId.gold&&UserManager.userInfo.gold>=t)return!0;return!1},e.Reset=function(){e._map.clear();for(var t=AwardDefined.GetInstance().awardDefinitionDic,n=void 0;n<t.getKeys.length;n++){var i=t.getKeys[n],a=new AwardTimesInfo;a.id=i,e._map.add(a.id,a)}},e}();AwardManager.OnExchanged=new ActionDispatcher,AwardManager.OnAwardValueChanged=new ActionDispatcher,AwardManager._map=new Dictionary,__reflect(AwardManager.prototype,"AwardManager");var AwardExchangeErrorType;!function(e){e[e.NoError=0]="NoError",e[e.NullAward=1]="NullAward",e[e.OverTimes=2]="OverTimes",e[e.OverDate=4]="OverDate",e[e.NotComeDate=8]="NotComeDate",e[e.LevelNotEnough=9]="LevelNotEnough",e[e.PreNotComplete=10]="PreNotComplete",e[e.NotInTime=12]="NotInTime"}(AwardExchangeErrorType||(AwardExchangeErrorType={}));var AwardInfoDefinition=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._definition=AwardDefined.GetInstance().getAwardDefinition(this._id)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),t}(BaseServerValueInfo);__reflect(AwardInfoDefinition.prototype,"AwardInfoDefinition");var RoomDisbandOperPanel=function(e){function t(){var t=e.call(this)||this;return t.layer=UILayerType.Tips,t.skinName=UISkinName.RoomDisbandOperPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.agreeImg.visible=!1,this.refuseImg.visible=!1,this.cancelBtn.visible=this.agreeBtn.visible=!0,this.onAgreeResult()},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t);var n;StringConstant.empty;if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList)for(var i=void 0,a=0;a<RoomManager.roomInfo.playerList.length;a++)if(i=RoomManager.roomInfo.playerList[a],i.quit==RoomQuitState.ReqQuit){n=i.name;break}var o=ProjectDefined.GetInstance().getValue(ProjectDefined.waitDisbandTime),r=Math.ceil(o/60);this.infoLabel.text="玩家"+n+"申请解散房间，请选择是否同意(超过"+r+"分钟未做选择，则默认同意)",this.showTime()},t.prototype.showTime=function(){var e=RoomManager.remainTimeStr;this.timeLabel.text=e,e||this.onCloseBtnClickHandler(null)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),Tick.getInstance().AddSecondsInvoke(this.showTime,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),RoomManager.pushVoteResultEa.addListener(this.onAgreeResult,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPanelClick,this),Tick.getInstance().RemoveSecondsInvoke(this.showTime),RoomManager.pushVoteResultEa.removeListener(this.onAgreeResult)},t.prototype.onPanelClick=function(e){switch(e.target){case this.cancelBtn:RoomManager.reqIsAgreeExitRoom(!1);break;case this.agreeBtn:RoomManager.reqIsAgreeExitRoom(!0)}},t.prototype.onAgreeResult=function(){this.agreeImg.visible=!1,this.refuseImg.visible=!1,RoomManager.mineInfo&&RoomManager.mineInfo.quit==RoomQuitState.Refuse?(this.refuseImg.visible=!0,this.cancelBtn.visible=this.agreeBtn.visible=!1):RoomManager.mineInfo&&RoomManager.mineInfo.quit==RoomQuitState.Argree&&(this.agreeImg.visible=!0,this.cancelBtn.visible=this.agreeBtn.visible=!1)},t.prototype.onCloseBtnClickHandler=function(t){e.prototype.onCloseBtnClickHandler.call(this,t)},t}(BasePanel);__reflect(RoomDisbandOperPanel.prototype,"RoomDisbandOperPanel");var RoundDetialsPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.RoundDetialsPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.infoList.itemRenderer=RoundDetialsItemRenderer,this.infoScroller.scrollPolicyH=eui.ScrollPolicy.OFF},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.infoList.visible=!1,this.refreshUI()},t.prototype.refreshUI=function(){this.infoList.visible=!0},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t}(BasePanel);__reflect(RoundDetialsPanel.prototype,"RoundDetialsPanel");var RoundInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.RoundInfoPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this._ly=UIUtil.getVTileLayout(5),this.listGroup.layout=this._ly,this.noneGroup.visible=!1,UIUtil.listRenderer(this.listGroup,this.listScroller,RoundUserListItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.listScroller.stopAnimation()},t.prototype.onRender=function(t){UIManager.showPanel(UIModuleName.LoadingPanel),this.listScroller.visible=!1,this.isEnterOver&&this.refreshUI(),e.prototype.onRender.call(this,t)},t.prototype.onEnterAnmComplete=function(){this.isLoadComplete&&this.refreshUI(),e.prototype.onEnterAnmComplete.call(this)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),UIUtil.hideScrollerBar(this.listScroller)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.listScroller&&this.listScroller.stopAnimation()},t.prototype.refreshUI=function(){UIManager.closePanel(UIModuleName.LoadingPanel)},t.prototype.showRoundDetials=function(){UIManager.showPanel(UIModuleName.RoundDetialsPanel)},t}(BaseAnmiatePanel);__reflect(RoundInfoPanel.prototype,"RoundInfoPanel");var SavePanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.SavePanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t);var n=new Array;n.push(this.saveGoldGroup),n.push(this.withdrawGroup),n.push(this.pwdGroup),this.SaveTab.init(n),this.setTips("")},t.prototype.init=function(t){e.prototype.init.call(this,t),this.refreshProperty(),parseInt(this.currentGold.text)>=1e4?this.saveScaleHs=Math.floor(parseInt(this.currentGold.text)/1e4):this.saveScaleHs=0,parseInt(this.saveGold.text)>=1e4?this.withdrawScaleHs=parseInt(this.saveGold.text)/1e4:this.withdrawScaleHs=0,this.saveGoldHs.value=0,this.saveGoldHs.maximum=this.saveScaleHs,this.withdrawGoldHs.value=0,this.withdrawGoldHs.maximum=this.withdrawScaleHs,this.withdrawPwd.restrict="0-9",void 0==UserManager.userInfo.isSafePwd||0==UserManager.userInfo.isSafePwd?AlertManager.showSingleAlert("尊贵的VIP用户，请先创建您的保险箱密码，创建后才可使用保险箱功能。",this.goPwdGroup.bind(this)):1==UserManager.userInfo.isSafePwd&&2==this.SaveTab.tabBar.selectedIndex&&2==this.SaveTab.viewStack.selectedIndex&&(this.modifyPwd_gp.visible=!0,this.createPwd_gp.visible=!1)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.saveGoldHs.addEventListener(egret.Event.CHANGE,this.importGoldHs,this),this.saveGoldHs.addEventListener(eui.UIEvent.CHANGE_START,this.unEnoughGold,this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.subBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.withdrawGoldHs.addEventListener(egret.Event.CHANGE,this.exportGoldHs,this),this.withdrawGoldHs.addEventListener(eui.UIEvent.CHANGE_START,this.unEnoughGold,this),this.withdrawAddBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.withdrawSubBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickHandle,this),this.addEventListener(egret.TouchEvent.FOCUS_IN,this.showKeyboard,this),SaveManager.PwdSuccessEvent.addListener(this.createPwdSuccessHandle),SaveManager.modifyPwdEvent.addListener(this.modifyPwdSuccessHandle),UserManager.propertyChangeEvent.addListener(this.refreshProperty)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.saveGoldHs.removeEventListener(egret.Event.CHANGE,this.importGoldHs,this),this.saveGoldHs.removeEventListener(eui.UIEvent.CHANGE_START,this.unEnoughGold,this),this.addBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.subBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.withdrawGoldHs.removeEventListener(egret.Event.CHANGE,this.exportGoldHs,this),this.withdrawGoldHs.removeEventListener(eui.UIEvent.CHANGE_START,this.unEnoughGold,this),this.withdrawAddBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.withdrawSubBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goldBtnHandle,this),this.removeEventListener(egret.TouchEvent.FOCUS_IN,this.showKeyboard,this),this.removeEventListener(egret.TouchEvent.FOCUS_IN,this.showKeyboard,this),SaveManager.PwdSuccessEvent.removeListener(this.createPwdSuccessHandle),UserManager.propertyChangeEvent.removeListener(this.refreshProperty)},t.prototype.goPwdGroup=function(){this.SaveTab.tabBar.selectedIndex=2,this.SaveTab.viewStack.selectedIndex=2,this.createPwd_gp.visible=!0,this.modifyPwd_gp.visible=!1},t.prototype.refreshProperty=function(){this.currentGold.text=UserManager.userInfo.gold.toString(),this.saveGold.text=UserManager.userInfo.safeGold.toString(),this.resetScaleHs()},t.prototype.createPwdSuccessHandle=function(){UIManager.showFloatTips("创建成功"),this.createPwd.text="",this.createAgainPwd.text="",this.createPwd_gp.visible=!1,this.modifyPwd_gp.visible=!0,this.pwdGroup.name="修改密码"},t.prototype.modifyPwdSuccessHandle=function(){UIManager.showFloatTips("密码修改成功"),this.oldPwd.text="",this.newPwd.text="",this.againPwd.text=""},t.prototype.onClickHandle=function(e){switch(e.target){case this.saveBtn:this.saveGoldHandler();break;case this.withdrawBtn:this.withdrawGoldHandler();break;case this.createPwdBtn:this.createPwdHandle();break;case this.modifyPwdBtn:this.modifyPwdHandle();break;default:UIManager.closePanel(UIModuleName.KeyBoardPanel)}},t.prototype.importGoldHs=function(){this.saveCount.text=this.saveGoldHs.value.toString()+"万"},t.prototype.saveGoldHandler=function(){if(0!=parseInt(this.saveCount.text)){var e=1e4*parseInt(this.saveCount.text);this.saveGoldHs.value=0,this.saveCount.text="0万",SaveManager.reqSaveWithdrawGold(e,1)}else UIManager.showFloatTips("不能存入0")},t.prototype.exportGoldHs=function(){this.withdrawCount.text=this.withdrawGoldHs.value.toString()+"万"},t.prototype.withdrawGoldHandler=function(){if(""==this.withdrawPwd.text)UIManager.showFloatTips("密码不能为空");else if(this.withdrawPwd.text.length<6)this.setTips("密码不能小于6位数字");else{if(0!=parseInt(this.withdrawCount.text)){var e=1e4*parseInt(this.withdrawCount.text);this.withdrawGoldHs.value=0,this.withdrawCount.text="0万",SaveManager.reqSaveWithdrawGold(e,2,parseInt(this.withdrawPwd.text))}else UIManager.showFloatTips("取出金额为空");this.setTips("")}},t.prototype.unEnoughGold=function(e){switch(e.target){case this.saveGoldHs:0==this.saveGoldHs.maximum&&UIManager.showFloatTips("当前可存金币不足一万");break;case this.withdrawGoldHs:0==this.withdrawGoldHs.maximum&&UIManager.showFloatTips("保险箱金币为0")}},t.prototype.goldBtnHandle=function(e){switch(e.target){case this.addBtn:this.saveGoldHs.value++;break;case this.subBtn:this.saveGoldHs.value--;break;case this.withdrawAddBtn:this.withdrawGoldHs.value++;break;case this.withdrawSubBtn:this.withdrawGoldHs.value--}this.saveGoldHs.value>this.saveGoldHs.maximum?this.saveGoldHs.value=this.saveGoldHs.maximum:this.withdrawGoldHs.value>this.withdrawGoldHs.maximum?this.withdrawGoldHs.value=this.withdrawGoldHs.maximum:this.saveGoldHs.value<0?this.saveGoldHs.value=0:this.withdrawGoldHs.value<0&&(this.withdrawGoldHs.value=0),this.importGoldHs(),this.exportGoldHs()},t.prototype.showKeyboard=function(e){this.setTips(""),this.inputType=e.target,UIManager.showPanel(UIModuleName.KeyBoardPanel,{callback:this.keyboardHandle,target:this,isNotHasMask:!0,searchLabelFlag:this.inputType})},t.prototype.keyboardHandle=function(e,t,n){if(1==e)t.text.length<6&&(t.text=t.text+n);else if(2==e)t.text.length>0&&(t.text=t.text.slice(0,t.text.length-1));else{if(3!=e)return;t.text=""}},t.prototype.resetScaleHs=function(){this.saveScaleHs=Math.floor(parseInt(this.currentGold.text)/1e4),this.saveGoldHs.maximum=this.saveScaleHs,this.withdrawScaleHs=parseInt(this.saveGold.text)/1e4,this.withdrawGoldHs.maximum=this.withdrawScaleHs},t.prototype.createPwdHandle=function(){if(this.createPwd.text.length<6)this.setTips("密码不能小于6位数字");else if(parseInt(this.createPwd.text)==parseInt(this.createAgainPwd.text)){var e=parseInt(this.createPwd.text);SaveManager.reqCreatePwd(e)}else this.setTips("*两次密码不一致")},t.prototype.modifyPwdHandle=function(){if(0==this.oldPwd.text.length||0==this.newPwd.text.length||0==this.againPwd.text.length)this.setTips("密码不能为空");else if(this.oldPwd.text.length<6||this.newPwd.text.length<6||this.againPwd.text.length<6)this.setTips("密码不能小于6位数字");else if(parseInt(this.newPwd.text)!=parseInt(this.againPwd.text))this.setTips("新密码两次不一致");else{var e=parseInt(this.newPwd.text),t=parseInt(this.oldPwd.text);SaveManager.reqModifyPwd(e,t)}},t.prototype.setTips=function(e){this.tipPwd.text=e},t}(BackHomeAnimePanel);__reflect(SavePanel.prototype,"SavePanel");var SetPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.SetPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),null!=ProjectDefined.GetInstance().gameFeedback.forum?this.forum.text=ProjectDefined.GetInstance().gameFeedback.forum:this.forum.text=StringConstant.empty,null!=ProjectDefined.GetInstance().gameFeedback.QQ?this.QQ.text=ProjectDefined.GetInstance().gameFeedback.QQ:this.QQ.text=StringConstant.empty,null!=ProjectDefined.GetInstance().gameFeedback.customerService?this.customerService.text=ProjectDefined.GetInstance().gameFeedback.customerService:this.customerService.text=StringConstant.empty},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.bgSoundTog.selected=SoundManager.bgEnabled,this.soundEffectTog.selected=SoundManager.effectEnabled,this.shakeTog.selected=GameSetting.shakeEnabled},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.bgSoundTog.addEventListener(egret.Event.CHANGE,this.closeBgSoundHandler,this),this.soundEffectTog.addEventListener(egret.Event.CHANGE,this.closeSoundEffectHandler,this),this.reLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reLoginClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.bgSoundTog.removeEventListener(egret.Event.CHANGE,this.closeBgSoundHandler,this),this.soundEffectTog.removeEventListener(egret.Event.CHANGE,this.closeSoundEffectHandler,this),this.reLoginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reLoginClickHandler,this)},t.prototype.closeBgSoundHandler=function(e){SoundManager.playEffect(Sex.Female,MusicAction.buttonClick),SoundManager.bgEnabled=this.bgSoundTog.selected},t.prototype.closeSoundEffectHandler=function(e){SoundManager.playEffect(Sex.Female,MusicAction.buttonClick),SoundManager.effectEnabled=this.soundEffectTog.selected,PrefsManager.setBoolean(PrefsManager.Sound_Effect_Enable,this.soundEffectTog.selected)},t.prototype.reLoginClickHandler=function(e){GameManager.reLogin(SystemReenterType.Logout)},t}(BackHomeAnimePanel);__reflect(SetPanel.prototype,"SetPanel");var SettingPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.SettingPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){switch(e.prototype.init.call(this,t),this.disbandBtn.visible=!1,this.reLoginBtn.visible=!1,SceneManager._currentSceneType){case SceneType.Hall:this.reLoginBtn.visible=!0;break;case SceneType.Game:this.disbandBtn.visible=!0}},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.bgSoundHs.addEventListener(egret.Event.CHANGE,this.bgSoundChangeHandler,this),this.soundEffectHs.addEventListener(egret.Event.CHANGE,this.soundEffectChangeHandler,this),this.bgSoundTog.addEventListener(egret.Event.CHANGE,this.closeBgSoundHandler,this),this.soundEffectTog.addEventListener(egret.Event.CHANGE,this.closeSoundEffectHandler,this),this.disbandBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.disbandClickHandler,this),this.reLoginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reLoginClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.bgSoundHs.removeEventListener(egret.Event.CHANGE,this.bgSoundChangeHandler,this),this.soundEffectHs.removeEventListener(egret.Event.CHANGE,this.soundEffectChangeHandler,this),this.bgSoundTog.removeEventListener(egret.Event.CHANGE,this.closeBgSoundHandler,this),this.soundEffectTog.removeEventListener(egret.Event.CHANGE,this.closeSoundEffectHandler,this),this.disbandBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.disbandClickHandler,this),this.reLoginBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.reLoginClickHandler,this)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.soundEffectTog.selected=SoundManager.effectEnabled,this.bgSoundTog.selected=SoundManager.bgEnabled,this.bgSoundHs.value=10*SoundManager.bgVolume,this.soundEffectHs.value=10*SoundManager.effectVolume},t.prototype.bgSoundChangeHandler=function(e){SoundManager.bgVolume=this.bgSoundHs.value/10,PrefsManager.setNumber(PrefsManager.Sound_Bg_Volume,SoundManager.bgVolume),SoundManager.changeBgMusic(SoundManager.bgVolume)},t.prototype.soundEffectChangeHandler=function(e){SoundManager.effectVolume=this.soundEffectHs.value/10,PrefsManager.setNumber(PrefsManager.Sound_Effect_Volume,SoundManager.effectVolume)},t.prototype.closeBgSoundHandler=function(e){SoundManager.playEffect(Sex.Female,MusicAction.buttonClick),SoundManager.bgEnabled=this.bgSoundTog.selected,SoundManager.bgMusicOpen(SceneManager._currentSceneType)},t.prototype.closeSoundEffectHandler=function(e){SoundManager.playEffect(Sex.Female,MusicAction.buttonClick),SoundManager.effectEnabled=this.soundEffectTog.selected,PrefsManager.setBoolean(PrefsManager.Sound_Effect_Enable,this.soundEffectTog.selected),console.log(StringUtil.format("你{0}了音效！",SoundManager.effectEnabled?"开启":"关闭"))},t.prototype.disbandClickHandler=function(e){RoomManager.reqExitRoom()},t.prototype.reLoginClickHandler=function(e){GameManager.reLogin(SystemReenterType.Logout)},t}(BasePanel);__reflect(SettingPanel.prototype,"SettingPanel");var ShareGamePanel=function(e){function t(){var t=e.call(this)||this;return t._isMaskClickClose=!0,t.skinName=UISkinName.ShareGamePanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.weixinShareBtn:UIManager.showFloatTips("微信");break;case this.friendCircleShareBtn:UIManager.showFloatTips("朋友圈")}},t}(BasePanel);__reflect(ShareGamePanel.prototype,"ShareGamePanel");var ShoppingPanel=function(e){function t(){var t=e.call(this)||this;return t._isMaskClickClose=!0,t.skinName=UISkinName.ShoppingPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.gold_scroller.scrollPolicyH=eui.ScrollPolicy.OFF,this.diamond_scroller.scrollPolicyH=eui.ScrollPolicy.OFF,e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.gold_dp||(this.gold_dp=new eui.ArrayCollection),this.diamond_dp||(this.diamond_dp=new eui.ArrayCollection),this.vip_dp||(this.vip_dp=new eui.ArrayCollection);var n=new Array;n.push(this.goldGroup),n.push(this.diamondGroup),n.push(this.vipGroup),t&&null!=t.tab?this.shoppingTab.init(n,{enterTabindex:t.tab}):this.shoppingTab.init(n),UIUtil.listRenderer(this.goldList,this.gold_scroller,GoldListItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.diamondList,this.diamond_scroller,DiamondListItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),UIUtil.listRenderer(this.vipList,this.vip_scroller,VipListItemRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,null,!0),this.diamondNumLabel.text=MathUtil.formatNum(UserManager.userInfo.diamond),this.goldNumLabel.text=MathUtil.formatNum(UserManager.userInfo.gold)},t.prototype.onEnterAnmComplete=function(){this.isLoadComplete&&this.refreshUI(),e.prototype.onEnterAnmComplete.call(this)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.goldList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),this.diamondList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),this.vipList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),ShoppingManager.buyOverAction.addListener(this.refreshProperty,this),UIUtil.hideScrollerBar(this.gold_scroller),UIUtil.hideScrollerBar(this.diamond_scroller),UIUtil.hideScrollerBar(this.vip_scroller)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.goldList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),this.diamondList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),this.vipList.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.BuyClickHandler,this),ShoppingManager.buyOverAction.removeListener(this.refreshProperty)},t.prototype.changeActive=function(e){1==e.target.selected,e.target.selected!=this.activeBtnFlage&&(this.activeBtnFlage.selected=!1),this.activeBtnFlage=e.target},t.prototype.refreshUI=function(){this.gold_dp=new eui.ArrayCollection(ShoppingManager.goldList),this.goldList.dataProvider=this.gold_dp,this.diamond_dp=new eui.ArrayCollection(ShoppingManager.diamondList),this.diamondList.dataProvider=this.diamond_dp,this.vip_dp=new eui.ArrayCollection(ShoppingManager.vipList),this.vipList.dataProvider=this.vip_dp},t.prototype.refreshProperty=function(){this.diamondNumLabel.text=MathUtil.formatNum(UserManager.userInfo.diamond),this.goldNumLabel.text=MathUtil.formatNum(UserManager.userInfo.gold)},t.prototype.BuyClickHandler=function(e){SoundManager.playEffect(Sex.Male,MusicAction.buttonClick);var t;switch(e.target){case this.goldList:t=AwardDefined.GetInstance().getAwardDefinition(this.goldList.selectedItem.definition.awardId),AlertManager.showAlertObj({message:StringUtil.format("是否花费{0}元，购买{1}？",t.costNum,t.name),OnConfirm:this.tryPay,confirmParam:this.goldList.selectedItem,isSingle:!1});break;case this.diamondList:t=AwardDefined.GetInstance().getAwardDefinition(this.diamondList.selectedItem.definition.awardId),AlertManager.showAlertObj({message:StringUtil.format("是否花费{0}元，购买{1}？",t.costNum,t.name),OnConfirm:this.tryPay,confirmParam:this.diamondList.selectedItem,isSingle:!1});break;case this.vipList:t=AwardDefined.GetInstance().getAwardDefinition(this.vipList.selectedItem.definition.awardId),UserManager.userInfo.diamond>=t.costNum?AlertManager.showAlertObj({message:StringUtil.format("是否花费{0}钻石，购买{1}？",t.costNum,t.name),OnConfirm:this.tryPay,confirmParam:this.vipList.selectedItem,isSingle:!1}):AlertManager.showSingleAlert("您的钻石不足！",this.goDiamondGp.bind(this))}},t.prototype.goDiamondGp=function(){this.shoppingTab.tabBar.selectedIndex=ShoppingType.diamond,this.shoppingTab.viewStack.selectedIndex=ShoppingType.diamond},t.prototype.tryPay=function(e){e&&ChannelManager.PaySend(e.id)},t}(BackHomeAnimePanel);__reflect(ShoppingPanel.prototype,"ShoppingPanel");var TestPanel=function(e){function t(){var t=e.call(this)||this;return t.x=150,t.y=0,t.creatComponent(),t}return __extends(t,e),t.prototype.creatComponent=function(){this._testBtn||(this._testBtn=new eui.Button,this._testBtn.label="测试",this._testBtn.horizontalCenter=0,this._testBtn.verticalCenter=0,this._testBtn.skinName="buttonSkin22",this._testBtn.alpha=.3,this.addChild(this._testBtn)),this.addEvents()},t.prototype.addEvents=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this)},t.prototype.clickHandler=function(e){var t=e.target;switch(t){case this._testBtn:UserManager.reqSetUserInfo("老李","",1)}},t}(eui.Component);__reflect(TestPanel.prototype,"TestPanel");var TextInfoPanel=function(e){function t(){var t=e.call(this)||this;return t._txtCount=35,t.isMaskClickClose=!0,t._contentList=new Array,t.skinName=UISkinName.TextInfoPanel,t
}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){this._lastShowContainer?t==this.panelData?this._lastShowContainer.visible=!0:this._lastShowContainer.visible=!1:(this.txtList.visible=!1,this.txtGroup.visible=!1),e.prototype.init.call(this,t),this._def=TextDefined.GetInstance().getDefinition(this.panelData,TextDefined.GetInstance().textList),this.contentContainerOper()},t.prototype.contentContainerOper=function(){this._def&&(this._def.isRichTxt?this.txtGroupScroller.viewport=this.txtGroup:this.txtGroupScroller.viewport=this.txtList)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this._def?this.titleImg.source=this._def.url:this.titleImg.source=StringConstant.empty,this.txtGroupScroller.stopAnimation(),this.txtGroupScroller.viewport.scrollV=0},t.prototype.onEnterAnmComplete=function(){e.prototype.onEnterAnmComplete.call(this),UIUtil.hideScrollerBar(this.txtGroupScroller,!0,!1),this._def&&(this._def.isRichTxt?(this.txtLabel.textFlow=GameSetting.htmlParser.parser(this._def.text),this.txtGroup.visible=!0,this._lastShowContainer=this.txtGroup):(this.txtList.visible=!0,this._lastShowContainer=this.txtList,this.contentOper(),UIUtil.listRenderer(this.txtList,this.txtGroupScroller,TextRenderer,ScrollViewDirection.Vertical_T_D,eui.ScrollPolicy.ON,this._contentList,!0)))},t.prototype.contentOper=function(){ArrayUtil.Clear(this._contentList);var e=this._def.text,t="\n";if(-1==e.indexOf(t))this._contentList.push(e);else for(var n=0,i=StringConstant.empty,a=void 0;e.length>0;){if(n=e.indexOf(t),-1==n){this._contentList.push(e);break}if(a=e.slice(0,n+1),e=e.slice(n+1,e.length),a.length>this._txtCount)for(;a.length>0;)i=a.slice(0,this._txtCount)+t,this._contentList.push(i),a=a.substring(this._txtCount,a.length);else this._contentList.push(a)}},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t}(BaseAnmiatePanel);__reflect(TextInfoPanel.prototype,"TextInfoPanel");var TextTipsPanel=function(e){function t(){var t=e.call(this)||this;return t.layer=UILayerType.Tips,t.setTouchChildren(!1),t.setTouchEnable(!1),t.setGrayMask(!1),t.skinName=UISkinName.TextTipsPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t),this.panelData&&(this.label.text=this.panelData,this.removeTweenEvents(),this.createTween())},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.createTween=function(){this.alpha=1,this._disappearTween=new egret.Tween(this,null,null),this._disappearTween.wait(800).to({alpha:0},500,egret.Ease.quadOut).call(this.onPlayOver,this),this._disappearTween.play()},t.prototype.onPlayOver=function(e){this.onCloseBtnClickHandler(null),this._disappearTween=null},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeTweenEvents()},t.prototype.removeTweenEvents=function(){this._disappearTween&&(egret.Tween.removeTweens(this),this._disappearTween=null)},t}(BasePanel);__reflect(TextTipsPanel.prototype,"TextTipsPanel");var TingInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.isTween=!1,t.setGrayMask(!1),t.panelAlignType=PanelAlignType.Center_Bottom,t.offsetV=150,t.skinName=UISkinName.TingInfoPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){this.resultGroup.layout=UIUtil.getTileLayout(5,5,void 0,6,egret.HorizontalAlign.CENTER,egret.VerticalAlign.TOP),this.tweenGroup.touchEnabled=this.tweenGroup.touchChildren=!1,e.prototype.onAwake.call(this,t)},t.prototype.init=function(n){if(e.prototype.init.call(this,n),this.panelData){var i=this.panelData;if(i.listenerList.length>=GameSetting.MaxCardIndex-1)this.resultGroup.width=this.bgImg.width=165,this.resultGroup.height=this.bgImg.height=130,UIUtil.bindRender(this.resultGroup,TingRenderer,t._all);else{var a=i.listenerList.length;a>6&&(a=6),this.resultGroup.width=this.bgImg.width=170*a,this.resultGroup.height=this.bgImg.height=115*Math.ceil(i.listenerList.length/6)+15,UIUtil.bindRender(this.resultGroup,TingRenderer,i.listenerList)}}},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t)},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t)},t}(BasePanel);TingInfoPanel._all=[null],__reflect(TingInfoPanel.prototype,"TingInfoPanel");var UserAngreementPanel=function(e){function t(){var t=e.call(this)||this;return t.isMaskClickClose=!0,t.skinName=UISkinName.UserAngreementPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this._txtScroller=new eui.Scroller,this._txtScroller.width=442,this._txtScroller.height=446,this._txtScroller.viewport=this.txtGroup,this._txtScroller.x=54,this._txtScroller.y=82,this.tweenGroup.addChild(this._txtScroller)},t.prototype.init=function(t){e.prototype.init.call(this,t)},t.prototype.onTweenOver=function(){e.prototype.onTweenOver.call(this);var t=TextDefined.GetInstance().getDefinition(TextId.UserAngreement,TextDefined.GetInstance().textList);t&&(this.infoTxt.text||(this.infoTxt.visible=!1,this.infoTxt.text=t.text,this.infoTxt.visible=!0))},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this._txtScroller.stopAnimation(),this.agreeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.agreeBtnClickHandler,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.agreeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.agreeBtnClickHandler,this)},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),UIUtil.hideScrollerBar(this._txtScroller),this._txtScroller.viewport.scrollV=0,UIUtil.hideScrollerBar(this._txtScroller,!0)},t.prototype.agreeBtnClickHandler=function(t){GameSetting.IsAgreeUserAgreement=!0,UIManager.dispatchEvent(UIModuleName.UserAngreementPanel,UIModuleEvent.CHANGE),e.prototype.onCloseBtnClickHandler.call(this,t)},t}(BasePanel);__reflect(UserAngreementPanel.prototype,"UserAngreementPanel");var UserInfoPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.UserInfoPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t),this.isCloseButtonTween=!1},t.prototype.init=function(t){e.prototype.init.call(this,t),t&&(this.friendInfoType=t.type);var n=new Array;n.push(this.dataGroup),n.push(this.situationGroup),n.push(this.achievementGroup),this.userInfoTab.init(n),this.userInfoTab.isTween=!1,this.userInfoTab.viewStack.y=-150},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t);var n=UserManager.otherUserInfo;if(null==n||n.roleId==UserManager.userInfo.roleId)this.diamondNumLabel.text=UserManager.userInfo.diamond.toString(),this.goldNumLabel.text=UserManager.userInfo.gold.toString(),this.showFriendUI(this.myInfoBtnGroup);else if(this.friendInfoType)switch(this.friendInfoType){case FriendInfoType.Receive:this.showFriendUI(this.receiveOtherBtnGroup);break;case FriendInfoType.Send:this.showFriendUI(this.sendOtherInfoBtnGroup)}else this.showFriendUI(this.friendInfoBtnGroup);this.userNameLabel.text=UserManager.userInfo.name,this.refreshVipInfo(),this.ageLabel.text=UserManager.userInfo.age.toString(),this.userIdLabel.text=UserManager.userInfo.roleId.toString(),this.userDesLabel.text=UserManager.userInfo.des,this.levelLabel.text=UserManager.userInfo.level.toString(),this.titleLabel.text=UserUtil.getTitle(UserManager.userInfo.level),this.levelProgressImg.width=328,this.levelProgressImg.width*=UserUtil.getPercentage(UserManager.userInfo.level,UserManager.userInfo.exp),this.joinTimeLabel.text=UserManager.userInfo.joinTime,this.maxGoldLabel.text=UserManager.userInfo.maxGold.toString(),this.maxGoldOnetimeLabel.text=UserManager.userInfo.maxGoldOnetimes.toString(),this.winTimeLabel.text=UserManager.userInfo.gameTimes.toString()+"/"+UserManager.userInfo.winTimes.toString(),this.winProbabilityLabel.text=Math.round(0==UserManager.userInfo.gameTimes?0:UserManager.userInfo.winTimes/UserManager.userInfo.gameTimes*100).toString()+"%",this.maxHandLabel.text=UserManager.userInfo.maxHandName,this.championTimesLabel.text=UserManager.userInfo.championTimes.toString()},t.prototype.refreshVipInfo=function(){VipManager.isVip()?this.vipLevelLabel.text=UserManager.userInfo.vipLevel.toString():this.vipGroup.visible=!1},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),VipManager.vipUpgradeEvent.addListener(this.refreshVipInfo,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),VipManager.vipUpgradeEvent.removeListener(this.refreshVipInfo),UserManager.otherUserInfo=null},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.changeNameBtn:break;case this.myPrizeBtn:UIManager.showPanel(UIModuleName.MyAwardPanel);break;case this.myVipBtn:UIManager.showPanel(UIModuleName.VipPanel);break;case this.userImg:UIManager.showPanel(UIModuleName.EditUserInfoPanel);break;case this.deleteFriendBtn:UserManager.otherUserInfo&&FriendManager.reqRemovePlayer(UserManager.otherUserInfo.roleId);break;case this.requestBtn:UserManager.otherUserInfo&&FriendManager.reqAddPlayer(UserManager.otherUserInfo.roleId);break;case this.refuseBtn:UserManager.otherUserInfo&&FriendManager.reqReceiveFriendRequest(UserManager.otherUserInfo.roleId,IsReceive.NotREceive);break;case this.acceptBtn:UserManager.otherUserInfo&&FriendManager.reqReceiveFriendRequest(UserManager.otherUserInfo.roleId,IsReceive.Receive)}},t.prototype.showFriendUI=function(e){this.myInfoBtnGroup.visible=!1,this.friendInfoBtnGroup.visible=!1,this.receiveOtherBtnGroup.visible=!1,this.sendOtherInfoBtnGroup.visible=!1,e.visible=!0},t}(BasePanel);__reflect(UserInfoPanel.prototype,"UserInfoPanel");var VipPanel=function(e){function t(){var t=e.call(this)||this;return t.skinName=UISkinName.VipPanel,t}return __extends(t,e),t.prototype.onAwake=function(t){e.prototype.onAwake.call(this,t)},t.prototype.init=function(t){e.prototype.init.call(this,t);var n=new Array(this.myVipGroup,this.vipIntroduceGroup);this.tab.init(n),this.tab.isTween=!1},t.prototype.onRender=function(t){e.prototype.onRender.call(this,t),this.userImg.source="",this.userNameLabel.text=UserManager.userInfo.name,this.refreshVipInfo()},t.prototype.onEnable=function(t){e.prototype.onEnable.call(this,t),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),VipManager.vipUpgradeEvent.addListener(this.refreshVipInfo,this)},t.prototype.onDisable=function(t){e.prototype.onDisable.call(this,t),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickHandler,this),VipManager.vipUpgradeEvent.removeListener(this.refreshVipInfo)},t.prototype.refreshVipInfo=function(){this.vipLevelLabel.text="VIP"+UserManager.userInfo.vipLevel.toString(),UserManager.userInfo.vipType==VipType.NoVip?this.yearVipImg.visible=!1:this.yearVipImg.visible=!0,this.vipProgressImg.width=1080,this.vipProgressImg.width*=UserManager.userInfo.vipExp/6e3,this.vipExpLabel.text=UserManager.userInfo.vipExp.toString()+"点",this.currentVipLevel.text=UserManager.userInfo.vipLevel.toString(),this.vipSpeedLabel.text=UserManager.userInfo.vipSpeed+"点"},t.prototype.clickHandler=function(e){switch(SoundManager.playButtonEffect(e.target),e.target){case this.buyVipButton:case this.buyYearVipLabel:UIManager.showPanel(UIModuleName.ShoppingPanel)}},t}(BasePanel);__reflect(VipPanel.prototype,"VipPanel");var AchievementItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.AchievementItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t}(BaseItemRenderer);__reflect(AchievementItemRenderer.prototype,"AchievementItemRenderer");var AddFriendItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.AddFriendItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.headImg.source="fangka_png",this.nameLabel.text=this.bindData.name,this.idLabel.text=this.bindData.id.toString(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddBtnClick,this),FriendManager.onAddPlayerEvent.addListener(this.addPlayerSuccess,this))},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.addBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onAddBtnClick,this),FriendManager.onAddPlayerEvent.removeListener(this.addPlayerSuccess)},t.prototype.addPlayerSuccess=function(){AlertManager.showSingleAlertByString("已向对方发送好友申请。")},t.prototype.onAddBtnClick=function(e){SoundManager.playButtonEffect(e.target),this.addPlayerSuccess()},t}(BaseItemRenderer);__reflect(AddFriendItemRenderer.prototype,"AddFriendItemRenderer");var AwardTimesInfo=function(){function e(){}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},set:function(e){this._id=e,this._definition=AwardDefined.GetInstance().getAwardDefinition(this._id)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},enumerable:!0,configurable:!0}),e}();__reflect(AwardTimesInfo.prototype,"AwardTimesInfo");var ChatItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.ChatItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.textLabel.text=this.bindData.name+":"+this.bindData.message,this.bgImage.height=this.textLabel.height+10)},t}(BaseItemRenderer);__reflect(ChatItemRenderer.prototype,"ChatItemRenderer");var CreateRoomPanelItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.CreateRoomPanelRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.data&&(this.radioBtn1.label=this.data.des,this.radioBtn1.groupName=this.data.groupName,this.costImg.visible=this.costLabel.visible=this.data.isRound,this.costLabel.visible)){this.costLabel.text="房卡(     x"+(this.data.num/8).toString()+")";this.radioBtn1.labelDisplay}},t}(BaseItemRenderer);__reflect(CreateRoomPanelItemRenderer.prototype,"CreateRoomPanelItemRenderer");var DiamondListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.DiamondListItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData&&null!=this.diamondImg){var t=AwardDefined.GetInstance().getAwardDefinition;this.diamondImg.source=this.bindData.definition.iconName,this.diamondNum.text=t(this.bindData.definition.awardId).name,this.diamondBtn.label=t(this.bindData.definition.awardId).costNum[0].toString()}},t}(BaseItemRenderer);__reflect(DiamondListItemRenderer.prototype,"DiamondListItemRenderer");var FaceItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.FaceItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.faceImg.source="fangka_png")},t}(BaseItemRenderer);__reflect(FaceItemRenderer.prototype,"FaceItemRenderer");var FastChatItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.FastChatItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.desLabel.text=this.bindData.des,this.bgImage.height=this.desLabel.height+16)},t}(BaseItemRenderer);__reflect(FastChatItemRenderer.prototype,"FastChatItemRenderer");var FriendItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.FriendItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.isOnlinetoggleBtn.touchEnabled=!1,this.headImg.source="fangka_png",this.nameLabel.text=this.bindData.name,this.goldNumLabel.text=this.bindData.goldNum.toString(),0==this.bindData.isOnline?this.isOnlinetoggleBtn.selected=!1:this.isOnlinetoggleBtn.selected=!0,1==this.bindData.isHadGiven&&(FilterUtil.setGray(this.giveBtn),this.giveBtn.touchEnabled=!1),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.giveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.ongiveBtnClick,this),FriendManager.onGiveFriendGoldEvent.addListener(this.changeGiveButtonState,this))},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.giveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.ongiveBtnClick,this),FriendManager.onGiveFriendGoldEvent.removeListener(this.changeGiveButtonState)},t.prototype.ongiveBtnClick=function(e){SoundManager.playButtonEffect(e.target),this.changeGiveButtonState()},t.prototype.changeGiveButtonState=function(){this.giveBtn.touchEnabled=!1,FilterUtil.setGray(this.giveBtn),AlertManager.showSingleAlert("您已成功赠送给此好友500金币！")},t}(BaseItemRenderer);__reflect(FriendItemRenderer.prototype,"FriendItemRenderer");var FriendRequestItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.FriendRequestItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.headImg.source="fangka_png",this.nameLabel.text=this.bindData.name,this.idLabel.text=this.bindData.id.toString(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onreceiveBtnClick,this),this.refuseBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onrefuseBtnClick,this))},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.receiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onreceiveBtnClick,this),this.refuseBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onrefuseBtnClick,this)},t.prototype.onreceiveBtnClick=function(e){SoundManager.playButtonEffect(e.target),FriendManager.requestFriendId=this.bindData.id,UIManager.showFloatTips("接受"+this.bindData.id)},t.prototype.onrefuseBtnClick=function(e){SoundManager.playButtonEffect(e.target),FriendManager.requestFriendId=this.bindData.id,UIManager.showFloatTips("拒绝"+this.bindData.id)},t}(BaseItemRenderer);__reflect(FriendRequestItemRenderer.prototype,"FriendRequestItemRenderer");var GameOverItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.GameOverItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.hostImg.visible=!1,this.scroller.viewport=this.scoreGroup,UIUtil.hideScrollerBar(this.scroller,!0,!0),this.scoreGroup.layout=UIUtil.getVTileLayout(-1,1,egret.VerticalAlign.TOP),this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData&&this.idLabel){var t=RoomManager.getPlayerInfoByRoleId(this.bindData.roleId);t&&UIUtil.ShowHead(this.headImg,t.head),this.maxWinerFlag.visible=this.bindData.isMaxWin,this.scroller.viewport.scrollH=0,this.idLabel.text=this.bindData.roleId.toString();var n=void 0;this.hostImg.visible=!1;for(var i=0;i<GoCardProcessManager.gameOverList.length;i++)n=GoCardProcessManager.gameOverList[i],n.roleId==this.bindData.roleId&&UIUtil.ShowScoreImg(n.totalScore,this.scoreLabel1,.8,.8);RoomManager.isHost(this.bindData.roleId)&&(this.hostImg.visible=!0),this.nameLabel.text=this.bindData.playerInfo.name,UIUtil.bindRender(this.scoreGroup,OneRoundScoreItemRenderer,this.bindData.scoreInfoList)}},t}(BaseItemRenderer);__reflect(GameOverItemRenderer.prototype,"GameOverItemRenderer");var GangPaiSelectItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.GangPaiSelectItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.touchChildren=!1,this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData&&this.face1){var t=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);if(t)for(var n=1;4>=n;n++)this["face"+n.toString()].source=t.img+ResSuffixName.PNGSuffix}},t}(BaseItemRenderer);__reflect(GangPaiSelectItemRenderer.prototype,"GangPaiSelectItemRenderer");var GiftItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.GiftItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&(this.headImg.source="fangka_png",this.nameLabel.text=this.bindData.name,this.goldNumLabel.text="赠送给您"+FriendManager.giveOnceGoldNum+"好友金币",this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.receiveBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onreceiveBtnClick,this))},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.receiveBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onreceiveBtnClick,this)},t.prototype.onreceiveBtnClick=function(e){SoundManager.playButtonEffect(e.target),FriendManager.friendId=this.bindData.id},t}(BaseItemRenderer);__reflect(GiftItemRenderer.prototype,"GiftItemRenderer");var GoldListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.GoldListItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData&&null!=this.goldImg){var t=AwardDefined.GetInstance().getAwardDefinition;this.goldImg.source=this.bindData.definition.iconName,this.goldNum.text=t(this.bindData.definition.awardId).name,this.goldCount.text=t(this.bindData.definition.awardId).des,this.goldBtn.label=t(this.bindData.definition.awardId).costNum.toString()}},t}(BaseItemRenderer);__reflect(GoldListItemRenderer.prototype,"GoldListItemRenderer");var MailItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.MailItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged(),this.takePrizeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.takePrize,this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.refresh()},t.prototype.refresh=function(){this.bindData&&(this.itemTitleLabel.text=this.bindData.Title,this.itemDesLabel.text=this.bindData.Content,this.bindData.IsGot?(this.takePrizeBtn.visible=!1,this.takeDesLabel.visible=!0):(this.takePrizeBtn.visible=!0,this.takeDesLabel.visible=!1))},t.prototype.takePrize=function(){SocketManager.AddCommandListener(Command.Req_TakeMailPrize_3098,this.onTakePrize,this),SocketManager.Send(Command.Req_TakeMailPrize_3098,{MailId:this.bindData.Id})},t.prototype.onTakePrize=function(e){SocketManager.RemoveCommandListener(Command.Req_TakeMailPrize_3098,this.onTakePrize),this.bindData.IsGot=!0,this.refresh(),MailManager.getMailPrizeEvent.dispatch()},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.takePrizeBtn&&this.takePrizeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.takePrize,this)},t}(BaseItemRenderer);__reflect(MailItemRenderer.prototype,"MailItemRenderer");var OnceResultItemRenderer=function(e){function t(){var t=e.call(this)||this;return t._gapDistance=5,t._paiWidth=52,t._paiComponentList=new Array,t.skinName=UIRendererSkinName.OnceResultItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.destroyPai(),this.bindData&&this.paiGroup){this._gapIndex=0,this._paiIndex=0,this.paiGroup.removeChildren(),this.huImg.visible=!1,this.bindData.roleId==GoCardProcessManager.huCardInfo.roleId&&(this.huImg.visible=!0);var t=RoomManager.getPlayerInfoByRoleId(this.bindData.roleId);if(t){t.name?this.playerNameLabel.text=t.name:this.playerNameLabel.text=t.roleId.toString(),UIUtil.ShowScoreImg(this.bindData.currScore,this.scoreLabel);var n=void 0;if(this.bindData.shouPai&&GoCardProcessManager.huCardInfo){if(this.bindData.roleId==GoCardProcessManager.huCardInfo.roleId){if(GoCardProcessManager.huCardInfo.huType==HuResultType.JiaGang){var i=ArrayUtil.RemoveItem(GoCardProcessManager.huCardInfo.card,this.bindData.shouPai);i&&this.bindData.shouPai.unshift(GoCardProcessManager.huCardInfo.card)}else if(GoCardProcessManager.huCardInfo.huType==HuResultType.Usual){var i=ArrayUtil.RemoveItem(GoCardProcessManager.huCardInfo.card,this.bindData.shouPai);i&&this.bindData.shouPai.unshift(GoCardProcessManager.huCardInfo.card)}n=!0}var a=void 0;a=n?1:0;var o=void 0,r=0,s=0,l=0,c=0;if(this.bindData.groupList)for(var h=0;h<this.bindData.groupList.length;h++){switch(o=this.bindData.groupList[h],o.action){case ActionType.AnGang:r=4,s++;break;case ActionType.BuGang:r=4,l++;break;case ActionType.Gang:r=4,c++;break;case ActionType.Peng:r=3}for(var d=0;r>d;d++)this.createPai(o.card),this._paiIndex++;this._gapIndex++}for(var u=this.bindData.shouPai.length,h=u-1;h>=a;h--)this.createPai(this.bindData.shouPai[h]),this._paiIndex++;this._gapIndex++,n&&this.createPai(this.bindData.shouPai[0]),UIUtil.containerImgOper(this.actionLabel);var p=UIUtil.getExistImg(),g=UIUtil.getExistImg(),f=UIUtil.getExistImg();if(s>0&&this.ShowActionImg(s,ImageSource.AnGang),c>0&&this.ShowActionImg(c,ImageSource.MingGang),l>0&&this.ShowActionImg(l,ImageSource.JiaGang),this.bindData.buyHorse>0){var m=0;m+=this.getHorseNum(GoCardProcessManager.buyHorseInfo.card1),m+=this.getHorseNum(GoCardProcessManager.buyHorseInfo.card2),p=UIUtil.getExistImg(.5,.5),g=UIUtil.getExistImg(),f=UIUtil.getExistImg(),m>0&&(p.source=ImageSource.MaiMa,g.source=ImageSource.YellowCheng,f.source=UIUtil.getNumImg(m,NumResType.Yellow),this.actionLabel.addChild(p),this.actionLabel.addChild(g),this.actionLabel.addChild(f))}this.paiGroup.width=this._paiWidth*this._paiIndex+this._gapIndex*this._gapDistance}}}},t.prototype.ShowActionImg=function(e,t){var n=UIUtil.getExistImg(.5,.5),i=UIUtil.getExistImg(),a=UIUtil.getExistImg();e>0&&(n.source=t,i.source=ImageSource.YellowCheng,a.source=UIUtil.getNumImg(e,NumResType.Yellow),this.actionLabel.addChild(n),this.actionLabel.addChild(i),this.actionLabel.addChild(a))},t.prototype.getHorseNum=function(e){var t=0;if(-1==baiDaList.indexOf(e)){var n=HuCard.getIndex(e);-1!=n&&-1!=GoCardProcessManager.horseList.indexOf(n)&&t++}else t++;return t},t.prototype.createPai=function(e){var t=new OnceResultCardComponet;t.init(e),t.x=this._paiIndex*this._paiWidth+this._gapIndex*this._gapDistance,t.scaleX=t.scaleY=.5,this.paiGroup.addChild(t),this._paiComponentList.push(t)},t.prototype.destroyPai=function(){for(var e,t=this._paiComponentList.length,n=0;t>n;n++)e=this._paiComponentList[n],e.parent&&e.parent.removeChild(e),e.destroy();ArrayUtil.Clear(this._paiComponentList)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this._paiComponentList=null},t}(BaseItemRenderer);__reflect(OnceResultItemRenderer.prototype,"OnceResultItemRenderer");var OneRoundScoreItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.OneRoundScoreItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&this.roundLabel&&(this.roundLabel.text="第"+this.bindData.round+"局",UIUtil.ShowScoreImg(this.bindData.score,this.scoreLabel,.7,.7))},t}(BaseItemRenderer);__reflect(OneRoundScoreItemRenderer.prototype,"OneRoundScoreItemRenderer");var PayPanelItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.PayPanelItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.remainLabel&&this.bindData&&(null!=this.bindData.definition.get?(this.countLabel.text=this.bindData.definition.get.toString()+"张",this.paytBtn.label=this.bindData.definition.price+"元",this.remainLabel.text=StringUtil.format("今日限购{0}次",this.bindData.definition.limit-this.bindData.dayCount+"/"+this.bindData.definition.limit),this.itemImg.scaleX=1,this.itemImg.scaleY=1,this.desLabel.visible=!1):(this.remainLabel.visible=!1,this.paytBtn.label=this.bindData.definition.price+"元",this.countGroup.visible=!1,this.titleImg.source=this.bindData.definition.title,this.itemImg.source=this.bindData.definition.img,this.desLabel.text=this.bindData.definition.des))},t}(BaseItemRenderer);__reflect(PayPanelItemRenderer.prototype,"PayPanelItemRenderer");var PlayingFieldItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.PlayingFieldItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.toggleBtn0.touchEnabled=this.toggleBtn1.touchEnabled=this.toggleBtn2.touchEnabled=this.toggleBtn3.touchEnabled=this.toggleBtn4.touchEnabled=this.toggleBtn5.touchEnabled=this.toggleBtn6.touchEnabled=this.toggleBtn7.touchEnabled=this.toggleBtn8.touchEnabled=!1;for(var e=0;9>e;e++)this["toggleBtn"+e].visible=!1;this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData){this.bindData.id.toString().length<5?this.roomIdLabel.text=(Array(5).join("0")+this.bindData.id).slice(-5):this.roomIdLabel.text=this.bindData.id.toString(),this.blindLabel.text=MathUtil.formatNum(this.bindData.smallBlind)+"/"+MathUtil.formatNum(this.bindData.bigBlind),this.buyLabel.text=MathUtil.formatNum(this.bindData.minBuy)+"/"+MathUtil.formatNum(this.bindData.maxBuy),this.bindData.pattern==Pattern.AllIn?this.patternImage.source="zhouhuiyuan_png":this.bindData.pattern==Pattern.Fast?this.patternImage.source="yuehuiyuan_png":this.bindData.pattern==Pattern.Ante?this.patternImage.source="fangka_png":this.bindData.pattern==Pattern.NoUpperLimit&&(this.patternImage.source="fangka_png");for(var t=0;t<this.bindData.maxPlayer;t++)this["toggleBtn"+t].visible=!0;for(var n=0;n<this.bindData.player;n++)this["toggleBtn"+n].selected=!0}},t}(BaseItemRenderer);__reflect(PlayingFieldItemRenderer.prototype,"PlayingFieldItemRenderer");var RoundDetialsItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.RoundDetialsItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.shareBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onShareBtnClick,this)},t.prototype.onShareBtnClick=function(e){SoundManager.playButtonEffect(e.target)},t}(BaseItemRenderer);__reflect(RoundDetialsItemRenderer.prototype,"RoundDetialsItemRenderer");var RoundUserListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.RoundUserListItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.dataChanged()
},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t.prototype.refresh=function(e,t){},t.prototype.showScore=function(e,t){var n=StringConstant.empty;e>=0?(t.textColor=65280,n+="+",n+=e.toString()+"分"):(t.textColor=16711680,n+=e.toString()+"分"),t.text=n},t.prototype.onDisable=function(e){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onDisable,this),this.infoBtn&&this.infoBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onInfoBtnClick,this)},t.prototype.onInfoBtnClick=function(e){SoundManager.playButtonEffect(e.target),this.bindData},t}(BaseItemRenderer);__reflect(RoundUserListItemRenderer.prototype,"RoundUserListItemRenderer");var ShouPaiItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.ShouPaiItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData&&this.contentImg){var t=PaiDefined.GetInstance().getDefinition(this.bindData,PaiDefined.GetInstance().paiList);t&&(this.contentImg.source=t.img+ResSuffixName.PNGSuffix)}},t}(BaseItemRenderer);__reflect(ShouPaiItemRenderer.prototype,"ShouPaiItemRenderer");var TextRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.TextRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.bindData&&this.txtLabel&&(this.txtLabel.text=this.bindData)},t}(BaseItemRenderer);__reflect(TextRenderer.prototype,"TextRenderer");var TingRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.TingRenderer,t}return __extends(t,e),t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.countLabel)if(this.bindData){this.bindData.remainNum>0?this.countLabel.textColor=5201248:this.countLabel.textColor=16711680,this.countLabel.text=this.bindData.remainNum+"张",this.allLabel.visible=!1;var t=PaiDefined.GetInstance().getDefinition(this.bindData.pai,PaiDefined.GetInstance().paiList);t?this.face.source=t.img+ResSuffixName.PNGSuffix:this.face.source="",this.showAllLabel(!1)}else this.showAllLabel(!0)},t.prototype.showAllLabel=function(e){this.allLabel&&(this.allLabel.visible=e,this.countLabel.visible=!e)},t}(BaseItemRenderer);__reflect(TingRenderer.prototype,"TingRenderer");var VipListItemRenderer=function(e){function t(){var t=e.call(this)||this;return t.skinName=UIRendererSkinName.VipListItemRenderer,t}return __extends(t,e),t.prototype.createChildren=function(){this.dataChanged()},t.prototype.dataChanged=function(){if(e.prototype.dataChanged.call(this),this.bindData){var t=AwardDefined.GetInstance().getAwardDefinition;this.vipImg.source=this.bindData.definition.iconName,this.monthVip.text=t(this.bindData.definition.awardId).name,this.vipCountBtn.label=t(this.bindData.definition.awardId).costNum[0].toString()+"钻石"}},t}(BaseItemRenderer);__reflect(VipListItemRenderer.prototype,"VipListItemRenderer");var UIManager=function(){function e(){}return e.initialize=function(t){e._gameLayer=new eui.Group,e._mainUiLayer=new eui.Group,e._moduleLayer=new eui.Group,e._tipsLayer=new eui.Group,e._guideLayer=new eui.Group,e._warnLayer=new eui.Group,t.addChild(e._gameLayer),t.addChild(e._mainUiLayer),t.addChild(e._moduleLayer),t.addChild(e._tipsLayer),t.addChild(e._guideLayer),t.addChild(e._warnLayer),e._panelDict=new Dictionary,e._layerDict=new Dictionary,e._layerDict.add(UILayerType.GameContent,e._gameLayer),e._layerDict.add(UILayerType.MainUI,e._mainUiLayer),e._layerDict.add(UILayerType.Module,e._moduleLayer),e._layerDict.add(UILayerType.Tips,e._tipsLayer),e._layerDict.add(UILayerType.Guide,e._guideLayer),e._layerDict.add(UILayerType.Warn,e._warnLayer);for(var n,i=e._layerDict.getValues(),a=0;a<i.length;a++)n=i[a],n.touchEnabled=!1,n.width=GameSetting.StageWidth,n.height=GameSetting.StageHeight},e.showPanel=function(t,n){var i;if(i=e._panelDict.getValue(t),!i){var a=egret.getDefinitionByName(t);a&&(i=new a,e._panelDict.add(t,i))}if(i){var o=e.getLayerContainer(i.layer);e.setAlignInfo(i),i.init(n),o&&o.addChild(i)}},e.closePanel=function(t){var n;"string"==typeof t?n=e.getPanel(t):t instanceof BasePanel&&(n=t),n&&n.parent&&n.parent.removeChild(n)},e.getPanel=function(t){if(t){var n=e._panelDict.getValue(t);return n}throw new Error("面板名为空！")},e.getLayerContainer=function(t){return t!=UILayerType.None?e._layerDict.getValue(t):null},e.showFloatTips=function(t){e.showPanel(UIModuleName.TextTipsPanel,t)},e.takeToTopLayer=function(t){var n,i;"string"==typeof t?(n=e.getPanel(t),i=e.getLayerContainer(n.layer)):t instanceof BasePanel&&(n=t,i=e.getLayerContainer(t.layer)),i&&n&&n.parent.addChild(n)},e.isShowPanel=function(t){var n=e.getPanel(t);return e.isShowPanelObj(n)},e.isShowPanelObj=function(e){return e&&e.parent&&e.visible?!0:!1},e.setAlignInfo=function(e){if(e.tweenGroup)switch(e.top=0/0,e.bottom=0/0,e.left=0/0,e.right=0/0,e.horizontalCenter=0/0,e.verticalCenter=0/0,e.panelAlignType){case PanelAlignType.Center_Top:e.tweenGroup.horizontalCenter=e.offsetH,e.tweenGroup.top=e.offsetV;break;case PanelAlignType.Center_Center:e.tweenGroup.horizontalCenter=e.offsetH,e.tweenGroup.verticalCenter=e.offsetV;break;case PanelAlignType.Center_Bottom:e.tweenGroup.horizontalCenter=e.offsetH,e.tweenGroup.bottom=e.offsetV;break;case PanelAlignType.Left_Top:e.tweenGroup.left=e.offsetH,e.tweenGroup.top=e.offsetV;break;case PanelAlignType.Left_Bottom:e.tweenGroup.left=e.offsetH,e.tweenGroup.bottom=e.offsetV;break;case PanelAlignType.Left_Center:e.tweenGroup.left=e.offsetH,e.tweenGroup.verticalCenter=e.offsetV;break;case PanelAlignType.Right_Top:e.tweenGroup.right=e.offsetH,e.tweenGroup.top=e.offsetV;break;case PanelAlignType.Right_Center:e.tweenGroup.right=e.offsetH,e.tweenGroup.verticalCenter=e.offsetV;break;case PanelAlignType.Right_Bottom:e.tweenGroup.right=e.offsetH,e.tweenGroup.bottom=e.offsetV}},e.addEventListener=function(t,n,i,a){e._eventDispatcher.addListener(t+n,i,a)},e.removeEventListener=function(t,n,i){e._eventDispatcher.removeListener(t+n,i)},e.dispatchEvent=function(t,n,i){e._eventDispatcher.dispatch(t+n,i)},e.removeAllEvent=function(){e._eventDispatcher.clear()},e}();UIManager._eventDispatcher=new CallDispatcher,__reflect(UIManager.prototype,"UIManager");var HpBar=function(e){function t(){var t=e.call(this)||this;return t._bg=new egret.Shape,t._bg.graphics.beginFill(3024405),t._bg.graphics.drawRect(0,0,100,20),t._bg.graphics.endFill(),t._bg.cacheAsBitmap=!0,t.addChild(t._bg),t._bar=new egret.Shape,t._bar.graphics.beginFill(3464256),t._bar.graphics.drawRect(1,1,98,18),t._bar.graphics.endFill(),t._bar.cacheAsBitmap=!0,t.addChild(t._bar),t._mask=new egret.Shape,t._mask.graphics.beginFill(3464256),t._mask.graphics.drawRect(1,1,98,18),t._mask.graphics.endFill(),t.addChild(t._mask),t._bar.mask=t._mask,t}return __extends(t,e),t.prototype.updateHp=function(e){e>1&&(e=1),0>e&&(e=0),this._mask.scaleX=e},t}(egret.DisplayObjectContainer);__reflect(HpBar.prototype,"HpBar");var UnitBase=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemoveToStage,t),t}return __extends(t,e),Object.defineProperty(t.prototype,"modelFramerate",{get:function(){return this._modelFramerate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unitId",{get:function(){return this._unitId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"uintId",{set:function(e){this._unitId=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modelData",{get:function(){return this._modelData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modelTexture",{get:function(){return this._modelTexture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"movieClipFactory",{get:function(){return this._movieClipFactory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modelIsLoadComplete",{get:function(){return this._modelIsLoadComplete},enumerable:!0,configurable:!0}),t.prototype.onAddToStage=function(e){this.addEventListener(egret.Event.ENTER_FRAME,this.onFrameHandler,this)},t.prototype.onRemoveToStage=function(e){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStage,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrameHandler,this)},t.prototype.onFrameHandler=function(e){this._model&&this._playComplete&&this._model.currentFrame==this._model.totalFrames&&this._playComplete(this)},t.prototype.Init=function(e,t,n,i){void 0===i&&(i=null),this._modelIsLoadComplete=!1,this._modelLoadCompleteCallBack=n,this._playComplete=i,this._unitId=e,this._preFixName=t,RES.addEventListener(RES.ResourceEvent.COMPLETE,this.loadDataComplete,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.loadError,this),RES.getResByUrl(t+e+ResSuffixName.JSONSuffix,this.loadDataComplete,this,RES.ResourceItem.TYPE_JSON)},t.prototype.loadDataComplete=function(e){RES.removeEventListener(RES.ResourceEvent.COMPLETE,this.loadDataComplete,this),this._modelData=e.resItem.data,RES.addEventListener(RES.ResourceEvent.COMPLETE,this.loadTextureComplete,this),RES.getResByUrl(this._preFixName+this._unitId+ResSuffixName.PNGSuffix,this.loadDataComplete,this,RES.ResourceItem.TYPE_IMAGE)},t.prototype.loadTextureComplete=function(e){this._modelTexture=e.resItem.data,this._modelData&&this._modelTexture&&(this._modelIsLoadComplete=!0,this._movieClipFactory=new egret.MovieClipDataFactory(this._modelData,this._modelTexture),this._model=new egret.MovieClip(this._movieClipFactory.generateMovieClipData(this._unitId.toString())),this._model&&(this._modelFramerate=this.model.frameRate),null!=this._modelLoadCompleteCallBack&&this._modelLoadCompleteCallBack(this))},t.prototype.loadError=function(e){console.log("模型图片加载出错："+e.resItem.url)},t.prototype.play=function(e,t){void 0===e&&(e=""),void 0===t&&(t=1),this.model&&(e?this.model.gotoAndPlay(e):this.model.gotoAndPlay(1),this.changeSpeed(t))},t.prototype.stop=function(e){void 0===e&&(e=""),this.model&&(e?this.model.gotoAndStop(e):this.model.gotoAndStop(1))},t.prototype.changeSpeed=function(e){0>e&&(e=0),this.model.frameRate=this._modelFramerate*e},t.prototype.Reset=function(){this._unitId=0,this._modelTexture=null,this._model=null,this._modelData=null,this._modelIsLoadComplete=!1,this._modelLoadCompleteCallBack=null,this._playComplete=null},t}(egret.DisplayObjectContainer);__reflect(UnitBase.prototype,"UnitBase");var RoundSplitInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){},t}(BaseServerValueInfo);__reflect(RoundSplitInfo.prototype,"RoundSplitInfo");var RoundInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){},t}(BaseServerValueInfo);__reflect(RoundInfo.prototype,"RoundInfo");var RoomOverType;!function(e){e[e.Usual=1]="Usual",e[e.Disband=2]="Disband"}(RoomOverType||(RoomOverType={}));var RoundDetialsInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(RoundInfo);__reflect(RoundDetialsInfo.prototype,"RoundDetialsInfo");var UserInfo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.reset=function(){this._diamondNum=0,this._goldNum=0,this._saveGoldNum=0,this.timestamp=0,this.timezone=0,this.roleId=0,this.name=StringConstant.empty,this.head=StringConstant.empty,this.sex=0,this.level=0,this.exp=0,this.ip=StringConstant.empty,this.des=StringConstant.empty,this.age=0,this.joinTime=StringConstant.empty,this.maxGold=0,this.maxGoldOnetimes=0,this.friendNum=0,this.gameTimes=0,this.winTimes=0,this.maxHandList=void 0,this.maxHandName=StringConstant.empty,this.championTimes=0,this.addressName=StringConstant.empty,this.phoneNum=StringConstant.empty,this.qqNum=StringConstant.empty,this.eMail=StringConstant.empty,this.address=StringConstant.empty,this.vipType=0,this.vipLevel=0,this.vipExp=0,this.vipSpeed=0,this.vipTime=0,this.yearVipTime=0},Object.defineProperty(t.prototype,"diamond",{get:function(){return this._diamondNum},set:function(e){this._diamondNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gold",{get:function(){return this._goldNum},set:function(e){this._goldNum=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"safeGold",{get:function(){return this._saveGoldNum},set:function(e){this._saveGoldNum=e},enumerable:!0,configurable:!0}),t}(BaseServerValueInfo);__reflect(UserInfo.prototype,"UserInfo");var UserManager=function(){function e(){}return e.reLogin=function(){e.userInfo=null,e.otherUserInfoClear()},e.otherUserInfoClear=function(){e.otherUserInfo&&e.otherUserInfo.reset()},e.initialize=function(t,n){if(e.otherUserInfoClear(),e.userInfo=new UserInfo,ChannelManager.loginType==ChannelLoginType.Weixin){var i=void 0;LoginManager.loginInfo.channeldata.hasOwnProperty("name")&&(i=LoginManager.loginInfo.channeldata.name);var a=void 0;LoginManager.loginInfo.channeldata.hasOwnProperty("head")&&(a=LoginManager.loginInfo.channeldata.head);var o=Sex.Male;LoginManager.loginInfo.channeldata.hasOwnProperty("sex")&&(o=parseInt(LoginManager.loginInfo.channeldata.sex)),(null!==i&&void 0!==i&&e.userInfo.name!=i||null!==a&&void 0!==a&&e.userInfo.head!=a||e.userInfo.sex!=o)&&e.reqSetUserInfo(i,a,o)}e.userInfo.copyValueFrom(n),RoomManager.playerNameOper(e.userInfo),SocketManager.AddCommandListener(Command.Rec_ExpChange_2028,e.onExpChangeResult,this),SocketManager.AddCommandListener(Command.Rec_PushPropertyChange_2000,e.onPropetyChangeHandler,this)},e.onExpChangeResult=function(t){t.data&&(e.userInfo.level<ExpDefined.GetInstance().expList[ExpDefined.GetInstance().expList.length-1].level&&e.userInfo.level!=t.data.level&&(e.userInfo.level=t.data.level,e.levelUpgrade.dispatch()),e.userInfo.exp=t.data.exp)},e.onPropetyChangeHandler=function(t){t.data&&e.userInfo&&(console.log(t),e.userInfo.gold=t.data.gold,e.userInfo.diamond=t.data.diamond,e.userInfo.safeGold=t.data.safeGold,e.propertyChangeEvent.dispatch())},e.reqGetOtherUserInfo=function(t){SocketManager.AddCommandListener(Command.Req_GetUserInfo_3023,e.onGetOtherUserInfoResult),SocketManager.Send(Command.Req_GetUserInfo_3023,{roleId:t})},e.onGetOtherUserInfoResult=function(t){SocketManager.RemoveCommandListener(Command.Req_GetUserInfo_3023,e.onGetOtherUserInfoResult),e.otherUserInfo||(e.otherUserInfo=new UserInfo),t.data&&(RoomManager.playerNameOper(t.data),e.otherUserInfo.copyValueFrom(t.data)),e.getOtherUserInfoEa.dispatch()},e.reqSetUserInfo=function(t,n,i){var a=function(o){SocketManager.RemoveCommandListener(Command.Req_SetUserInfo_3017,a),e.userInfo.name=t,e.userInfo.head=n,e.userInfo.sex=i,RoomManager.playerNameOper(e.userInfo),e.onSetUserInfoComplete.dispatch()};SocketManager.AddCommandListener(Command.Req_SetUserInfo_3017,a);var o={};null!==t&&void 0!==t&&(o.name=t),null!==n&&void 0!==n&&(o.head=n),o.sex=i,SocketManager.Send(Command.Req_SetUserInfo_3017,o)},e}();UserManager.levelUpgrade=new ActionDispatcher,UserManager.propertyChangeEvent=new ActionDispatcher,UserManager.getOtherUserInfoEa=new ActionDispatcher,UserManager.onSetUserInfoComplete=new ActionDispatcher,__reflect(UserManager.prototype,"UserManager");var UserUtil=function(){function e(){}return e.getPercentage=function(e,t){var n;if(1==e)return Math.round(t/ExpDefined.GetInstance().expList[1].exp*100)/100;if(e>1&&100>e){for(var i=1;e>i;i++)t-=ExpDefined.GetInstance().expList[i].exp;return n=ExpDefined.GetInstance().expList[i].exp,Math.round(t/n*100)/100}return 100==e?0:void 0},e.getTitle=function(e){for(var t=0;t<ExpDefined.GetInstance().expList.length;t++)if(e==ExpDefined.GetInstance().expList[t].level)return ExpDefined.GetInstance().expList[t].title;return null},e.isLegalNickName=function(e){var t=e;return t?t.length>6?(AlertManager.showSingleAlert("昵称不能大于6个字"),!1):/^[\u4e00-\u9fa5\dA-Za-z]+$/.test(t)?this.isContainForbiddenName(t)?(AlertManager.showSingleAlert("您输入的昵称包含屏蔽词"),!1):!0:(AlertManager.showSingleAlert("昵称只能为汉字、英文和数字"),!1):(AlertManager.showSingleAlert("昵称不能为空"),!1)},e.isContainForbiddenName=function(e){for(var t=0;t<ForbiddenDefined.GetInstance().forbiddenList.length;t++)if(e.indexOf(ForbiddenDefined.GetInstance().forbiddenList[t].des.toString())>=0)return!0;return!1},e.randomNickName=function(e){e=e<Sex.Female?Sex.Male:Sex.Female;var t=this.randomFirstName(),n=this.randomLastName(e);return t.trim()+n.trim()},e.randomFirstName=function(){var e=MathUtil.getRandom(0,NameDefined.GetInstance().lastNameRange-1),t=NameDefined.GetInstance().nameList[e].name;return t},e.randomLastName=function(e){var t,n;return e==Sex.Male?(t=MathUtil.getRandom(0,NameDefined.GetInstance().bboyFirstNameRange-1),n=NameDefined.GetInstance().nameList[t],n.boy):(t=MathUtil.getRandom(0,NameDefined.GetInstance().nameList.length-1),n=NameDefined.GetInstance().nameList[t],n.girl)},e}();__reflect(UserUtil.prototype,"UserUtil");var ColorUtil=function(){function e(){}return Object.defineProperty(e,"green",{get:function(){return 10157824},enumerable:!0,configurable:!0}),Object.defineProperty(e,"red",{get:function(){return 16711680},enumerable:!0,configurable:!0}),e}();__reflect(ColorUtil.prototype,"ColorUtil");var DragUtil=function(){function e(){}return Object.defineProperty(e,"isDragEnable",{set:function(t){e._isDragEnable=t},enumerable:!0,configurable:!0}),e.startDrag=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=0),e._isDragEnable&&(e.dragContainer||(e.dragContainer=new eui.Group),e.dragContainer.parent?GameManager.stage.addChild(e.dragContainer):GameManager.stage.addChild(e.dragContainer),e.dragTarget=t,e._offsetX=n,e._offsetY=i,e.dragContainer.removeChildren(),e.dragContainer.addChild(t),e.dragContainer.visible=!1,e._isMove=!1,GameManager.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,this),GameManager.stage.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,this))},e.onTouchEnd=function(t){e.stop()},e.onTouchMove=function(t){e.dragContainer?(e.dragContainer.visible=!0,e.dragTarget.x=t.stageX-e.dragTarget.measuredWidth/2-e.dragTarget.anchorOffsetX*e.dragTarget.measuredWidth+e._offsetX,e.dragTarget.y=t.stageY-e.dragTarget.measuredHeight/2-e.dragTarget.anchorOffsetY*e.dragTarget.measuredHeight+e._offsetY,e._isMove=!0):e.stop()},e.stop=function(){e._isMove&&e.dragEndEa.dispatch(e.dragContainer.getChildAt(0)),e.dragContainer.removeChildren(),e.dragContainer.parent&&e.dragContainer.parent.removeChild(e.dragContainer),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,this),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,this)},e}();DragUtil._isDragEnable=!0,DragUtil._isMove=!1,DragUtil.dragEndEa=new ActionDispatcher,__reflect(DragUtil.prototype,"DragUtil");var FilterUtil=function(){function e(){}return Object.defineProperty(e,"grayArray",{get:function(){return e._grayArray},enumerable:!0,configurable:!0}),e.defaultArray=function(){return e._defaultArray},e.setGray=function(t){t.filters=e._grayArray},e.setEraseGray=function(t){t.filters=e._defaultArray},e}();FilterUtil._grayMatrix=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],FilterUtil._grayFilter=new egret.ColorMatrixFilter(FilterUtil._grayMatrix),FilterUtil._grayArray=[FilterUtil._grayFilter],FilterUtil._defaultMatrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],FilterUtil._defaultColorFilter=new egret.ColorMatrixFilter(FilterUtil._defaultMatrix),FilterUtil._defaultArray=[FilterUtil._defaultColorFilter],__reflect(FilterUtil.prototype,"FilterUtil");var PoolUtil=function(){function e(){}return e.GetObject=function(t){var n=egret.getQualifiedClassName(t),i=e.GetPool(n),a=i.pop();return a?a:new t},e.PutObject=function(t,n){if(void 0===n&&(n=10),t){var i=egret.getQualifiedClassName(t),a=e.GetPool(i);a.length<n&&(t.reset(),a.push(t))}},e.GetPool=function(t){var n=null;return t?(n=e._map.getValue(t),null==n&&(n=new Array,e._map.add(t,n))):n=new Array,n},e}();PoolUtil._map=new Dictionary,__reflect(PoolUtil.prototype,"PoolUtil");var SortUtil=function(){function e(){}return e.sortCardByLayer=function(e,t){return e.layer>t.layer?1:e.layer<t.layer?-1:0},e.sortCardById=function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},e.sortY=function(e,t){return e.y>t.y?1:e.y<t.y?-1:0},e.downSort=function(e,t){return e>t?-1:t>e?1:0},e.sortGroupCard=function(e,t){return e.index>t.index?1:e.index<t.index?-1:0},e.blindUpSort=function(e,t){if(e.smallBlind>t.smallBlind)return 1;if(e.smallBlind<t.smallBlind)return-1;if(e.smallBlind==t.smallBlind){if(e.player>t.player)return 1;if(e.player<t.player)return-1;if(e.player==t.player)return e.id>t.id?1:e.id<t.id?-1:0}},e.blindDownSort=function(e,t){if(e.smallBlind>t.smallBlind)return-1;if(e.smallBlind<t.smallBlind)return 1;if(e.smallBlind==t.smallBlind){if(e.player>t.player)return-1;if(e.player<t.player)return 1;if(e.player==t.player)return e.id>t.id?-1:e.id<t.id?1:0}},e.roomIdUpSort=function(e,t){return e.id>t.id?1:e.id<t.id?-1:0},e.roomIdDownSort=function(e,t){return e.id>t.id?-1:e.id<t.id?1:0},e.roomPlayNumUpSort=function(e,t){return e.player>t.player?1:e.player<t.player?-1:e.player==t.player?e.id>t.id?1:e.id<t.id?-1:0:void 0},e.roomPlayNumDownSort=function(e,t){return e.player>t.player?-1:e.player<t.player?1:e.player==t.player?e.id>t.id?-1:e.id<t.id?1:0:0},e}();__reflect(SortUtil.prototype,"SortUtil");var UIUtil=function(){function e(){}return e.bindRender=function(e,t,n){if(e&&t){if(void 0!=n){var i=new eui.ArrayCollection(n);e.dataProvider=i}e.itemRenderer||("string"==typeof t?e.itemRendererSkinName=t:"function"==typeof t&&(e.itemRenderer=t))}},e.listRenderer=function(t,n,i,a,o,r,s){if(void 0===s&&(s=!1),!t||!n||!i)return void console.log("初始化失败！绑定的组件对象不能为空！");if(void 0!=a&&void 0!=o)switch(n.scrollPolicyH=eui.ScrollPolicy.OFF,n.scrollPolicyV=eui.ScrollPolicy.OFF,a){case ScrollViewDirection.Horizontal_L_R:n.scrollPolicyH=o;break;case ScrollViewDirection.Vertical_T_D:n.scrollPolicyV=o}else n.scrollPolicyH=eui.ScrollPolicy.AUTO,n.scrollPolicyV=eui.ScrollPolicy.AUTO;e.bindRender(t,i,r),t.useVirtualLayout=s,n.viewport=t},e.scrollToIndex=function(e,t,n){if(e&&e.viewport){var i=t*n;e.scrollPolicyH!=eui.ScrollPolicy.OFF&&(e.viewport.scrollH=i),e.scrollPolicyV!=eui.ScrollPolicy.OFF&&(e.viewport.scrollV=i)}},e.hideScrollerBar=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0),t&&e&&e.horizontalScrollBar&&(e.horizontalScrollBar.autoVisibility=!1,e.horizontalScrollBar.visible=!1),n&&e&&e.verticalScrollBar&&(e.verticalScrollBar.autoVisibility=!1,e.verticalScrollBar.visible=!1)},e.getHTileLayout=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=egret.HorizontalAlign.LEFT);var i=new eui.TileLayout;return i.horizontalAlign=n,void 0!=e&&(i.horizontalGap=e),void 0!=t&&(i.requestedRowCount=t),i},e.getVTileLayout=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=egret.VerticalAlign.TOP);var i=new eui.TileLayout;return i.verticalAlign=n,void 0!=e&&(i.verticalGap=e),void 0!=t&&(i.requestedColumnCount=t),i},e.getTileLayout=function(e,t,n,i,a,o){var r=new eui.TileLayout;return void 0!=e&&(r.horizontalGap=e),void 0!=t&&(r.verticalGap=t),void 0!=n&&(r.requestedRowCount=n),void 0!=i&&(r.requestedColumnCount=i),void 0!=a&&(r.horizontalAlign=a),void 0!=o&&(r.verticalAlign=o),r},e.getSexImgSource=function(e){return e==Sex.Female?ImageSource.FemaleImg:e==Sex.Male?ImageSource.MaleImg:StringConstant.empty},e.refreshSortContainer=function(e,t){if(t&&e)for(var n=0;n<e.length;n++)t.addChild(e[n])},e.containerImgOper=function(t){ArrayUtil.Clear(e._imgList);for(var n,i=0;i<t.numChildren;i++)n=t.getChildAt(i),n instanceof eui.Image&&(n.source="",e._imgList.push(n));t.removeChildren()},e.ShowScoreImg=function(t,n,i,a,o,r){if(void 0===i&&(i=1),void 0===a&&(a=1),void 0===o&&(o=!0),void 0===r&&(r=!1),n){e.containerImgOper(n);for(var s=void 0,l=Math.abs(t),c=l.toString(),h=[],d=0;d<c.length;d++)h.push(parseInt(c.slice(d,d+1)));var u=void 0,p=StringConstant.empty,g=void 0;t>=0?(u=ResPrefixName.NumGreen,o&&(p="jia")):0>t&&(u=ResPrefixName.NumRed,o&&(p="jian")),g=e.getExistImg(i,a),g.source=u+ResPrefixName.Fen+ResSuffixName.PNGSuffix,s=e.getExistImg(i,a),s.source=u+p+ResSuffixName.PNGSuffix,n.addChild(s);for(var d=0;d<h.length;d++)s=e.getExistImg(i,a),s.source=u+h[d].toString()+ResSuffixName.PNGSuffix,n.addChild(s);r||n.addChild(g),h=null,c=null}},e.getExistImg=function(t,n){void 0===t&&(t=1),void 0===n&&(n=1);var i=e._imgList.pop();return i||(i=new eui.Image),i.scaleX=t,i.scaleY=n,i},e.getNumImg=function(e,t){if(void 0===t&&(t=NumResType.Red),e>=0&&9>=e)switch(t){case NumResType.Red:return ResPrefixName.NumRed+e.toString()+ResSuffixName.PNGSuffix;case NumResType.Green:return ResPrefixName.NumGreen+e.toString()+ResSuffixName.PNGSuffix;case NumResType.Yellow:return ResPrefixName.NumYellow+e.toString()+ResSuffixName.PNGSuffix}},e.ShowHead=function(e,t){e&&(t?e.source=t:e.source=ImageSource.Default_Head)},e.setGlowerFilter=function(t){if(e.colorFilterList||(e.colorFilterList=new Array),!e.colorFilter){var n=[1,0,0,0,10,0,1,0,0,10,0,0,1,0,10,0,0,0,1,0];e.colorFilter=new egret.ColorMatrixFilter(n),e.colorFilterList[0]=e.colorFilter}t&&(t.filters=e.colorFilterList)},e.clearFilters=function(t){t&&(t.filters=e.emptyFilterList)},e}();UIUtil._imgList=new Array,UIUtil.emptyFilterList=[],__reflect(UIUtil.prototype,"UIUtil");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var a=RES.getRes(e);a?i(a):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Channel_android=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Initialize=function(){egret.ExternalInterface.call(ExtFuncName.Initialize,"")},t.prototype.Login=function(e,t){egret.ExternalInterface.call(ExtFuncName.Login,e)},t.prototype.Logout=function(){egret.ExternalInterface.call(ExtFuncName.Logout,"")},t.prototype.PaySend=function(e,t,n,i){var a={serverId:e,orderId:t,price:n,name:i};egret.ExternalInterface.call(ExtFuncName.Pay,JSON.stringify(a))},t.prototype.SetExtData=function(e){egret.ExternalInterface.call(ExtFuncName.SetExtData,e)},t.prototype.SetChannelData=function(e,t){egret.ExternalInterface.call(ExtFuncName.SetChannelData,JSON.stringify({account:e,token:t}))},t.prototype.share=function(e){egret.ExternalInterface.call(ExtFuncName.Share,e)},t.prototype.requestMicrophone=function(){egret.ExternalInterface.call(ExtFuncName.RequestMicrophone,"")},t.prototype.recordAudio=function(e){egret.ExternalInterface.call(ExtFuncName.RecordAudio,e)},t.prototype.hotUpdate=function(e){egret.ExternalInterface.call(ExtFuncName.HotUpdate,e)},t.prototype.setRecordData=function(e,t){var n={guid:e,data:t};egret.ExternalInterface.call(ExtFuncName.SetRecordData,JSON.stringify(n))},t.prototype.checkAudioCachePath=function(){egret.ExternalInterface.call(ExtFuncName.CheckAudioCachePath,StringConstant.empty)},t.prototype.hasRecordData=function(e){egret.ExternalInterface.call(ExtFuncName.HasRecordData,e)},t.prototype.playRecord=function(e){egret.ExternalInterface.call(ExtFuncName.PlayRecord,e)},t.prototype.loginValidateFail=function(){egret.ExternalInterface.call(ExtFuncName.LoginValidateFail,"")},t}(ChannelBase);__reflect(Channel_android.prototype,"Channel_android");var Channel_ios=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Initialize=function(){egret.ExternalInterface.call(ExtFuncName.Initialize,"")},t.prototype.Login=function(e,t){egret.ExternalInterface.call(ExtFuncName.Login,e)},t.prototype.Logout=function(){egret.ExternalInterface.call(ExtFuncName.Logout,"")},t.prototype.PaySend=function(e,t,n,i){var a={serverId:e,orderId:t,price:n,name:i};egret.ExternalInterface.call(ExtFuncName.Pay,JSON.stringify(a))},t.prototype.SetExtData=function(e){egret.ExternalInterface.call(ExtFuncName.SetExtData,e)},t.prototype.SetChannelData=function(e,t){egret.ExternalInterface.call(ExtFuncName.SetChannelData,JSON.stringify({account:e,token:t}))},t.prototype.share=function(e){egret.ExternalInterface.call(ExtFuncName.Share,e)},t.prototype.requestMicrophone=function(){egret.ExternalInterface.call(ExtFuncName.RequestMicrophone,"")},t.prototype.recordAudio=function(e){egret.ExternalInterface.call(ExtFuncName.RecordAudio,e)},t.prototype.hotUpdate=function(e){egret.ExternalInterface.call(ExtFuncName.HotUpdate,e)},t.prototype.setRecordData=function(e,t){var n={guid:e,data:t};egret.ExternalInterface.call(ExtFuncName.SetRecordData,JSON.stringify(n))},t.prototype.checkAudioCachePath=function(){egret.ExternalInterface.call(ExtFuncName.CheckAudioCachePath,StringConstant.empty)},t.prototype.hasRecordData=function(e){egret.ExternalInterface.call(ExtFuncName.HasRecordData,e)},t.prototype.playRecord=function(e){egret.ExternalInterface.call(ExtFuncName.PlayRecord,e)},t.prototype.loginValidateFail=function(){egret.ExternalInterface.call(ExtFuncName.LoginValidateFail,"")},t}(ChannelBase);__reflect(Channel_ios.prototype,"Channel_ios");var Channel_web=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Initialize=function(){var e={};e.channelType=ChannelType.qin,e.appName=window.document.title,e.deviceId="",e.bundleId="",e.hasWeixin="0",e.hasMicrophone="0",ChannelManager.sdkInitComplete(JSON.stringify(e))},t.prototype.Login=function(e,t){if(e==ChannelLoginType.Account||ChannelManager.loginType==ChannelLoginType.IntranetAccount){var n=PrefsManager.getValue(PrefsManager.Login_Account),i=PrefsManager.getValue(PrefsManager.Login_Password);t&&n&&i?ChannelManager.DispatchAccountLoginSucceed(n,i):UIManager.isShowPanel(UIModuleName.LoginLocalPanel)||UIManager.showPanel(UIModuleName.LoginLocalPanel)}else e==ChannelLoginType.Normal||(UIManager.showFloatTips("登录类型错误"),ChannelManager.sdkLoginFailed())},t.prototype.Logout=function(){ChannelManager.sdkLogout()},t.prototype.PaySend=function(e,t,n,i){ChannelManager.loginType==ChannelLoginType.Account||ChannelManager.loginType==ChannelLoginType.IntranetAccount?(ShoppingManager.buyOverAction.addListener(this.OnExchanged,this),ShoppingManager.reqBuyGdOrDmd(parseInt(i))):UIManager.showFloatTips("不能支付")},t.prototype.OnExchanged=function(e){PayManager.buyOverAction.removeListener(this.OnExchanged),ChannelManager.sdkPaySucceed(StringConstant.empty),console.log("执行OnExchanged")},t.prototype.hotUpdate=function(){ChannelManager.sdkHotUpdateComplete()},t}(ChannelBase);__reflect(Channel_web.prototype,"Channel_web");var CalculateFan=function(){function e(){this._maxFan=0,this._resultFanList=new Array,this._exclude=new Array}return e.prototype.clear=function(){this._maxFan=0,ArrayUtil.Clear(this._exclude),ArrayUtil.Clear(this._resultFanList),this._huPaiInfo.maxHuWayInfo=null},e.prototype.startCalculateFan=function(e){if(this._huPaiInfo=e,this._huPaiInfo){this.clear();var t=this.getAvliableList();if(!t||t.length<=0)return void console.error("当前胡牌，无法算番！");for(var n=0;n<this._huPaiInfo.huWayList.length;n++){var i=this._huPaiInfo.huWayList[n];if(i){ArrayUtil.Clear(i.fanList);for(var a=0,o=0;o<t.length;o++){var r=t[o];if(r){var s=this[r.funcName];if(s){var l=s(i,r,this);l>0&&i.fanList.push(r),a+=l}else console.error("未找到算番的方法："+r.funcName)}}i.fan=a+this._huPaiInfo.huaList.length,a>this._maxFan&&(this._maxFan=a,this._huPaiInfo.maxHuWayInfo=i)}}return this._huPaiInfo.huaList?console.log("去花番数："+this._maxFan+"\n","花的番数："+this._huPaiInfo.huaList.length+"\n","总番数："+(this._maxFan+this._huPaiInfo.huaList.length)):console.log("总番数无花："+this._maxFan),this._maxFan}},e.prototype.getAvliableList=function(){var e,t,n=FanCalcDefined.GetInstance().fanCalcList.concat();
if(this._huPaiInfo.huWayList)for(var i=0,a=0,o=0;o<this._huPaiInfo.huWayList.length;o++){var r=this._huPaiInfo.huWayList[o];if(r){i=0,e=new Array,ArrayUtil.Clear(this._exclude);for(var s=0;s<n.length;s++){var l=n[s];if(l){var c=this[l.funcName];c?i+=this.addFanNum(r,l,e,c):console.error("未找到算番的方法："+l.funcName)}}for(var h=0;h<this._exclude.length;h++){var d=FanCalcDefined.GetInstance().getDefinition(this._exclude[h],n);ArrayUtil.RemoveItem(d,e,-1)}i>a&&(a=i,t=e.concat())}}return t},e.prototype.addFanNum=function(e,t,n,i){var a=0;if("yaoJiuKe"==t.funcName){for(var o=!1,r=0;r<e.sequenceList.length;r++){var s=e.sequenceList[r],l=s[0];this.isKeZi(s)&&(this.isYao(l)||this.isJiu(l))&&(a+=t.fan,n.push(t),o=!0)}o&&this.runExclude(t)}else a=i(e,t,this),a>0&&(n.push(t),this.runExclude(t));return a},e.prototype.runExclude=function(e){e.exclude&&e.exclude.length>0&&(this._exclude=this._exclude.concat(e.exclude))},e.prototype.tianHu=function(e,t,n){return n._huPaiInfo.isTianHu?t.fan:0},e.prototype.diHu=function(e,t,n){return n._huPaiInfo.isDiHu?t.fan:0},e.prototype.daSanYuan=function(e,t,n){var i=e.pairList[0];if(n.isJian(i))return 0;var a=n.getKeZiGroup(e);if(a.length<3)return 0;for(var o=jianList.concat(),r=0;r<a.length;r++){var s=a[r][0];if(ArrayUtil.RemoveItem(s,o),o.length<=0)return t.fan}return 0},e.prototype.jiuLianBaoDeng=function(e,t,n){var i=n.qingYiSe(e,t,n);if(0==i)return 0;for(var a=new Array,o=0;o<e.pairList.length;o++)a.push(n.getIndex(e.pairList[o]));for(var o=0;o<e.sequenceList.length;o++)for(var r=0;r<e.sequenceList[o].length;r++)a.push(n.getIndex(e.sequenceList[o][r]));for(var o=0;9>o;o++)ArrayUtil.RemoveItem(o,a);for(var o=0;2>o;o++)ArrayUtil.RemoveItem(0,a);for(var o=0;2>o;o++)ArrayUtil.RemoveItem(8,a);return 1==a.length?t.fan:0},e.prototype.siGang=function(e,t,n){var i=n.getAnGangNum()+n.getMingGangNum();return 4==i?t.fan:0},e.prototype.qingYaoJiu=function(e,t,n){var i=e.pairList[0];if(!n.isYao(i)&&!n.isJiu(i))return 0;var a=n.getKeZiGroup(e);if(a.length<4)return 0;for(var o=0;o<a.length;o++){var r=a[o][0];if(!n.isYao(r)&&!n.isJiu(r))return 0}return t.fan},e.prototype.xiaoSanYuan=function(e,t,n){var i=e.pairList[0];if(!n.isJian(i))return 0;var a=jianList.concat();ArrayUtil.RemoveItem(i,a);var o=n.getKeZiGroup(e);if(o.length<2)return 0;for(var r=0;r<o.length;r++){var s=o[r][0];if(ArrayUtil.RemoveItem(s,a),a.length<=0)return t.fan}return 0},e.prototype.siAnKe=function(e,t,n){var i=n.getAnKeNum(e);return 4==i?t.fan:0},e.prototype.yiSeShuangLongHui=function(e,t,n){if(!n.isDaiWu(e.pairList))return 0;var i=n.getLaoShaoFu(e);if(2>i)return 0;var a=e.pairList[0],o=HuCard.getCardType(a),r=new Array;r.push(o);for(var s=0;s<e.sequenceList.length;s++){var l=e.sequenceList[s],c=l[0];if(o=HuCard.getCardType(c),-1==r.indexOf(o)&&r.push(o),r.length>1)return 0}return t.fan},e.prototype.yiSeSiTongShun=function(e,t,n){var i=n.getShunZiGroup(e);if(i.length<4)return 0;for(var a=i[0],o=a[0],r=0,s=1;s<i.length;s++){var l=i[s],c=l[0];if(n.isTongSe(o,c)&&o==c&&(r++,r>=3))return t.fan}return 0},e.prototype.yiSeSiJieGao=function(e,t,n){var i=n.getKeZiGroup(e);if(i.length<4)return 0;for(var a=0;a<i.length;a++){var o=i[a],r=o[0];if(n.isJian(r))return 0;for(var s=!1,l=!1,c=!1,h=0;h<i.length;h++){var d=i[h],u=d[0];if(!s&&n.isTongSe(r,u)&&r==u-1&&(s=!0),!l&&n.isTongSe(r,u)&&r==u-2&&(l=!0),!c&&n.isTongSe(r,u)&&r==u-3&&(c=!0),s&&l&&c)return t.fan}}return 0},e.prototype.yiSeSiBuGao=function(e,t,n){var i=e.pairList[0];if(!n.isJian(i)&&!n.isTongSe(i,e.sequenceList[0][0]))return 0;var a=n.getShunZiGroup(e);if(a.length<4)return 0;for(var o=1;2>=o;o++)for(var r=0;r<a.length;r++){var s=a[r],l=s[0];if(n.isJian(l))return 0;for(var c=!1,h=!1,d=!1,u=0;u<a.length;u++){var p=a[u],g=p[0];if(!c&&n.isTongSe(l,g)&&l==g-1*o&&(c=!0),!h&&n.isTongSe(l,g)&&l==g-2*o&&(h=!0),!d&&n.isTongSe(l,g)&&l==g-3*o&&(d=!0),c&&h&&d)return t.fan}}return 0},e.prototype.sanGang=function(e,t,n){var i=n.getMingGangNum()+n.getAnGangNum();return 3==i?t.fan:0},e.prototype.hunYaoJiu=function(e,t,n){var i=e.pairList[0];if(n.isYao(i)||n.isJiu(i)||n.isJian(i)){var a=n.getKeZiGroup(e);if(a.length<4)return 0;for(var o=0;o<a.length;o++){var r=a[o][0];if(!(n.isYao(r)||n.isJiu(r)||n.isJian(r)))return 0}return t.fan}return 0},e.prototype.quanShuangKe=function(e,t,n){var i=e.pairList[0];if(n.isJian(i)||!n.isDoubleIndex(i))return 0;var a=n.getKeZiGroup(e);if(a.length<4)return 0;for(var o=0;o<a.length;o++)if(!n.isDoubleIndex(a[o][0]))return 0;return t.fan},e.prototype.qingYiSe=function(e,t,n){var i=e.pairList[0];if(n.isJian(i))return 0;for(var a=0;a<e.sequenceList.length;a++)for(var o=e.sequenceList[a],r=0;r<o.length;r++){var s=o[r];if(!n.isTongSe(i,s))return 0}return t.fan},e.prototype.yiSeSanTongShun=function(e,t,n){var i=n.getShunZiGroup(e);if(i.length<3)return 0;for(var a=0;a<i.length;a++)for(var o=i[a],r=o[0],s=0,l=0;l<i.length;l++){var c=i[l],h=c[0];if(n.isTongSe(r,h)&&r==h&&s++,s>=3)return t.fan}return 0},e.prototype.yiSeSanJieGao=function(e,t,n){var i=n.getKeZiGroup(e);if(i.length<3)return 0;for(var a=0;a<i.length;a++){var o=i[a];if(n.isKeZi(o))for(var r=o[0],s=!1,l=!1,c=0;c<i.length;c++){var h=i[c];if(n.isKeZi(h)){var d=h[0];if(!n.isJian(d)&&(!s&&n.isTongSe(r,d)&&r==d-1&&(s=!0),!l&&n.isTongSe(r,d)&&r==d-2&&(l=!0),s&&l))return t.fan}}}return 0},e.prototype.quanDa=function(e,t,n){var i=e.pairList[0];if(n.isJian(i)||n.getIndex(i)<6)return 0;for(var a=0;a<e.sequenceList.length;a++){var o=e.sequenceList[a],r=o[0];if(n.isJian(r)||n.getIndex(r)<6)return 0}return t.fan},e.prototype.quanZhong=function(e,t,n){var i=e.pairList[0];if(n.isJian(i)||n.getIndex(i)<3||n.getIndex(i)>5)return 0;for(var a=0;a<e.sequenceList.length;a++){var o=e.sequenceList[a],r=o[0];if(n.isJian(r)||n.getIndex(r)<3||n.getIndex(r)>5)return 0}return t.fan},e.prototype.quanXiao=function(e,t,n){var i=e.pairList[0];if(n.isJian(i)||n.getIndex(i)>2)return 0;for(var a=0;a<e.sequenceList.length;a++){var o=e.sequenceList[a],r=o[0];if(n.isJian(r)||n.getIndex(r)>2)return 0}return t.fan},e.prototype.qingLong=function(e,t,n){var i=n.getQingLong(e);if(i.length<=0)return 0;for(var a=new Array,o=MahJongType.None,r=0;r<i.length;r++){var s=i[r];if(o=HuCard.getCardType(s[0]),-1==a.indexOf(o)&&a.push(HuCard.getCardType(s[0])),a.length>1)return 0}return t.fan},e.prototype.sanSeShuangLongHui=function(e,t,n){if(!n.isDaiWu(e.pairList))return 0;var i=n.getLaoShaoFu(e);if(2>i)return 0;var a=HuCard.getCardType(e.pairList[0]),o=[MahJongType.Tiao,MahJongType.Wan,MahJongType.Bin];ArrayUtil.RemoveItem(a,o);for(var r=0;r<e.sequenceList.length;r++)if(a=HuCard.getCardType(e.sequenceList[r][0]),ArrayUtil.RemoveItem(a,o),0==o.length)return t.fan;return 0},e.prototype.yiSeSanBuGao=function(e,t,n){var i=n.getShunZiGroup(e);if(i.length<3)return 0;for(var a=1;2>=a;a++)for(var o=0;o<i.length;o++)for(var r=i[o],s=r[0],l=!1,c=!1,h=0;h<i.length;h++){var d=i[h],u=d[0];if(n.isTongSe(s,u)&&(l||n.getIndex(s)!=n.getIndex(u)+a?c||n.getIndex(s)!=n.getIndex(u)+2*a||(c=!0):l=!0,l&&c))return t.fan}return 0},e.prototype.quanDaiWu=function(e,t,n){if(!n.isDaiWu(e.pairList))return 0;for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(!n.isDaiWu(a))return 0}return t.fan},e.prototype.sanTongKe=function(e,t,n){var i=n.getTongKeNum(e);return i>1?t.fan:0},e.prototype.sanAnKe=function(e,t,n){var i=n.getAnKeNum(e);return i>=3?t.fan:0},e.prototype.daYuWu=function(e,t,n){var i=e.pairList[0];if(n.getIndex(i)<5||n.isJian(i))return 0;for(var a=0;a<e.sequenceList.length;a++)for(var o=e.sequenceList[a],r=0;r<o.length;r++){var s=o[r];if(n.getIndex(s)<5||n.isJian(s))return 0}return t.fan},e.prototype.xiaoYuWu=function(e,t,n){var i=e.pairList[0];if(n.getIndex(i)>3||n.isJian(i))return 0;for(var a=0;a<e.sequenceList.length;a++)for(var o=e.sequenceList[a],r=0;r<o.length;r++){var s=o[r];if(n.getIndex(s)>3||n.isJian(s))return 0}return t.fan},e.prototype.huaLong=function(e,t,n){var i=n.getQingLong(e);if(i.length<=0)return 0;for(var a=MahJongType.None,o=[MahJongType.Tiao,MahJongType.Wan,MahJongType.Bin],r=0;r<i.length;r++)if(a=HuCard.getCardType(i[r][0]),ArrayUtil.RemoveItem(a,o),0==o.length)return t.fan;return 0},e.prototype.sanSeSanTongShun=function(e,t,n){var i=n.getShunZiGroup(e);if(i.length<3)return 0;for(var a=0;a<i.length;a++){var o=i[a],r=o[0],s=new Array;s.push(HuCard.getCardType(r));for(var l=0;l<i.length;l++){var c=i[l],h=c[0],d=HuCard.getCardType(h);if(-1==s.indexOf(d)&&n.getIndex(r)==n.getIndex(h)&&(s.push(d),s.length>=3))return t.fan}}return 0},e.prototype.sanSeSanJieGao=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i],o=a[0];if(n.isKeZi(a)&&!n.isJian(o)){var r=new Array;r.push(HuCard.getCardType(o));for(var s=!1,l=!1,c=0;c<e.sequenceList.length;c++){var h=e.sequenceList[c],d=h[0];if(n.isKeZi(h)&&!n.isJian(d)){var u=HuCard.getCardType(d);if(-1==r.indexOf(u)&&(s||n.getIndex(o)!=n.getIndex(d)+1?l||n.getIndex(o)!=n.getIndex(d)+2||(l=!0,r.push(u)):(s=!0,r.push(u)),s&&l))return t.fan}}}}return 0},e.prototype.miaoShouHuiChun=function(e,t,n){var i=n.getRemainNum();return n._huPaiInfo.isZiMo&&n._huPaiInfo.isHaiDiLaoYue?t.fan:i>0||!n._huPaiInfo.isZiMo?0:t.fan},e.prototype.haiDiLaoYue=function(e,t,n){var i=n.getRemainNum();return!n._huPaiInfo.isZiMo&&n._huPaiInfo.isHaiDiLaoYue?t.fan:i>0||n._huPaiInfo.isZiMo?0:t.fan},e.prototype.gangShangKaiHua=function(e,t,n){return n._huPaiInfo.isGangShangKaiHua?t.fan:0},e.prototype.pengPengHu=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++)if(!n.isKeZi(e.sequenceList[i]))return 0;return t.fan},e.prototype.hunYiSe=function(e,t,n){var i=new Array;i.push(HuCard.getCardType(e.pairList[0]));for(var a=0;a<e.sequenceList.length;a++){var o=HuCard.getCardType(e.sequenceList[a][0]);-1==i.indexOf(o)&&i.push(o)}return-1!=i.indexOf(MahJongType.Baida)&&2==i.length?t.fan:0},e.prototype.sanSeSanBuGao=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i],o=a[0];if(n.isShunZi(a)){var r=new Array;r.push(HuCard.getCardType(o));for(var s=!1,l=!1,c=0;c<e.sequenceList.length;c++){var h=e.sequenceList[c];if(n.isShunZi(h)){var d=h[0],u=HuCard.getCardType(d);if(-1==r.indexOf(u)&&(s||n.getIndex(o)!=n.getIndex(d)+1?l||n.getIndex(o)!=n.getIndex(d)+2||(l=!0,r.push(u)):(s=!0,r.push(u)),s&&l))return t.fan}}}}return 0},e.prototype.shuangAnGang=function(e,t,n){var i=n.getAnGangNum();return 2==i?t.fan:0},e.prototype.shuangJianKe=function(e,t,n){for(var i=0,a=0;a<e.sequenceList.length;a++){var o=e.sequenceList[a];if(n.isKeZi(o)&&n.isJian(o[0])&&(i++,i>=2))return t.fan}return 0},e.prototype.buQiuRen=function(e,t,n){var i=n.getMingGangNum();return n._huPaiInfo.pengList.length<=0&&0>=i&&n._huPaiInfo.isZiMo?t.fan:0},e.prototype.shuangMingGang=function(e,t,n){var i=n.getMingGangNum();return 2==i?t.fan:0},e.prototype.heJueZhang=function(e,t,n){var i=n.getCanSeeNum(n._huPaiInfo.winCard);return 4==i||n._huPaiInfo.isHeJueZhang?t.fan:0},e.prototype.jianKe=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isKeZi(a)&&n.isJian(a[0]))return t.fan}return 0},e.prototype.menQianQing=function(e,t,n){var i=n.getMingGangNum();return n._huPaiInfo.pengList.length<=0&&0>=i&&!n._huPaiInfo.isZiMo?t.fan:0},e.prototype.pingHu=function(e,t,n){if(n.isJian(e.pairList[0]))return 0;var i=n.getShunZiGroup(e);return 4==i.length?t.fan:0},e.prototype.shuangTongKe=function(e,t,n){var i=n.getTongKeNum(e);return i>0?t.fan:0},e.prototype.shuangAnKe=function(e,t,n){var i=n.getAnKeNum(e);return 2==i?t.fan:0},e.prototype.anGang=function(e,t,n){var i=n.getAnGangNum();return 1==i?t.fan:0},e.prototype.duanYao=function(e,t,n){var i=e.pairList[0];if(n.isYao(i)||n.isJiu(i)||n.isJian(i))return 0;for(var a=0;a<e.sequenceList.length;a++){var o=e.sequenceList[a],r=o[0],s=o[2];if(n.isYao(r)||n.isJiu(r)||n.isJian(r))return 0;if(n.isYao(s)||n.isJiu(s)||n.isJian(s))return 0}return t.fan},e.prototype.yiBanGao=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isShunZi(a))for(var o=a[0],r=i+1;r<e.sequenceList.length;r++){var s=e.sequenceList[r],l=s[0];if(n.isShunZi(s)&&o==l)return t.fan}}return 0},e.prototype.xiXiangFeng=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isShunZi(a))for(var o=a[0],r=i+1;r<e.sequenceList.length;r++){var s=e.sequenceList[r],l=s[0];if(n.isShunZi(s)&&!n.isTongSe(o,l)&&n.isSameIndex(o,l))return t.fan}}return 0},e.prototype.lianLiu=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isShunZi(a))for(var o=a[0],r=i+1;r<e.sequenceList.length;r++){var s=e.sequenceList[r],l=s[0];if(n.isShunZi(s)&&n.isTongSe(o,l)&&(o==l+3||l==o+3))return t.fan}}return 0},e.prototype.laoShaoFu=function(e,t,n){var i=n.getLaoShaoFu(e);return 1==i?t.fan:0},e.prototype.yaoJiuKe=function(e,t,n){for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i],o=a[0];if(n.isKeZi(a)&&(n.isYao(o)||n.isJiu(o)))return t.fan}return 0},e.prototype.mingGang=function(e,t,n){var i=n.getMingGangNum();return 1==i?t.fan:0},e.prototype.queYiMen=function(e,t,n){var i=[MahJongType.Tiao,MahJongType.Wan,MahJongType.Bin,MahJongType.Baida],a=HuCard.getCardType(e.pairList[0]);ArrayUtil.RemoveItem(a,i);for(var o=0;o<e.sequenceList.length;o++)a=HuCard.getCardType(e.sequenceList[o][0]),ArrayUtil.RemoveItem(a,i);var r=0;return-1!=i.indexOf(MahJongType.Tiao)&&r++,-1!=i.indexOf(MahJongType.Wan)&&r++,-1!=i.indexOf(MahJongType.Bin)&&r++,1==r?t.fan:0},e.prototype.wuZi=function(e,t,n){if(n.isJian(e.pairList[0]))return 0;for(var i=0;i<e.sequenceList.length;i++)if(n.isJian(e.sequenceList[i][0]))return 0;return t.fan},e.prototype.bianZhang=function(e,t,n){if(1==n._huPaiInfo.huWayList.length&&1==n._huPaiInfo.tingList.length)for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isShunZi(a)){if(n._huPaiInfo.winCard==a[0]&&6==n.getIndex(n._huPaiInfo.winCard))return t.fan;if(n._huPaiInfo.winCard==a[2]&&2==n.getIndex(n._huPaiInfo.winCard))return t.fan}}return 0},e.prototype.kanZhang=function(e,t,n){if(1==n._huPaiInfo.huWayList.length&&1==n._huPaiInfo.tingList.length)for(var i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n.isShunZi(a)&&n._huPaiInfo.winCard==a[1])return t.fan}return 0},e.prototype.danDiaoJiang=function(e,t,n){return-1!=e.pairList.indexOf(n._huPaiInfo.winCard)&&1==n._huPaiInfo.huWayList.length&&1==n._huPaiInfo.tingList.length?t.fan:0},e.prototype.ziMo=function(e,t,n){return n._huPaiInfo.isZiMo?t.fan:0},e.prototype.huaPai=function(e,t,n){return 0},e.prototype.getIndex=function(e){var t=HuCard.getCardType(e);switch(t){case MahJongType.Tiao:return tiaoList.indexOf(e);case MahJongType.Wan:return wanList.indexOf(e);case MahJongType.Bin:return bingList.indexOf(e);default:return-1}},e.prototype.getPaiNum=function(e,t){for(var n=0,i=0;i<e.sequenceList.length;i++)for(var a=e.sequenceList[i],o=0;o<a.length;o++)a[o]==t&&n++;return n},e.prototype.getCanSeeNum=function(e){return e>0&&e<this._huPaiInfo.canSeeList.length?this._huPaiInfo.canSeeList[e].length:0},e.prototype.getRemainNum=function(){for(var e=0,t=0;t<this._huPaiInfo.remainList.length;t++)e+=this._huPaiInfo.remainList[t].length;return e+1},e.prototype.getAnKeNum=function(e){for(var t=0,n=0,i=0;i<e.sequenceList.length;i++){var a=e.sequenceList[i];if(n=a[0],this.isKeZi(a)&&-1==this._huPaiInfo.pengList.indexOf(n)&&-1==this._huPaiInfo.mingGanList.indexOf(n))if(n==this._huPaiInfo.winCard){var o=this.getPaiNum(e,n);4==o&&t++}else t++}return t},e.prototype.getTongKeNum=function(e){for(var t=0,n=0;n<e.sequenceList.length;n++){var i=e.sequenceList[n];if(this.isKeZi(i)){for(var a=i[0],o=0,r=n+1;r<e.sequenceList.length;r++){var s=e.sequenceList[r];this.isKeZi(s)&&this.isSameIndex(a,s[0])&&!this.isJian(a)&&o++}o>t&&(t=o)}}return t},e.prototype.getLaoShaoFu=function(e){for(var t=0,n=e.sequenceList.concat(),i=n.length-1;i>=0;i--)if(i<n.length){var a=n[i],o=a[0];if(this.isShunZi(a)&&this.isYao(o))for(var r=0;r<n.length;r++){var s=n[r],l=s[2];if(this.isTongSe(o,l)&&this.isShunZi(s)&&this.isJiu(l)){t++,ArrayUtil.RemoveItem(a,n),ArrayUtil.RemoveItem(s,n);break}}}return t},e.prototype.getQingLong=function(e){for(var t,n=0;n<e.sequenceList.length;n++){t=new Array;var i=e.sequenceList[n],a=i[0];if(this.isShunZi(i)&&!this.isJian(a)){t.push(i);for(var o=!1,r=!1,s=0;s<e.sequenceList.length;s++){var l=e.sequenceList[s];if(this.isShunZi(l)){var c=l[0];if(o||this.getIndex(a)!=this.getIndex(c)+3?r||this.getIndex(a)!=this.getIndex(c)+6||(r=!0,t.push(l)):(o=!0,t.push(l)),t.length>=3)return t}}}}return new Array},e.prototype.getShunZiGroup=function(e){for(var t=new Array,n=0;n<e.sequenceList.length;n++){var i=e.sequenceList[n];this.isShunZi(i)&&t.push(i)}return t},e.prototype.getKeZiGroup=function(e){for(var t=new Array,n=0;n<e.sequenceList.length;n++){var i=e.sequenceList[n];this.isKeZi(i)&&t.push(i)}return t},e.prototype.getMingGangNum=function(){return this._huPaiInfo.mingGanList.length},e.prototype.getAnGangNum=function(){return this._huPaiInfo.anGangList.length},e.prototype.isShunZi=function(e){var t=e[0];return e&&e.length>=3&&t!=e[1]&&!this.isJian(t)?!0:!1},e.prototype.isKeZi=function(e){return e&&e.length>=3&&e[0]==e[1]?!0:!1},e.prototype.isYao=function(e){return e==tiaoList[0]||e==wanList[0]||e==bingList[0]?!0:!1},e.prototype.isJiu=function(e){return e==tiaoList[sequenceNumEnd]||e==wanList[sequenceNumEnd]||e==bingList[sequenceNumEnd]?!0:!1},e.prototype.isJian=function(e){return HuCard.getCardType(e)==MahJongType.Baida},e.prototype.isTongSe=function(e,t){var n=HuCard.getCardType(e),i=HuCard.getCardType(t);return n==i&&n!=MahJongType.Baida&&n!=MahJongType.None?!0:!1},e.prototype.isSameIndex=function(e,t){return this.getIndex(e)==this.getIndex(t)?!0:!1},e.prototype.isDaiWu=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(this.isJian(n))return!1;if(4==this.getIndex(n))return!0}return!1},e.prototype.isDoubleIndex=function(t){return-1!=e.doubleArray.indexOf(this.getIndex(t))},e}();CalculateFan.oneEnd=2,CalculateFan.doubleArray=[1,3,5,7],__reflect(CalculateFan.prototype,"CalculateFan");var ChannelManager=function(){function e(){}return e.sdkInitComplete=function(t){e._isInitComplete=!0;var n=JSON.parse(t);e._channelType=n.channelType,e._appName=n.appName,e._deviceId=n.deviceId,e._bundleId=n.bundleId,e._clientVersion=n.clientVersion,e._hasWeixin=StringUtil.toBoolean(n.hasWeixin),e._hasMicrophone=StringUtil.toBoolean(n.hasMicrophone),StringUtil.isNullOrEmpty(e._channelType)&&(e._channelType=e._operatePlatform),e.OnInitComplete.dispatch()},e.sdkLoginSucceed=function(t){e.OnTokenLoginSucceed.dispatch(t)},e.sdkLoginFailed=function(){e.OnLoginFailed.dispatch()},e.sdkPaySucceed=function(t){e._channel.sdkPaySucceed(t)},e.sdkPayFailed=function(){e._channel.sdkPayFailed()},e.sdkShareSucceed=function(){e.OnShareSucceed.dispatch()},e.sdkShareFailed=function(){e.OnShareFailed.dispatch()},e.sdkLogout=function(){e.OnLogout.dispatch()},e.sdkRecordComplete=function(e){RecordAudioManager.RecordComplete(e)},e.sdkBackToApplication=function(){e.OnBackToApplication.dispatch()},e.sdkHotUpdateComplete=function(){e.OnHotUpdateComplete.dispatch()},e.sdkHasRecordData=function(e){ChatManager.checkComplete(e)},Object.defineProperty(e,"operatePlatform",{get:function(){return e._operatePlatform},enumerable:!0,configurable:!0}),Object.defineProperty(e,"channelType",{get:function(){return e._customChannelType?e._customChannelType:e._channelType},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginType",{get:function(){return e._customLoginType?e._customLoginType:e._loginType},set:function(t){e._loginType=t},enumerable:!0,configurable:!0}),e.SetCustomLoginChannel=function(t,n){e._customChannelType=t,e._customLoginType=n},e.GetLoginChannel=function(){return ChannelUtil.GetLoginChannel(e.channelType,e.loginType)},Object.defineProperty(e,"appName",{get:function(){return e._appName},enumerable:!0,configurable:!0}),Object.defineProperty(e,"deviceId",{get:function(){return e._deviceId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"bundleId",{get:function(){return e._bundleId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasWeixin",{get:function(){return e._hasWeixin},enumerable:!0,configurable:!0}),Object.defineProperty(e,"hasMicrophone",{get:function(){return e._hasMicrophone},enumerable:!0,configurable:!0}),Object.defineProperty(e,"clientVersion",{get:function(){return e._clientVersion},enumerable:!0,configurable:!0}),e.Initialize=function(){return e._isInitComplete?void e.OnInitComplete.dispatch():(e._operatePlatform=OperatePlatform.current,"iOS"==egret.Capabilities.os?e._channel=new Channel_ios:"Android"==egret.Capabilities.os?e._channel=new Channel_android:e._channel=new Channel_web,egret.ExternalInterface.addCallback(ExtFuncName.OnApplicationFocus,function(t){var n=StringUtil.toBoolean(t);e.OnApplicationFocus.dispatch(n)}),egret.ExternalInterface.addCallback(ExtFuncName.OnInitComplete,e.sdkInitComplete),egret.ExternalInterface.addCallback(ExtFuncName.OnLoginSucceed,e.sdkLoginSucceed),egret.ExternalInterface.addCallback(ExtFuncName.OnLoginFailed,e.sdkLoginFailed),egret.ExternalInterface.addCallback(ExtFuncName.OnPaySucceed,e.sdkPaySucceed),egret.ExternalInterface.addCallback(ExtFuncName.OnPayFailed,e.sdkPayFailed),egret.ExternalInterface.addCallback(ExtFuncName.OnShareSucceed,e.sdkShareSucceed),egret.ExternalInterface.addCallback(ExtFuncName.OnShareFailed,e.sdkShareFailed),egret.ExternalInterface.addCallback(ExtFuncName.OnLogout,e.sdkLogout),egret.ExternalInterface.addCallback(ExtFuncName.OnBackToApplication,e.sdkBackToApplication),egret.ExternalInterface.addCallback(ExtFuncName.OnHotUpdate,e.sdkHotUpdateComplete),egret.ExternalInterface.addCallback(ExtFuncName.OnRecordComplete,e.sdkRecordComplete),egret.ExternalInterface.addCallback(ExtFuncName.OnHasRecordData,e.sdkHasRecordData),void e._channel.Initialize())},e.Login=function(t,n){void 0===n&&(n=!1),e._channel.Login(t,n)},e.Logout=function(){e._channel.Logout()},e.PaySend=function(t){var n=ShoppingDefined.GetInstance().getDefinition(t,ShoppingDefined.GetInstance().shoppingList),i=StringConstant.empty;if(n){var a=AwardDefined.GetInstance().getAwardDefinition(n.awardId);if(a&&a.rewardNum.length>0){var o=a.rewardNum[0];if(o>0){i=n.awardId.toString();var r=ChannelUtil.GenerateOrder(n.awardId,VersionManager.isClientTest);e._channel.PaySend(UserManager.serverInfo.id,r,o,i)}else console.log("支付异常")}}},e.Exit=function(){e._channel.Exit()},e.SetExtData=function(){var t={};t.channelToken=LoginManager.channelToken,t.userId=LoginManager.loginInfo.userid,t.loginChannel=e.GetLoginChannel(),e._channel.SetExtData(JSON.stringify(t))},e.SetChannelData=function(t,n){e._channel.SetChannelData(t,n)},e.CheckPayOrder=function(){e._channel.CheckPayOrder()},e.loginValidateFail=function(){e._channel.loginValidateFail()},e.share=function(e){},e.requestMicrophone=function(){e._channel.requestMicrophone()},e.recordAudio=function(t){RecordAudioManager.RecordVoice(t),e._channel.recordAudio(t.toString())},e.hotUpdate=function(t){e._channel.hotUpdate(t)},e.setRecordData=function(t,n){e._channel.setRecordData(t,n)},e.checkAudioCachePath=function(){e._channel.checkAudioCachePath()},e.hasRecordData=function(t){e._channel.hasRecordData(t)},e.playRecord=function(t){e._channel.playRecord(t)},e.DispatchAccountLoginSucceed=function(t,n,i){void 0===i&&(i=!1),e.OnAccountLoginSucceed.dispatch([t,n,i])},e}();ChannelManager._channelType=StringConstant.empty,ChannelManager._customChannelType=null,ChannelManager._customLoginType=null,ChannelManager._isInitComplete=!1,ChannelManager.OnApplicationFocus=new ActionDispatcher,ChannelManager.OnTokenDebug=new ActionDispatcher,ChannelManager.OnAccountLoginSucceed=new ActionDispatcher,ChannelManager.OnInitComplete=new ActionDispatcher,ChannelManager.OnHotUpdateComplete=new ActionDispatcher,ChannelManager.OnTokenLoginSucceed=new ActionDispatcher,ChannelManager.OnLoginFailed=new ActionDispatcher,ChannelManager.OnLogout=new ActionDispatcher,ChannelManager.OnBackToApplication=new ActionDispatcher,ChannelManager.OnShareSucceed=new ActionDispatcher,ChannelManager.OnShareFailed=new ActionDispatcher,__reflect(ChannelManager.prototype,"ChannelManager");var ChannelUtil=function(){function e(){}return e.IsOrderIlleg=function(t){if(!t)return!0;var n=t.split("-");return n.length!=e.OrderLength?!0:!1},e.GenerateOrder=function(e,t){var n=t?"1":"0",i=LoginManager.loginInfo.userid+"-"+UserManager.userInfo.roleId+"-"+UserManager.serverInfo.id+"-"+e+"-"+n+"-"+DateTimeUtil.formatTimestamp(TimeManager.GetServerUtcTimestamp()).substring(4);return i.length>30&&(i=i.substring(0,30)),i},e.GetLoginChannel=function(e,t){return t?StringUtil.format("{0}_{1}",e,t):e},e}();ChannelUtil.OrderLength=6,__reflect(ChannelUtil.prototype,"ChannelUtil");var ExtFuncName=function(){function e(){}return e}();ExtFuncName.OnApplicationFocus="OnApplicationFocus",ExtFuncName.OnInitComplete="OnInitComplete",ExtFuncName.OnLoginSucceed="OnLoginSucceed",ExtFuncName.OnLoginFailed="OnLoginFailed",ExtFuncName.OnPaySucceed="OnPaySucceed",ExtFuncName.OnPayFailed="OnPayFailed",ExtFuncName.OnShareSucceed="OnShareSucceed",ExtFuncName.OnShareFailed="OnShareFailed",ExtFuncName.OnLogout="OnLogout",ExtFuncName.OnRecordComplete="OnRecordComplete",ExtFuncName.OnBackToApplication="OnBackToApplication",ExtFuncName.OnHotUpdate="OnHotUpdate",ExtFuncName.OnHasRecordData="OnHasRecordData",ExtFuncName.Initialize="Initialize",ExtFuncName.Login="Login",ExtFuncName.Pay="Pay",ExtFuncName.Logout="Logout",ExtFuncName.SetExtData="SetExtData",ExtFuncName.SetChannelData="SetChannelData",ExtFuncName.Share="Share",ExtFuncName.RequestMicrophone="RequestMicrophone",ExtFuncName.RecordAudio="RecordAudio",ExtFuncName.SwitchToGame="SwitchToGame",ExtFuncName.HotUpdate="HotUpdate",ExtFuncName.SetRecordData="SetRecordData",ExtFuncName.StopRecord="StopRecord",ExtFuncName.CheckAudioCachePath="CheckAudioCachePath",ExtFuncName.HasRecordData="HasRecordData",ExtFuncName.PlayRecord="PlayRecord",ExtFuncName.LoginValidateFail="LoginValidateFail",__reflect(ExtFuncName.prototype,"ExtFuncName");var UpLoader=function(){function e(){}return e.UpLoad=function(t,n,i,a,o,r,s){void 0===o&&(o=null),void 0===r&&(r=null),StringUtil.isNullOrEmpty(t)||(e._uploadQueue.unshift(new UpLoadData(t,n,i,a,o,r,s)),e.UpLoadNext())},e.UpLoadNext=function(){if(0==e._isUpLoading)if(0!=e._uploadQueue.length){(new egret.URLRequest).data,e._isUpLoading=!0;var t=e._uploadQueue[0];e._upLoader=new egret.HttpRequest,e._upLoader.responseType=egret.HttpResponseType.TEXT,e._upLoader.open(t.url,egret.HttpMethod.POST),e._upLoader.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e._upLoader.addEventListener(egret.Event.COMPLETE,e.OnLoadCompleted,this),e._upLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,e.OnLoadIOError,this),e._upLoader.url=t.url;var n=StringConstant.empty;n+="&sign="+encodeURIComponent(t.sign),n+="&pvp="+encodeURIComponent(t.bytes),e._upLoader.send(n)}else e.disposeLoader()},e.disposeLoader=function(){e._upLoader&&(e._upLoader.removeEventListener(egret.Event.COMPLETE,e.OnLoadCompleted,this),e._upLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.OnLoadIOError,this),e._upLoader=null)},e.OnLoadCompleted=function(t){e._isUpLoading=!1;for(var n,i=t.currentTarget,a=e._uploadQueue.length-1;a>=0;a--)n=e._uploadQueue[a],n&&n.url==i.url&&(console.log("上传成功key："+n.sign),e._uploadQueue.splice(a,1),n.complete&&(n.thisObj?n.complete.call(n.thisObj,n):n.complete(n)));e.UpLoadNext()},e.OnLoadIOError=function(t){e._isUpLoading=!1;for(var n,i=t.currentTarget,a=e._uploadQueue.length-1;a>=0;a--)n=e._uploadQueue[a],n&&n.url==i.url&&(e._uploadQueue.splice(a,1),n.error&&(n.thisObj?n.error.call(n.thisObj,t):n.error(t)));n&&n.isReTry?e.reTry(n):e.UpLoadNext()},e.reTry=function(t){console.log("重试key："+t.sign),t.reTryCount<e.ReTryMax&&(t.reTryCount++,e._uploadQueue.unshift(t),e.UpLoadNext())},e}();UpLoader.ReTryMax=2,UpLoader._uploadQueue=new Array,UpLoader._isUpLoading=!1,__reflect(UpLoader.prototype,"UpLoader");var UpLoadData=function(){function e(e,t,n,i,a,o,r){void 0===a&&(a=null),void 0===o&&(o=null),this.url=e,this.sign=t,this.reTryCount=0,this.isReTry=i,this.complete=a,this.error=o,this.bytes=n,this.thisObj=r}return e.prototype.dispose=function(){this.thisObj=null},e}();__reflect(UpLoadData.prototype,"UpLoadData");var URLLoader=function(){function e(){}return e.cancelLoad=function(t){for(var n=e._waitList.length-1;n>=0;n--){var i=e._waitList[n];i.onComplete==t&&(i.dispose(),e._waitList.splice(n,1))}0==e._waitList.length&&(e._isLoading=!1,e.disposeLoader())},e.CancelAll=function(){e._isLoading=!1;for(var t=0,n=e._waitList;t<n.length;t++){var i=n[t];i.dispose()}e._waitList.length=0,e.disposeLoader()},e.disposeLoader=function(){e._httpRequest&&(e._httpRequest.abort(),e._httpRequest.removeEventListener(egret.Event.COMPLETE,e.OnLoadCompleted,this),e._httpRequest.removeEventListener(egret.IOErrorEvent.IO_ERROR,e.OnLoadIOError,this),e._httpRequest=null)},e.downloadContent=function(t,n,i,a,o){void 0===i&&(i=null),void 0===a&&(a=null);var r=new URLLoadInfo;r.url=t,r.thisObject=o,r.dataFormat=n,r.onComplete=i,r.onError=a,e._waitList.push(r),e.LoadNext()},e.LoadNext=function(){if(0==e._isLoading&&(e.disposeLoader(),e._waitList.length>0)){e._isLoading=!0;var t=e._waitList[0];e._httpRequest=new egret.HttpRequest,e._httpRequest.addEventListener(egret.Event.COMPLETE,e.OnLoadCompleted,this),e._httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,e.OnLoadIOError,this),e._httpRequest.open(t.url,egret.HttpMethod.POST),e._httpRequest.url=t.url,e._httpRequest.send()}},e.OnLoadCompleted=function(t){for(var n,i=t.currentTarget,a=i.response,o=e._waitList.length-1;o>=0;o--)n=e._waitList[o],n&&n.url==i.url&&(e._waitList.splice(o,1),n.onComplete&&(n.thisObject?n.onComplete.call(n.thisObject,a):n.onComplete(a)),n.dispose());e._isLoading=!1,e.LoadNext()},e.OnLoadIOError=function(t){for(var n,i=t.currentTarget,a=e._waitList.length-1;a>=0;a--)n=e._waitList[a],n&&n.url==i.url&&(e._waitList.splice(a,1),n.onError&&(n.thisObject?n.onError.call(n.thisObject,t):n.onError(t)),n.dispose());e._isLoading=!1,e.LoadNext()},e}();URLLoader._waitList=new Array,URLLoader._isLoading=!1,__reflect(URLLoader.prototype,"URLLoader");var URLLoadInfo=function(){function e(){}return e.prototype.dispose=function(){this.onComplete=null,this.onError=null,this.onProgress=null,this.thisObject=null},e}();__reflect(URLLoadInfo.prototype,"URLLoadInfo");var NetUtil=function(){function e(){}return e.Log=function(e){},e.AlertResultError=function(e,t){void 0===t&&(t=null);var n=new AlertInfo;n.message=ErrorDefined.GetInstance().getDetails(e.error),n.OnConfirm=t,console.warn(StringUtil.format("{0},描述：{1}",n.subTitle,n.message)),AlertManager.showAlert(n)},e.AlertFailing=function(e,t){var n=new AlertInfo;n.title="连接失败",n.confirmLabel="重新登录",n.subTitle=e,n.message="登录验证失效或服务器主动断开连接，点击确认重新登录游戏！",n.OnConfirm=t,AlertManager.showAlert(n)},e.AlertNetworkErrorReLogin=function(e,t){var n=new AlertInfo;n.title="网络断开",n.confirmLabel="重新登录",n.subTitle=e,n.message="登录验证已失效，点击确认重新登录游戏！",n.OnConfirm=t,AlertManager.showAlert(n)},e.AlertConnectError=function(e,t,n,i){void 0===n&&(n="网络断开"),void 0===i&&(i="网络连接断开，请检查您的网络是否正常，点击确认重试！");var a=new AlertInfo;a.title=n,a.subTitle=e,a.confirmLabel="重连",a.message=i,a.OnConfirm=t,AlertManager.showAlert(a)},e.AlertHandshakeError=function(e,t){var n=new AlertInfo;n.title="验证错误",n.subTitle=e;var i=parseInt(e);0!=i?n.message=ErrorDefined.GetInstance().getDetails(i):n.message="连接服务器验证错误",n.confirmLabel="重连",n.OnConfirm=t,AlertManager.showAlert(n)},e}();__reflect(NetUtil.prototype,"NetUtil");var SocketManager=function(){function e(){}return e.AddIgnoreError=function(t){e._ignoreError||(e._ignoreError=new Array),-1==e._ignoreError.indexOf(t)&&e._ignoreError.push(t)},e.RemoveIgnoreError=function(t){ArrayUtil.RemoveItem(t,e._ignoreError)},e.Initialize=function(t,n,i,a,o,r,s,l){void 0===l&&(l=egret.WebSocket.TYPE_BINARY),e._isReconnecting=!1,e._socket||(e._socket=new GameSocket,e._socket.addNormalError(e.ResetRoleInfoErrorCode),e._socket.initialize(t,n,i,a,o,r,s,l),e._socket.AddMessageListener(e.OnMessage),e.AddCommandListener(Command.System_Heartbeat_3016,e.OnHeartbeatServer))
},Object.defineProperty(e,"roleId",{get:function(){return e._socket.roleId},enumerable:!0,configurable:!0}),Object.defineProperty(e,"requestSessionMax",{get:function(){return e._socket.requestSessionMax},enumerable:!0,configurable:!0}),e.Dispose=function(){e._socket&&(egret.clearTimeout(e._delayId),e.RemoveCommandListener(Command.System_Heartbeat_3016,e.OnHeartbeatServer),e._socket.RemoveMessageListener(e.OnMessage),e.StopHeartbeat(),e.RemoveAllListener(),e._socket.dispose(),e._socket=null)},e.Close=function(t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e._socket&&(egret.clearTimeout(e._delayId),n&&e.StopHeartbeat(),e.RemoveAllListener(),e._socket.close(t))},e.Connect=function(t,n,i){if(void 0===i&&(i=!0),null==e._socket)throw new Error("socket no initialize");i&&UIManager.showPanel(UIModuleName.LoadingPanel),e.AddAllListener(),e._socket.Connect(t,n)},e.Reconnect=function(){e.VerifyReLogin()?AlertManager.showAlertObj({confirmLabel:"登录失效",message:"登录验证失效，请重新登录游戏！",OnConfirm:e.OnClickReconnect}):(e._isReconnecting=!0,e.Connect(e._socket.address,e._socket.port))},e.AddAllListener=function(){e._socket.AddResultListener(e.OnResult),UIManager.addEventListener(UIModuleName.LoadingPanel,UIModuleEvent.OnTimeout,e.OnLoadingTimeout,this)},e.RemoveAllListener=function(){UIManager.removeEventListener(UIModuleName.LoadingPanel,UIModuleEvent.OnTimeout,e.OnLoadingTimeout),e._socket.RemoveResultListener(e.OnResult)},e.OnLoadingTimeout=function(){e.Close(),AlertManager.showAlertObj({confirmLabel:"网络超时",message:"网络连接超时，请检查您的网络是否正常并重试！",OnConfirm:e.OnClickReconnect})},e.Send=function(t,n){return void 0===n&&(n=null),e.InvokeSend(!1,t,n,!0)},e.SendDiscRetry=function(t,n){return void 0===n&&(n=null),e.InvokeSend(!0,t,n,!0)},e.ImplSend=function(t,n){return void 0===n&&(n=null),e.InvokeSend(!1,t,n)},e.ImplSendDiscRetry=function(t,n){return void 0===n&&(n=null),e.InvokeSend(!0,t,n)},e.InvokeSend=function(t,n,i,a){return void 0===i&&(i=null),void 0===a&&(a=!1),e._socket.enabledSend?a&&UIManager.showPanel(UIModuleName.LoadingPanel):console.log("禁止发送:"+n),e._socket.InvokeSend(t,n,i)},e.InternalImplSend=function(t,n){return void 0===n&&(n=null),e._socket.InvokeSend(!1,t,n)},e.AddCommandListener=function(t,n,i){null!=e._socket&&null!=n&&t?e._socket.AddCommandListener(t,n,i):console.error("AddCommandListener:socket no initialize")},e.RemoveCommandListener=function(t,n){null!=e._socket&&e._socket.RemoveCommandListener(t,n)},e.AddErrorListener=function(t,n,i){null!=e._socket?e._socket.AddErrorListener(t,n,i):console.error("AddCommandListener:socket no initialize")},e.RemoveErrorListener=function(t,n){null!=e._socket&&e._socket.RemoveErrorListener(t,n)},e.DispatchResultError=function(t){if(e.OnResultError)for(var n=0,i=e.OnResultError;n<i.length;n++){var a=i[n];a(t)}},e.DispatchEnterError=function(){e.OnEnterError.dispatch()},e.DispatchConnect=function(){e.OnConnect.dispatch()},e.OnResult=function(t){e._lastTimestamp=egret.getTimer(),t.op==SpRpcOp.Response?(e._heartbeatTime=egret.getTimer(),UIManager.closePanel(UIModuleName.LoadingPanel),0!=t.error&&(t.error==e.ResetRoleInfoErrorCode?GameManager.initServerHandler.AfreshGetInfo():e._ignoreError&&-1!=e._ignoreError.indexOf(t.error)||(e.isEntering?NetUtil.AlertResultError(t,e.OnClickEnterError):(NetUtil.AlertResultError(t),e.DispatchResultError(t.error))))):t.cmdId==Command.System_Response_Login_2013&&(UIManager.closePanel(UIModuleName.LoadingPanel),e.Close(),AlertManager.showAlertObj({title:"提示",message:"该账号在其它地方登录，确定回到登录界面。",OnConfirm:e.OnClickReLogin}))},e.OnMessage=function(t){switch(NetUtil.Log(t),t.type){case SocketMessageType.Connect:UIManager.closePanel(UIModuleName.LoadingPanel),console.log("游戏服务器连接成功"),e._autoReconnect=!0,e._socket.InvokeDiscRetry(),e._isReconnecting&&(e._isReconnecting=!1),e.StartHeartbeat(),e.DispatchConnect();break;case SocketMessageType.Failing:UIManager.closePanel(UIModuleName.LoadingPanel),e.Close(),NetUtil.AlertFailing(t.errorCode,e.OnClickReLogin);break;case SocketMessageType.NetworkError:UIManager.closePanel(UIModuleName.LoadingPanel),e.VerifyReLogin()?(e.Close(),NetUtil.AlertNetworkErrorReLogin(t.errorCode,e.OnClickReLogin)):e.isEntering?(e.Close(),NetUtil.AlertConnectError(t.errorCode,e.OnClickReconnect)):(e.Close(),e._autoReconnect?e._delayId=egret.setTimeout(e.delayAutoReconnect,this,2e3):t.type==SocketMessageType.NetworkError?NetUtil.AlertConnectError(t.errorCode,e.OnClickReconnect):t.type==SocketMessageType.Failing&&NetUtil.AlertConnectError(t.errorCode,e.OnClickReconnect,"连接失败","登录验证失效或服务器主动断开连接！"));break;case SocketMessageType.HandshakeError:UIManager.closePanel(UIModuleName.LoadingPanel),e.Close(),NetUtil.AlertNetworkErrorReLogin(t.errorCode,e.OnClickReLogin)}},e.delayAutoReconnect=function(){e._autoReconnect=!1,e.Reconnect()},e.VerifyReLogin=function(){return TimeManager.GetServerUtcTimestamp()-e._lastTimestamp<270?!1:TimeManager.GetCurrentOnlineLength()<1500?!1:!0},e.OnClickReLogin=function(t){e.isEntering?e.DispatchEnterError():GameManager.reLogin()},e.OnClickReconnect=function(t){e.isEntering?e.DispatchEnterError():e.Reconnect()},e.OnClickEnterError=function(t){e.DispatchEnterError()},e.StartHeartbeat=function(){e._heartbeatTime=egret.getTimer(),Tick.getInstance().AddSecondsInvoke(e.OnTickHeartbeat)},e.StopHeartbeat=function(){Tick.getInstance().RemoveSecondsInvoke(e.OnTickHeartbeat)},e.OnTickHeartbeat=function(t){egret.getTimer()-e._heartbeatTime>=e.HeartbeatInterval&&(e._heartbeatTime=egret.getTimer(),e.InternalImplSend(Command.System_Heartbeat_3016,{sessionId:e._socket.requestSessionMax}))},e.OnHeartbeatServer=function(e){TimeManager.SetServerTimestamp(e.data)},e}();SocketManager.ResetRoleInfoErrorCode=201,SocketManager.HeartbeatInterval=6e4,SocketManager.isEntering=!1,SocketManager._isReconnecting=!1,SocketManager._autoReconnect=!1,SocketManager._delayId=void 0,SocketManager.OnEnterError=new ActionDispatcher,SocketManager.OnConnect=new ActionDispatcher,__reflect(SocketManager.prototype,"SocketManager");var TimeManager=function(){function e(){}return e.initialize=function(t){t&&(e._timeZone=0,t.timezone&&(e._timeZone=1e3*t.timezone),e._loginTimestamp=0,t.timestamp&&(e._loginTimestamp=t.timestamp,e.SetServerTimestamp(t)))},e.SetServerTimestamp=function(t){e._serverTimestamp=0,t.timestamp&&(e._serverTimestamp=1e3*t.timestamp),e._serverSyncDateTime=new Date},e.GetCurrentOnlineLength=function(){return e.GetServerUtcTimestamp()-e._loginTimestamp},e.GetServerTimeZone=function(){return e._timeZone},e.GetServerUtcMilliTimestamp=function(){return 0==e._serverTimestamp?0:e._serverTimestamp+(Date.now()-Date.parse(e._serverSyncDateTime.toUTCString()))},e.GetServerUtcTimestamp=function(){return e.GetServerUtcMilliTimestamp()/1e3},e.GetServerLocalDateTime=function(t){void 0===t&&(t=0);var n,i;return 0!=t?(i=e.GetServerUtcMilliTimestamp()+3600*t*1e3,n=new Date(i)):(i=e.GetServerUtcMilliTimestamp(),n=new Date,n.setTime(i),n)},e.GetFiveRefreshLocalTime=function(){var t=e.GetServerLocalDateTime();return new Date(t.getFullYear(),t.getMonth(),t.getDay(),5)},e}();TimeManager._serverTimestamp=0,TimeManager._loginTimestamp=0,TimeManager.Utc1970=new Date(1970,1,1,0,0,0,0),__reflect(TimeManager.prototype,"TimeManager");var wanList=[1,2,3,4,5,6,7,8,9],bingList=[10,11,12,13,14,15,16,17,18],tiaoList=[19,20,21,22,23,24,25,26,27],baiDaList=[28],sequenceNumEnd=8,jianList=[28],HuCard=function(){function e(){this.shouPaiList=new Array,this._operdShouPaiList=new Array,this._mybaiDaList=new Array,this._tmpLen=0,this._ting=[],this._wanGroupNum=0,this._binGroupNum=0,this._tiaoGroupNum=0,this.tingList=new Array}return e.prototype.clear=function(){ArrayUtil.Clear(this.shouPaiList)},e.prototype.startListen=function(e,t){this.shouPaiList=e;var n=new ListenResultInfo;if(n.outCard=t,this.shouPaiList.length>=GameSetting.ZhuangJiaShouPaiNum)return console.log("成牌数量不对，数量："+this.shouPaiList.length),n;if(this.reset(),this.checkFour()){for(var i=1;i<baiDaList[0];i++){var a=new ListenInfo;a.pai=i,a.fan=1;var o=PaiDefined.GetInstance().getDefinition(i,PaiDefined.GetInstance().paiList);a.name=o.name,a.remainNum=GoCardProcessManager.getListenerCardNum(i),this.tingList.push(a)}n.listenerList=this.tingList}else this.setGroupNum(),this.checkTingAll(),n.listenerList=this.tingList;return n},e.prototype.checkTingAll=function(){for(var e=1;e<=baiDaList[0];e++)e>1&&this._operdShouPaiList.pop(),this._operdShouPaiList.push(e),this.tmpPaiList=this._operdShouPaiList.concat(),this.checkTingPai(e);this._operdShouPaiList.pop()},e.prototype.setGroupNum=function(){this._wanGroupNum=0,this._binGroupNum=0,this._tiaoGroupNum=0,this.isCheck8()&&(this._wanGroupNum=this.getGroupCardNum(MahJongType.Wan),this._binGroupNum=this.getGroupCardNum(MahJongType.Bin),this._tiaoGroupNum=this.getGroupCardNum(MahJongType.Tiao))},e.prototype.tryHu=function(e){return this.shouPaiList=e,e?e.length%3!=2?(console.log("成牌数量不对，数量："+e.length),!1):(this.reset(),this.checkFour()?!0:(this.setGroupNum(),RoomManager.roomInfo.myLastCard?(this.tmpPaiList=this._operdShouPaiList.concat(),this.checkTingPai(RoomManager.roomInfo.myLastCard),this._operdShouPaiList.pop(),this.tingList.length>0):!1)):void 0},e.prototype.checkFour=function(){this.tmpPaiList=this.shouPaiList.concat();var e=this.getTmpPaiList(baiDaList[0]);return 4==e?!0:!1},e.prototype.reset=function(){this.tingList=new Array,this._tmpLen=0,this._ting=[],this._operdShouPaiList=this.shouPaiList.concat()},e.prototype.checkTingPai=function(e){if(2==this.tmpPaiList.length)(-1!=this.tmpPaiList.indexOf(baiDaList[0])||this.tmpPaiList[0]==this.tmpPaiList[1])&&this.addTingInfo(e);else for(var t=this.tmpPaiList.length-1;t>=0;t--){var n=this.tmpPaiList[t],i=this.getTmpPaiList(n);this._hasBaidaNum=this.getTmpPaiList(baiDaList[0]);var a=this._hasBaidaNum+i;a>=2&&(this._hasBaidaNum>=1&&this.startCheck(n,e,1),this._hasBaidaNum>=2&&(this.tmpPaiList=this._operdShouPaiList.concat(),this.startCheck(n,e,2)),i>=2&&(this.tmpPaiList=this._operdShouPaiList.concat(),this.startCheck(n,e,0))),this.tmpPaiList=this._operdShouPaiList.concat()}},e.prototype.startCheck=function(t,n,i){for(var a=0;2-i>a;a++)ArrayUtil.RemoveItem(t,this.tmpPaiList);this.useUpBaiDa(i);var o=0,r=0,s=0;switch(e.getCardType(t)){case MahJongType.Wan:o=2;break;case MahJongType.Bin:r=2;break;case MahJongType.Tiao:s=2;break;case MahJongType.Baida:o=2,r=2,s=2}this._hasBaidaNum=this.getTmpPaiList(baiDaList[0]),this.tmpPaiList.sort(this.sort);var l=this.getPaiNumByType(MahJongType.Wan),c=l.length;this._baidaUseNum=i;var h,d,u,p=this._baidaUseNum,g=this.check_3n(l,!1);g=g&&this._baidaUseNum<=this._hasBaidaNum;var f=!1;if(!g&&(this._baidaUseNum=p,l=this.getPaiNumByType(MahJongType.Wan),f=this.check_3n(l,!0),f=f&&this._baidaUseNum<=this._hasBaidaNum,!f))return void(this._baidaUseNum=p);if(h=this._wanGroupNum+o+c+this._baidaUseNum-p>=8,c=0,g||f){if(l=this.getPaiNumByType(MahJongType.Bin),c=l.length,p=this._baidaUseNum,g=this.check_3n(l,!1),g=g&&this._baidaUseNum<=this._hasBaidaNum,!g&&(this._baidaUseNum=p,l=this.getPaiNumByType(MahJongType.Bin),f=this.check_3n(l,!0),f=f&&this._baidaUseNum<=this._hasBaidaNum,!f))return void(this._baidaUseNum=p);if(d=this._binGroupNum+r+c+this._baidaUseNum-p>=8,c=0,g||f){if(l=this.getPaiNumByType(MahJongType.Tiao),c=l.length,p=this._baidaUseNum,g=this.check_3n(l,!1),g=g&&this._baidaUseNum<=this._hasBaidaNum,!g&&(this._baidaUseNum=p,l=this.getPaiNumByType(MahJongType.Tiao),f=this.check_3n(l,!0),f=f&&this._baidaUseNum<=this._hasBaidaNum,!f))return void(this._baidaUseNum=p);u=this._tiaoGroupNum+s+c+this._baidaUseNum-p>=8,c=0,this.isCheck8()?(h||d||u)&&(g||f)&&this.addTingInfo(n):(g||f)&&this.addTingInfo(n)}}this.tingList.length>this._tmpLen&&(this._tmpLen=this.tingList.length)},e.prototype.addTingInfo=function(e){-1==this._ting.indexOf(e)&&this.pushToTingList(e)},e.prototype.isCheck8=function(){return RoomManager.roomInfo.type==PlayModeType.Hu8?!0:!1},e.prototype.pushToTingList=function(e){this._ting.push(e);var t=PaiDefined.GetInstance().getDefinition(e,PaiDefined.GetInstance().paiList),n=new ListenInfo;n.name=t.name,n.pai=e,n.fan=1,n.remainNum=GoCardProcessManager.getListenerCardNum(e),this.tingList.push(n)},e.prototype.getGroupCardNum=function(t){var n=0;if(RoomManager.mineInfo&&RoomManager.mineInfo.groupList)for(var i=void 0,a=0,o=RoomManager.mineInfo.groupList;a<o.length;a++){var r=o[a];switch(i=e.getCardType(r.card),r.action){case ActionType.AnGang:case ActionType.BuGang:case ActionType.Gang:i==t&&(n+=4);break;case ActionType.Peng:i==t&&(n+=3)}}return n},e.prototype.sort=function(e,t){return e==t?0:e>t?1:-1},e.prototype.check_3n=function(e,t){return 0==e.length?!0:(t?(this.tryRemoveKeziBaiDa(e)&&this.check_3n(e,t),this.tryRemoveShunziBaiDa(e)&&this.check_3n(e,t)):(this.tryRemoveShunziBaiDa(e)&&this.check_3n(e,t),this.tryRemoveKeziBaiDa(e)&&this.check_3n(e,t)),0==e.length)},e.prototype.tryRemoveShunziBaiDa=function(t){var n=t.length;if(0==n)return!0;if(2==n&&t[0]==t[1])return this.tryRemoveKeziBaiDa(t);if(3==n&&this.isKeZi(t))return t.length=0,!0;for(var i=0,a=!1,o=!1,r=0;n>r;r++){var s=t[r],l=e.getIndex(s);if(8==l){var c=this.useUpBaiDa(2);return c&&ArrayUtil.RemoveItem(s,t),c}if(7==l){var h=this.getRemainPaiNum(t,s+1);0>=h?i++:a=!0;var c=this.useUpBaiDa(i+1);return c&&(a&&ArrayUtil.RemoveItem(s+1,t),ArrayUtil.RemoveItem(s,t)),c}var h=this.getRemainPaiNum(t,s+1);0>=h?i++:a=!0;var d=this.getRemainPaiNum(t,s+2);0>=d?i++:o=!0;var c=this.useUpBaiDa(i);return c&&(a&&ArrayUtil.RemoveItem(s+1,t),o&&ArrayUtil.RemoveItem(s+2,t),ArrayUtil.RemoveItem(s,t)),c}return!1},e.prototype.tryRemoveKeziBaiDa=function(e){var t=e.length;if(0==t)return!0;if(2==t&&e[0]!=e[1])return this.tryRemoveShunziBaiDa(e);if(3==t&&this.isShunzi(e))return e.length=0,!0;for(var n=0;t>n;n++){var i=e[n],a=this.getRemainPaiNum(e,i);a>3&&(a=3);var o=3-a,r=this.useUpBaiDa(o);if(r)for(var s=0;a>s;s++)ArrayUtil.RemoveItem(i,e);return r}return!1},e.prototype.isKeZi=function(e){return e[0]==e[1]&&e[0]==e[2]?!0:!1},e.prototype.isShunzi=function(e){return e[2]-e[1]==1&&e[1]-e[0]==1?!0:!1},e.prototype.useUpBaiDa=function(e){return this._baidaUseNum+=e,this._baidaUseNum>this._hasBaidaNum?(this._baidaUseNum-=e,!1):!0},e.prototype.getRemainPaiNum=function(e,t){for(var n=0,i=e.length,a=0;i>a;a++)e[a]==t&&n++;return n},e.prototype.getTmpPaiList=function(e){var t=0;if(this.tmpPaiList)for(var n=this.tmpPaiList.length,i=0;n>i;i++)this.tmpPaiList[i]==e&&t++;return t},e.prototype.isExistInGroup=function(e){if(RoomManager.mineInfo&&RoomManager.mineInfo.groupList)for(var t=0,n=RoomManager.mineInfo.groupList;t<n.length;t++){var i=n[t];if(i.card==e)return!0}return!1},e.prototype.getPaiNumByType=function(t){for(var n,i=this.tmpPaiList.length,a=new Array,o=0;i>o;o++)switch(n=this.tmpPaiList[o],t){case MahJongType.Wan:e.isWan(n)&&a.push(n);break;case MahJongType.Bin:e.isTong(n)&&a.push(n);break;case MahJongType.Tiao:e.isTiao(n)&&a.push(n);break;case MahJongType.Baida:e.isBaida(n)&&a.push(n)}return a},e.getIndex=function(e){var t=wanList.indexOf(e);return-1!=t?t:(t=bingList.indexOf(e),-1!=t?t:(t=tiaoList.indexOf(e),-1!=t?t:(t=baiDaList.indexOf(e),-1!=t?t:-1)))},e.getCardType=function(t){return e.isTiao(t)?MahJongType.Tiao:e.isWan(t)?MahJongType.Wan:e.isTong(t)?MahJongType.Bin:e.isBaida(t)?MahJongType.Baida:MahJongType.None},e.isTiao=function(e){return-1!=tiaoList.indexOf(e)},e.isWan=function(e){return-1!=wanList.indexOf(e)},e.isTong=function(e){return-1!=bingList.indexOf(e)},e.isBaida=function(e){return-1!=baiDaList.indexOf(e)},e}();__reflect(HuCard.prototype,"HuCard");var HuPaiInfo=function(){function e(){this.isZiMo=!1,this.winCard=-1,this.isTianHu=!1,this.isDiHu=!1,this.isGangShangKaiHua=!1,this.isHaiDiLaoYue=!1,this.isHeJueZhang=!1,this.huaList=new Array,this.huWayList=new Array,this.pengList=new Array,this.mingGanList=new Array,this.anGangList=new Array,this.canSeeList=new Array,this.remainList=new Array,this.tingList=new Array,this.baidaList=new Array}return e}();__reflect(HuPaiInfo.prototype,"HuPaiInfo");var HuWayInfo=function(){function e(){this.pairList=new Array,this.sequenceList=new Array,this.fanList=new Array}return e}();__reflect(HuWayInfo.prototype,"HuWayInfo");var ListenInfo=function(){function e(){this.pai=-1,this.name=StringConstant.empty,this.fan=0}return e}();__reflect(ListenInfo.prototype,"ListenInfo");var ListenResultInfo=function(){function e(){}return e}();__reflect(ListenResultInfo.prototype,"ListenResultInfo");var VersionManager=function(){function e(){}return Object.defineProperty(e,"loginPort",{get:function(){return e._isClientTest?ProjectDefined.GetInstance().getValue(ProjectDefined.testPort):ProjectDefined.GetInstance().getValue(ProjectDefined.port)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"loginAddress",{get:function(){return e._isClientTest?ProjectDefined.GetInstance().getValue(ProjectDefined.testAddress):ProjectDefined.GetInstance().getValue(ProjectDefined.address)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isClientTest",{get:function(){return e._isClientTest},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isSafe",{get:function(){return e._isClientTest&&e._isSafe},enumerable:!0,configurable:!0}),e.Initialize=function(){var t;t=ChannelManager.clientVersion?ChannelManager.clientVersion:ProjectDefined.GetInstance().getValue(ProjectDefined.version),e.SetClientVersion(t)},e.loadServerVersion=function(){egret.Capabilities.runtimeType==egret.RuntimeType.WEB?ChannelManager.sdkHotUpdateComplete():RES.getResByUrl(ProjectDefined.GetInstance().getValue(ProjectDefined.versionUrl)+"?"+Date.now().toString()+Math.random().toString(),e.onLoadVersionComplete,this,RES.ResourceItem.TYPE_JSON)},e.onLoadVersionComplete=function(t){if(t){e._isSafe=StringUtil.toBoolean(t.safe),e._isMaintain=1==parseInt(t.mt);var n=t.version;e.verifyVersion(n,JSON.stringify(t))}else e.onLoadError()},e.verifyVersion=function(t,n){if(!t)return void e.onLoadError();var i=StringUtil.toIntArray(t,StringConstant.Dot);e._isClientTest=VersionUtil.CompareAllForce(e._clientVersionArray,i),i&&e._clientVersionArray&&i.length>2&&e._clientVersionArray.length>2&&egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?VersionUtil.CompareForce(i,e._clientVersionArray)?AlertManager.showSingleAlert("有新版本更新，需要更新才能进入游戏，点击确定前往更新!",e.gotoLoadNewVersion):VersionUtil.CompareOptimize(i,e._clientVersionArray)?AlertManager.showDoubleAlert("有新版本更新，是否前往更新？",e.gotoLoadNewVersion,e.verifyVersion2,null,null,null,null,null,n):e.verifyVersion2(n):ChannelManager.sdkHotUpdateComplete()},e.verifyVersion2=function(t){e._isClientTest?ChannelManager.sdkHotUpdateComplete():e._isMaintain?e.LoadMaintainTxt():ChannelManager.hotUpdate(t)},e.onLoadError=function(){AlertManager.showSingleAlert("加载版本文件失败！点击确定重新加载！",e.onReTryLoadVersion)},e.onReTryLoadVersion=function(){e.loadServerVersion()},e.SetClientVersion=function(t){e._clientVersion=t,e._clientVersionArray=StringUtil.toIntArray(t,StringConstant.Dot)},e.gotoLoadNewVersion=function(){e._updateHandler.OpenUpdateUrl()},e.VerifyGameServer=function(t){var n=StringUtil.toIntArray(t,StringConstant.Dot);if(e._clientVersionArray[0]!=n[0]||e._clientVersionArray[1]<n[1]){var i=new AlertInfo;return i.title="版本错误",i.message="客户端版本与服务器版本不匹配，请更新客户端再进游戏。",i.confirmLabel="前往下载",i.OnConfirm=e.gotoLoadNewVersion,AlertManager.showAlert(i),!1}return!0},e.LoadMaintainTxt=function(){RES.getResByUrl(ProjectDefined.GetInstance().getValue(ProjectDefined.maintainUrl)+"?"+Date.now().toString()+Math.random().toString(),e.OnMaintainComplete,this,RES.ResourceItem.TYPE_TEXT)},e.OnMaintainComplete=function(t){t?AlertManager.showSingleAlert(t.text,e.onReTryLoadVersion):AlertManager.showSingleAlert("游戏停机维护中，届时将无法登录游戏，请各位相互转告。具体开服时间可能会根据实际情况通告，敬请谅解。",e.onReTryLoadVersion)},e.setComponentVisibleBySafe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(null!=t)if(e.isSafe)for(var i=0;i<t.length;i++)t[i]&&(t[i].visible=!1);else for(var i=0;i<t.length;i++)t[i]&&(t[i].visible=!0)},e}();VersionManager._isSafe=!1,VersionManager._updateHandler=new UpdateHandler,__reflect(VersionManager.prototype,"VersionManager");var VersionUtil=function(){function e(){}return e.CompareAllForce=function(e,t){if(null==e||e.length<=0)return!1;if(null==t||t.length<=0)return!0;if(e[0]>t[0])return!0;if(e[0]==t[0]){if(e[1]>t[1])return!0;if(e[1]==t[1]&&e[2]>t[2])return!0}return!1},e.CompareForce=function(e,t){return null==e||e.length<=0?!1:null==t||t.length<=0?!0:e[0]>t[0]?!0:e[0]==t[0]&&e[1]>t[1]?!0:!1},e.CompareOptimize=function(e,t){return e&&t&&t.length==e.length&&t.length>2?e[0]==t[0]&&e[1]==t[1]&&e[2]>t[2]:!1},e}();__reflect(VersionUtil.prototype,"VersionUtil");var AwardDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.awardConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){this.awardDefinitionDic=new Dictionary;var e=DefinedManager.GetData(t.awardConfig);this.awardDefinitionList=ShortNameDefined.GetInstance().convertEnter(e);for(var n=0,i=this.awardDefinitionList;n<i.length;n++){var a=i[n];this.awardDefinitionDic.add(a.id,a)}},t.prototype.getAwardDefinition=function(e){for(var n=0,i=t.GetInstance().awardDefinitionList;n<i.length;n++){var a=i[n];if(a.id==e)return a}return null},t.prototype.getPrevIdIsNull=function(e){var t=this.getAwardDefinition(e);return null==t.preId},t}(BaseDefined);AwardDefined.awardConfig="award",__reflect(AwardDefined.prototype,"AwardDefined");var AwardDefinition=function(){function e(){}return e}();__reflect(AwardDefinition.prototype,"AwardDefinition",["IBaseDefintion"]);var GameProcesser=function(){function e(e){this._maiMaGap=10,this._onceResultTimeGap=3e3,this.testIndex=1,this._gameScenePanel=e,this.layerController||(this.layerController=new LayerController),this.layerController.init(this._gameScenePanel.cardGroup),this._huCard=new HuCard,this._shouCardController=new ShouCardController(this._gameScenePanel.tweenGroup),this._outCardController=new OutCardController(this.layerController),this._groupCardController=new GroupCardController(this._gameScenePanel.tweenGroup,this.layerController),this._cardWall=new CardWallHandler(this.layerController.getContainer(GameSetting.CardWallLayerBenJia),this.layerController.getContainer(GameSetting.CardWallOther)),this._listenerInfoList=new Array,GoCardProcessManager.isReady=!1}return Object.defineProperty(e.prototype,"gameScenePanel",{get:function(){return this._gameScenePanel},enumerable:!0,configurable:!0}),e.prototype.onEnable=function(){RoomManager.otherPlayerJoinEA.addListener(this.onPlayerJoin,this),GoCardProcessManager.touziResultEa.addListener(this.runCardWall,this),GoCardProcessManager.alreadyInRoomEa.addListener(this.showCardWall,this),GoCardProcessManager.shouPaiResultEa.addListener(this.showShouPai,this),GoCardProcessManager.moPaiResultEa.addListener(this.showBenJiaLastCard,this),GoCardProcessManager.moPaiEa.addListener(this.showMoPai,this),GoCardProcessManager.outCardEa.addListener(this.putOutCard,this),RoomManager.reqExitRoomEA.addListener(this.clear,this),GoCardProcessManager.pushPengEa.addListener(this.pushPengHandler,this),GoCardProcessManager.pushGangEa.addListener(this.pushGangHandler,this),GoCardProcessManager.pushTingEa.addListener(this.pushTingHandler,this),GoCardProcessManager.passEa.addListener(this.onPassHandler,this),GoCardProcessManager.tingCardEa.addListener(this.onTingHandler,this),GoCardProcessManager.buyHorseEa.addListener(this.onBuyHorseHandler,this),GoCardProcessManager.onceResultEa.addListener(this.pushOnceResultHandler,this),GoCardProcessManager.onGoOnGameEa.addListener(this.onGoOnGameHandler,this),GoCardProcessManager.onGameOverEa.addListener(this.onGameOverhandler,this),GoCardProcessManager.huPaiEa.addListener(this.onHuPaiHandler,this),GoCardProcessManager.pushHuCardEa.addListener(this.pushHuPaiHandler,this),GoCardProcessManager.pushPlayerReadyEa.addListener(this.pushPlayerReadyHandler,this),RoomManager.headChangeEa.addListener(this.headChangeHandler,this),GoCardProcessManager.pushScoreChangeEa.addListener(this.pushScoreChangeHandler,this),RoomManager.posChangeEa.addListener(this.posChangeHandler,this),RoomManager.playerExitRoomEa.addListener(this.pushPlayerExitRoom,this),GoCardProcessManager.pushPlayerHostedEa.addListener(this.pushPlayerHosted,this),GoCardProcessManager.pushPlayerOfflineEa.addListener(this.pushPlayerOffline,this)},e.prototype.onDisable=function(){RoomManager.otherPlayerJoinEA.removeListener(this.onPlayerJoin),GoCardProcessManager.touziResultEa.removeListener(this.runCardWall),GoCardProcessManager.alreadyInRoomEa.removeListener(this.showCardWall),GoCardProcessManager.shouPaiResultEa.removeListener(this.showShouPai),GoCardProcessManager.moPaiResultEa.removeListener(this.showBenJiaLastCard),GoCardProcessManager.moPaiEa.removeListener(this.showMoPai),GoCardProcessManager.outCardEa.removeListener(this.putOutCard),RoomManager.reqExitRoomEA.removeListener(this.clear),GoCardProcessManager.pushPengEa.removeListener(this.pushPengHandler),GoCardProcessManager.pushGangEa.removeListener(this.pushGangHandler),GoCardProcessManager.pushTingEa.removeListener(this.pushTingHandler),GoCardProcessManager.passEa.removeListener(this.onPassHandler),GoCardProcessManager.tingCardEa.removeListener(this.onTingHandler),GoCardProcessManager.buyHorseEa.removeListener(this.onBuyHorseHandler),GoCardProcessManager.onceResultEa.removeListener(this.pushOnceResultHandler),GoCardProcessManager.onGoOnGameEa.removeListener(this.onGoOnGameHandler),GoCardProcessManager.onGameOverEa.removeListener(this.onGameOverhandler),GoCardProcessManager.huPaiEa.removeListener(this.onHuPaiHandler),GoCardProcessManager.pushHuCardEa.removeListener(this.pushHuPaiHandler),GoCardProcessManager.pushPlayerReadyEa.removeListener(this.pushPlayerReadyHandler),RoomManager.headChangeEa.removeListener(this.headChangeHandler),GoCardProcessManager.pushScoreChangeEa.removeListener(this.pushScoreChangeHandler),RoomManager.posChangeEa.removeListener(this.posChangeHandler),RoomManager.playerExitRoomEa.removeListener(this.pushPlayerExitRoom),GoCardProcessManager.pushPlayerHostedEa.removeListener(this.pushPlayerHosted),GoCardProcessManager.pushPlayerOfflineEa.removeListener(this.pushPlayerOffline),clearTimeout(this._onceResultTimeId),clearTimeout(this._maiMaTimeId)},e.prototype.exactlyBenJiaCard=function(){this._shouCardController.initExactlyCard()},e.prototype.shouCardHandlerInit=function(e){this._shouCardController.init(e)},e.prototype.showTingInfoPanel=function(){if(GoCardProcessManager.curOutCard)this._shouCardController.showTingInfo(GoCardProcessManager.curOutCard.cardNum);else if(RoomManager.roomInfo&&RoomManager.roomInfo.shouPai)if(RoomManager.roomInfo.myLastCard){var e=RoomManager.roomInfo.shouPai.concat();RoomManager.isSelfAction&&ArrayUtil.RemoveItem(RoomManager.roomInfo.myLastCard,e);var t=this.checkTingShouPai(e,RoomManager.roomInfo.myLastCard);t&&UIManager.showPanel(UIModuleName.TingInfoPanel,t)}else{var t=this.checkTingShouPai(RoomManager.roomInfo.shouPai.concat());t&&UIManager.showPanel(UIModuleName.TingInfoPanel,t)}},e.prototype.runFaPai=function(){this._cardWall.runFaPai(this._shouCardController.runGetCard,this._shouCardController)},e.prototype.showLastCard=function(){this.showPutCountDown(),this._shouCardController.showLastCard(),this._cardWall.showCardWall(),RoomManager.roomInfo&&this.checkSelfHuTingGang(RoomManager.roomInfo.myLastCard)},e.prototype.onPlayerJoin=function(e){if(e){var t=RoomManager.mineInfo;if(!t)return;var n=RoomManager.getPosTypeForMine(e.pos);this._gameScenePanel.onPlayerJoin(e,n)}},e.prototype.runCardWall=function(){RoomManager.setMod(),this._gameScenePanel.refreshWaitTime(void 0),this.clear(),this._gameScenePanel.nextRound(),this._cardWall.runCardWall()},e.prototype.showCardWall=function(){if(RoomManager.roomInfo&&RoomManager.mineInfo)if(GoCardProcessManager.isReady=!0,this._gameScenePanel.hideActionBtn(),this._gameScenePanel.refreshHeadInfo(),this._gameScenePanel.refreshHotedBtn(),RoomManager.setMod(),RoomManager.roomInfo.play==RoomState.NIL)this.gameScenePanel.refreshWaitTime(RoomManager.waitReadyTime),this._gameScenePanel.showPaiPosGroup(!1),RoomManager.mineInfo&&!RoomManager.mineInfo.isReady&&UIManager.showPanel(UIModuleName.OnceResultPanel);else{if(this._cardWall.showCardWall(),this._shouCardController.init(!0),this._outCardController.showPai(),this._groupCardController.showPai(),this._gameScenePanel.actionTimeLabel.visible=!0,RoomManager.roomInfo.play==RoomState.WAIT)this._shouCardController.initExactlyCard(),void 0!=RoomManager.roomInfo.boomCard?RoomManager.roomInfo.boomPos!=RoomManager.mineInfo.pos&&this.checkJiaGangHu(RoomManager.roomInfo.boomCard):RoomManager.roomInfo.pos!=RoomManager.mineInfo.pos&&void 0!=RoomManager.roomInfo.lastCard&&(this.actionClear(),this._isCanPeng=this.checkPeng(RoomManager.getPosTypeForMine(RoomManager.roomInfo.pos),RoomManager.roomInfo.lastCard),this._isCanGang=this.checkGang(RoomManager.getPosTypeForMine(RoomManager.roomInfo.pos),RoomManager.roomInfo.lastCard),this.refreshActionBtnState()),this.tryTing();else if(RoomManager.roomInfo.play==RoomState.PUT)RoomManager.roomInfo.pos==RoomManager.mineInfo.pos?void 0==RoomManager.roomInfo.myLastCard?(this.pengLastCardOper(),this._shouCardController.initExactlyCard(!0),this._shouCardController.pengExactlyCard(PosType.BenJia),this.actionClear(),this._isCanTing=this.checkTing(),this.refreshActionBtnState()):(this._shouCardController.initExactlyCard(),this.checkSelfHuTingGang()):this._shouCardController.initExactlyCard(),this.tryTing();else if(RoomManager.roomInfo.play==RoomState.HU){var e=(ArrayUtil.RemoveItem(RoomManager.roomInfo.myLastCard,RoomManager.roomInfo.shouPai),RoomManager.getPlayerInfoByPos(RoomManager.roomInfo.boomPos));e&&(GoCardProcessManager.huCardInfo.card=RoomManager.roomInfo.boomCard,GoCardProcessManager.huCardInfo.roleId=e.roleId,GoCardProcessManager.reqBuyHorse())}else RoomManager.roomInfo.play==RoomState.TAKE&&(this._shouCardController.initExactlyCard(),console.log("摸牌状态"));this._isFirstMoPai=!1,this.showPutCountDown()}},e.prototype.tryTing=function(){RoomManager.roomInfo.shouPai&&RoomManager.roomInfo.shouPai.length<=GameSetting.ZhuangJiaShouPaiNum&&this.refreshTingBtnState()},e.prototype.refreshTingBtnState=function(){var e=RoomManager.roomInfo.shouPai.concat();RoomManager.roomInfo.myLastCard&&RoomManager.isSelfAction&&ArrayUtil.RemoveItem(RoomManager.roomInfo.myLastCard,e);var t=this.checkTingShouPai(e);t?this._gameScenePanel.refreshTingHelpBtn(!0):this._gameScenePanel.refreshTingHelpBtn(!1)},e.prototype.testShowPeng=function(e){this._groupCardController.addGroup(PosType.XiaJia,GroupCardType.PengShangJia,RoomManager.roomInfo.shouPai[6]);var t=UIManager.getPanel(UIModuleName.GameScenePanel);console.log("游戏场景面板："+t.tweenGroup.x),this.testIndex++,this.testIndex>6&&(this.testIndex=1)},e.prototype.testBuGang=function(e){this._groupCardController.addBuGangGroup(PosType.ShangJia,GroupCardType.GangShangJia,4)},e.prototype.showShouPai=function(){this._gameScenePanel.refreshWind()},e.prototype.showBenJiaLastCard=function(e){RoomManager.mineInfo&&RoomManager.mineInfo.isTing?(this.isCanHu=this.checkHu(),this.refreshActionBtnState(),GoCardProcessManager.isReady&&this._shouCardController.setNewCard(PosType.BenJia,e),this.isCanHu||(this._gameScenePanel.tingOutCardTime=egret.getTimer())):GoCardProcessManager.isReady&&(this._shouCardController.setNewCard(PosType.BenJia,e),this.checkSelfHuTingGang(e))},e.prototype.checkSelfHuTingGang=function(e){this.actionClear(),this.isCanHu=this.checkHu(),this._isCanTing=this.checkTing(),this._isCanGang=this.checkGang(PosType.BenJia,e,!0),this.refreshActionBtnState()},e.prototype.showMoPai=function(e){GoCardProcessManager.isReady&&(e&&e!=PosType.BenJia&&this._shouCardController.setNewCard(e),RoomManager.roomInfo&&this.updateCardWall(1),this.showPutCountDown())},e.prototype.updateCardWall=function(e,t){RoomManager.updateHead(e),this._gameScenePanel.refreshRemainLabel(),this._cardWall.showCardWall(t)
},e.prototype.showPutCountDown=function(){this._isFirstMoPai?(this._isFirstMoPai=!1,this._gameScenePanel.refreshTime(ProjectDefined.GetInstance().getValue(ProjectDefined.initPutTimeOutClient))):this._gameScenePanel.refreshTime(ProjectDefined.GetInstance().getValue(ProjectDefined.putTimeoutClient))},e.prototype.putOutCard=function(e){if(e&&e.length>1&&RoomManager.roomInfo){var t=e[0],n=RoomManager.getPosTypeForMine(t),i=e[1];this.timeClear(),n==PosType.BenJia?(RoomManager.mineInfo.isTing?this.putOutLastCard(n):GoCardProcessManager.curOutCard?(this._shouCardController.outCard(n,GoCardProcessManager.curOutCard),GoCardProcessManager.curOutCard&&!GoCardProcessManager.curOutCard.isLastCard&&this._shouCardController.startInsert(n,RoomManager.roomInfo.myLastCard),RoomManager.roomInfo.myLastCard=void 0,GoCardProcessManager.curOutCard=void 0,this.actionClear(),this.refreshTingBtnState()):i==RoomManager.roomInfo.myLastCard&&this.putOutLastCard(n),this._gameScenePanel.hideActionBtn(),this._shouCardController.refreshTingState(null),UIManager.closePanel(UIModuleName.TingInfoPanel),this.canGangList&&this.canGangList.length>1&&(this._gameScenePanel.showCancelBtn(!1),UIManager.closePanel(UIModuleName.GangSelectPanel))):(this._shouCardController.outCard(n),this._shouCardController.startInsert(n),RoomManager.roomInfo&&RoomManager.roomInfo.shouPai&&(this.actionClear(),this._isCanPeng=this.checkPeng(n,i),this._isCanGang=this.checkGang(n,i,!1),this.refreshActionBtnState())),this._outCardController.addPai(n,i)}},e.prototype.putOutLastCard=function(e){this._shouCardController.outCard(e,null,!0),RoomManager.roomInfo&&(RoomManager.roomInfo.myLastCard=void 0)},e.prototype.refreshActionBtnState=function(){var e=this._isCanPeng||this._isCanGang||this._isCanTing||this.isCanHu;this._gameScenePanel.showBtnState(this._gameScenePanel.pengBtn,this._isCanPeng),this._gameScenePanel.showBtnState(this._gameScenePanel.gangBtn,this._isCanGang),this._gameScenePanel.showBtnState(this._gameScenePanel.huBtn,this.isCanHu),this.isCanHu?this._gameScenePanel.showBtnState(this._gameScenePanel.tingBtn,!1):this._gameScenePanel.showBtnState(this._gameScenePanel.tingBtn,this._isCanTing),this._gameScenePanel.showGuoBtn(e)},e.prototype.timeClear=function(){clearInterval(this._gangTimeId),clearInterval(this._pengTimeId)},e.prototype.actionClear=function(){this.isCanHu=!1,this._isCanGang=!1,this._isCanPeng=!1,this._isCanTing=!1},e.prototype.clear=function(){this.timeClear(),this.actionClear(),ArrayUtil.Clear(this.canGangList),this._isFirstMoPai=!0,GoCardProcessManager.isReady=!1,this._cardWall.clear(),this._outCardController.clear(),this._groupCardController.clear(),this._shouCardController.clear(),this._gameScenePanel.clear(),this._gameScenePanel.refreshWaitTime(void 0),this._huCard.clear(),RoomManager.nextRoundOper(),RoomManager.roundNumOper(),GoCardProcessManager.isClickTingBtn=!1,GoCardProcessManager.huCardInfo.reset(),GoCardProcessManager.buyHorseInfo.reset(),GoCardProcessManager.clearReqFlag()},e.prototype.pushPengHandler=function(e){var t=e[0],n=e[1],i=e[2],a=RoomManager.getPlayerInfoByRoleId(n);if(a){var o=RoomManager.getPosType(a.pos,i);this._groupCardController.addGroup(a.pos,o-1,t),a.pos==RoomManager.mineInfo.pos&&RoomManager.roomInfo&&RoomManager.roomInfo.shouPai&&(this.setInAction(!1),this.pengLastCardOper()),this._gameScenePanel.refreshTime(ProjectDefined.GetInstance().getValue(ProjectDefined.putTimeoutClient)),o=RoomManager.getPosTypeByRoleId(n),this._gameScenePanel.showActionEffect(ActionType.Peng,o),this._shouCardController.pengExactlyCard(o),a.pos==RoomManager.mineInfo.pos?(this.actionClear(),this._isCanTing=this.checkTing(),this.refreshActionBtnState()):this._shouCardController.setNewCard(o),o=RoomManager.getPosTypeForMine(i),this._outCardController.removePai(o,t)}},e.prototype.pengLastCardOper=function(){RoomManager.roomInfo.shouPai.sort(SortUtil.downSort);for(var e,t=RoomManager.roomInfo.shouPai.length,n=!1,i=0;t>i;i++)if(e=RoomManager.roomInfo.shouPai[i],-1==baiDaList.indexOf(e)){n=!0,RoomManager.roomInfo.myLastCard=e;break}!n&&t>0&&(RoomManager.roomInfo.myLastCard=RoomManager.roomInfo.shouPai[t-1])},e.prototype.pushGangHandler=function(e){var t,n=e[0],i=e[1],a=e[2],o=e[3],r=RoomManager.getPlayerInfoByRoleId(i);r&&(t=RoomManager.getPosTypeForMine(r.pos),this._gameScenePanel.showActionEffect(ActionType.Gang,t),RoomManager.mineInfo&&r.pos==RoomManager.mineInfo.pos&&this.setInAction(!1),o==ActionType.Gang?(this.showGang(r,a,n),this._shouCardController.immediatelyInsert(t),this.clearLastCardState(i)):o==ActionType.AnGang?(this._groupCardController.addGroup(r.pos,GroupCardType.AnGang,n),UIManager.closePanel(UIModuleName.GangSelectPanel),this._gameScenePanel.showCancelBtn(!1),this._shouCardController.immediatelyInsert(t),this.clearLastCardState(i)):o==ActionType.BuGang&&(this.showGang(r,a,n,!0),UIManager.closePanel(UIModuleName.GangSelectPanel),this._gameScenePanel.showCancelBtn(!1),this._shouCardController.immediatelyInsert(t),i!=UserManager.userInfo.roleId?this.checkJiaGangHu(n):(this.actionClear(),this.refreshActionBtnState(),this._shouCardController.refreshTingState(null))))},e.prototype.clearLastCardState=function(e){if(e==UserManager.userInfo.roleId){var t=GameSetting.CardTotalNum-RoomManager.roomInfo.head;0>=t&&(this.actionClear(),this.refreshActionBtnState(),this._shouCardController.refreshTingState(null))}},e.prototype.checkJiaGangHu=function(e){this.actionClear(),this.isCanHu=this.checkHu(e),this.isCanHu&&this.setInAction(!0),this.refreshActionBtnState()},e.prototype.showGang=function(e,t,n,i){void 0===i&&(i=!1);var a;if(t){if(e){var o=RoomManager.getPosType(e.pos,t);a=o+2,i||(o=RoomManager.getPosTypeForMine(t),this._outCardController.removePai(o,n))}}else{var r=GoCardProcessManager.getGroupCardForMine(n);r&&(a=r.pos+2)}e&&(i?this._groupCardController.addBuGangGroup(e.pos,a,n):this._groupCardController.addGroup(e.pos,a,n))},e.prototype.pushTingHandler=function(e){var t=e[0],n=e[1],i=RoomManager.getPosTypeByRoleId(t);i==PosType.BenJia&&this._gameScenePanel.hideActionBtn(),this._gameScenePanel.showTing(t,n),this._gameScenePanel.showActionEffect(ActionType.Ting,i)},e.prototype.onPassHandler=function(){this._gameScenePanel.hideActionBtn(),this.setInAction(!1)},e.prototype.onTingHandler=function(){this._gameScenePanel.hideActionBtn()},e.prototype.onBuyHorseHandler=function(){var e=RoomManager.getPlayerInfoByRoleId(GoCardProcessManager.buyHorseInfo.roleId);if(e){var t=RoomManager.getPosTypeForMine(e.pos);void 0!=GoCardProcessManager.buyHorseInfo.card1&&0!=GoCardProcessManager.buyHorseInfo.card1||void 0!=GoCardProcessManager.buyHorseInfo.card2&&0!=GoCardProcessManager.buyHorseInfo.card2?(this._onceResultTimeGap=3e3,clearTimeout(this._showHorseAnimId),this._showHorseAnimId=egret.setTimeout(this.showBuyHorseAnimation,this,1e3,t)):(this._onceResultTimeGap=800,this.showBuyHorseCard(t))}},e.prototype.showBuyHorseAnimation=function(e){clearTimeout(this._showHorseAnimId),this._gameScenePanel.showActionEffect(ActionType.MaiMa,e),clearTimeout(this._buyHorseTimeId),this._buyHorseTimeId=egret.setTimeout(this.showBuyHorseCard,this,1e3,e);var t=RoomManager.getPlayerInfoByRoleId(GoCardProcessManager.buyHorseInfo.roleId);t&&SoundManager.playEffect(t.sex,MusicAction.maima)},e.prototype.showBuyHorseCard=function(e){if(clearTimeout(this._buyHorseTimeId),GoCardProcessManager.buyHorseInfo){var t=0;void 0!=GoCardProcessManager.buyHorseInfo.card1&&0!=GoCardProcessManager.buyHorseInfo.card1&&t++,void 0!=GoCardProcessManager.buyHorseInfo.card2&&0!=GoCardProcessManager.buyHorseInfo.card2&&t++,this.updateCardWall(t,GoCardProcessManager.lastMastPos),this._outCardController.shoBuyHorse(e,GoCardProcessManager.buyHorseInfo.card1,GoCardProcessManager.buyHorseInfo.card2)}clearTimeout(this._buyHorseScoreId),this._buyHorseScoreId=egret.setTimeout(this.showBuyHorseScore,this,200)},e.prototype.showBuyHorseScore=function(){clearTimeout(this._buyHorseScoreId),GoCardProcessManager.lastScoreChangeType==ScoreChangeType.MaiMa&&this._gameScenePanel.showScoreEffect()},e.prototype.pushOnceResultHandler=function(){for(var e=0,t=GoCardProcessManager.onceResultInfoList;e<t.length;e++){var n=t[e];this._shouCardController.showLiangPai(n.roleId,n.shouPai)}this._onceResultTimeId=egret.setTimeout(this.delayShowResultPanel,this,this._onceResultTimeGap),this.gameScenePanel.refreshHeadInfo(),this.gameScenePanel.refreshTime(void 0)},e.prototype.delayShowResultPanel=function(){clearTimeout(this._onceResultTimeId),RoomManager.roomInfo&&UIManager.showPanel(UIModuleName.OnceResultPanel)},e.prototype.onGoOnGameHandler=function(){UIManager.closePanel(UIModuleName.OnceResultPanel),GoCardProcessManager.state!=GameSceneState.Processing&&GoCardProcessManager.state!=GameSceneState.RunFapai&&RoomManager.roomInfo&&RoomManager.roomInfo.roundNum>0&&this._gameScenePanel.refreshWaitTime(RoomManager.waitReadyTime),this._gameScenePanel.refreshWind(!0)},e.prototype.onGameOverhandler=function(){UIManager.showPanel(UIModuleName.GameOverPanel)},e.prototype.onHuPaiHandler=function(){this._gameScenePanel.hideActionBtn()},e.prototype.pushHuPaiHandler=function(){if(GoCardProcessManager.huCardInfo){if(RoomManager.mineInfo&&GoCardProcessManager.huCardInfo.roleId==RoomManager.mineInfo.roleId&&(this._maiMaTimeId=egret.setTimeout(this.tryMaiMa,this,this._maiMaGap)),this._gameScenePanel.showActionEffect(ActionType.Hu,RoomManager.getPosTypeByRoleId(GoCardProcessManager.huCardInfo.roleId)),GoCardProcessManager.huCardInfo.huType==HuResultType.JiaGang){var e=RoomManager.getPlayerInfoByPos(GoCardProcessManager.huCardInfo.boomPos);if(e){var t=RoomManager.getGroupCard(GoCardProcessManager.huCardInfo.card,e.groupList);if(t){var n=RoomManager.getPosType(e.pos,t.pos);this._groupCardController.revertBuGang(GoCardProcessManager.huCardInfo.boomPos,n-1,GoCardProcessManager.huCardInfo.card),t.action=ActionType.Peng}}}this.actionClear(),this.refreshActionBtnState()}this.timeClear()},e.prototype.tryMaiMa=function(){clearTimeout(this._maiMaTimeId),GoCardProcessManager.reqBuyHorse()},e.prototype.pushPlayerReadyHandler=function(){this.gameScenePanel.refreshHeadInfo()},e.prototype.headChangeHandler=function(){this._gameScenePanel.refreshRemainLabel()},e.prototype.pushScoreChangeHandler=function(){GoCardProcessManager.lastScoreChangeType!=ScoreChangeType.MaiMa&&this._gameScenePanel.showScoreEffect()},e.prototype.posChangeHandler=function(){this._gameScenePanel.refreshWind()},e.prototype.pushPlayerExitRoom=function(e){this._gameScenePanel.hidePlayerHead(e)},e.prototype.pushPlayerHosted=function(e){var t=e[0],n=e[1],i=RoomManager.getPlayerInfoByRoleId(t);i&&(i.hosted=n),this._gameScenePanel.refreshHeadInfo(),RoomManager.mineInfo&&t==RoomManager.mineInfo.roleId&&this._gameScenePanel.refreshHotedBtn()},e.prototype.pushSecChanged=function(e){},e.prototype.pushPlayerOffline=function(){this._gameScenePanel.refreshHeadInfo()},e.prototype.checkPeng=function(e,t){if(RoomManager.mineInfo&&!RoomManager.mineInfo.isTing&&e!=PosType.BenJia){var n=GoCardProcessManager.getCardNum(t);if(n>=2)return this.setInAction(!0),this.startPengCountDown(ProjectDefined.GetInstance().getValue(ProjectDefined.waitActionTimeClient)),!0}return!1},e.prototype.startPengCountDown=function(e){e>0&&(this._pengNum=e,clearInterval(this._pengTimeId),this._pengTimeId=setInterval(this.pengCountDown.bind(this),GameSetting.OneSecondMS))},e.prototype.pengCountDown=function(){this._pengNum--,this._pengNum<=0&&clearInterval(this._pengTimeId)},e.prototype.startGangCountDown=function(e){e>0&&(this._gangNum=e,clearInterval(this._gangTimeId),this._gangTimeId=setInterval(this.gangCoundDowning.bind(this),GameSetting.OneSecondMS))},e.prototype.gangCoundDowning=function(){this._gangNum--,this._gangNum<=0&&clearInterval(this._gangTimeId)},e.prototype.checkGang=function(e,t,n){if(this.canGangList||(this.canGangList=new Array),ArrayUtil.Clear(this.canGangList),RoomManager.mineInfo&&!RoomManager.mineInfo.isTing)if(e!=PosType.BenJia){var i=GoCardProcessManager.getCardNum(t);if(3==i)return this.setInAction(!0),this.startGangCountDown(ProjectDefined.GetInstance().getValue(ProjectDefined.waitActionTimeClient)),!0}else if(n&&RoomManager.isSelfAction){for(var i=void 0,a=void 0,o=0;o<RoomManager.roomInfo.shouPai.length;o++)a=RoomManager.roomInfo.shouPai[o],i=GoCardProcessManager.getAllCardNum(a),4==i&&-1==this.canGangList.indexOf(a)&&this.canGangList.push(a);if(this.canGangList.length>0)return!0}return!1},e.prototype.checkHu=function(e){if(RoomManager.roomInfo&&RoomManager.roomInfo.shouPai){var t=RoomManager.roomInfo.shouPai.concat(),n=RoomManager.roomInfo.myLastCard;if(void 0!=e&&(RoomManager.roomInfo.myLastCard=e,t.push(e)),this._huCard.tryHu(t))return!0;RoomManager.roomInfo.myLastCard=n}return!1},e.prototype.checkTing=function(){if(RoomManager.mineInfo&&!RoomManager.mineInfo.isTing&&RoomManager.roomInfo&&RoomManager.roomInfo.shouPai&&RoomManager.isSelfAction){for(var e=void 0,t=void 0,n=this._listenerInfoList.length-1;n>=0;n--)this._listenerInfoList[n]=null;ArrayUtil.Clear(this._listenerInfoList);for(var n=0;n<RoomManager.roomInfo.shouPai.length;n++)e=RoomManager.roomInfo.shouPai.concat(),t=e.splice(n,1)[0],-1==baiDaList.indexOf(t)&&this.tryPushLisenerInfo(e,t);if(this._shouCardController.refreshTingState(this._listenerInfoList),this._listenerInfoList.length>0)return!0}return!1},e.prototype.checkTingOutCard=function(e,t){-1==baiDaList.indexOf(t)&&this.tryPushLisenerInfo(e,t)},e.prototype.checkTingShouPai=function(e,t){var n=this._huCard.startListen(e,t);return n.listenerList&&n.listenerList.length>0?n:null},e.prototype.clearTingInfo=function(){for(var e=this._listenerInfoList.length-1;e>=0;e--)this._listenerInfoList[e]=null;ArrayUtil.Clear(this._listenerInfoList)},e.prototype.tryPushLisenerInfo=function(e,t){var n=this._huCard.startListen(e,t);n.listenerList&&n.listenerList.length>0&&this._listenerInfoList.push(n)},e.prototype.setInAction=function(e){GoCardProcessManager.isInActionSelect=e},e}();__reflect(GameProcesser.prototype,"GameProcesser");var BlindDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.forbiddenConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.forbiddenConfig);this.blindList=ShortNameDefined.GetInstance().convertEnter(e)},t.prototype.getBlindInfoBysBlind=function(e){for(var t=0,n=this.blindList;t<n.length;t++){var i=n[t];if(i.sBlind==e)return i}},t}(BaseDefined);BlindDefined.forbiddenConfig="blind",__reflect(BlindDefined.prototype,"BlindDefined");var BlindDefinition=function(){function e(){}return e}();__reflect(BlindDefinition.prototype,"BlindDefinition",["IBaseDefintion"]);var CardShowDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.cardWallConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.cardWallConfig);t.GetInstance().cardWallList=ShortNameDefined.GetInstance().convertEnter(e),e=DefinedManager.GetData(t.shouPaiConfig),t.GetInstance().shouPaiList=ShortNameDefined.GetInstance().convertEnter(e),t.GetInstance().shouPaiList&&(t.GetInstance().shouPaiMap=this.createPaiMap(Array,Dictionary,t.GetInstance().shouPaiList,t.GetInstance().shouPaiMap)),e=DefinedManager.GetData(t.cardGroupConfig),t.GetInstance().groupCardList=ShortNameDefined.GetInstance().convertEnter(e),t.GetInstance().groupCardList&&(t.GetInstance().groupCardMap=this.createPaiMap(Array,Dictionary,t.GetInstance().groupCardList,t.GetInstance().groupCardMap)),e=DefinedManager.GetData(t.outCardConfig),t.GetInstance().outCardList=ShortNameDefined.GetInstance().convertEnter(e),t.GetInstance().outCardList&&(t.GetInstance().outCardMap=this.createPaiMap(Array,Dictionary,t.GetInstance().outCardList,t.GetInstance().outCardMap)),e=DefinedManager.GetData(t.liangPaiConfig),t.GetInstance().liangPaiList=ShortNameDefined.GetInstance().convertEnter(e),t.GetInstance().liangPaiList&&(t.GetInstance().liangPaiMap=this.createPaiMap(Array,Dictionary,t.GetInstance().liangPaiList,t.GetInstance().liangPaiMap))},t.prototype.createPaiMap=function(e,t,n,i){var a;i?i.clear():i=new t;for(var o=0,r=n;o<r.length;o++){var s=r[o];a=i.getValue(s.posType),a||(a=new e,i.add(s.posType,a)),a.push(s)}return i},t}(BaseDefined);CardShowDefined.cardWallConfig="cardWall",CardShowDefined.shouPaiConfig="shouPai",CardShowDefined.cardGroupConfig="cardGroup",CardShowDefined.outCardConfig="outCard",CardShowDefined.liangPaiConfig="liangPai",__reflect(CardShowDefined.prototype,"CardShowDefined");var CardWallDefinition=function(){function e(){}return e}();__reflect(CardWallDefinition.prototype,"CardWallDefinition",["IBaseDefintion"]);var ShouPaiDefinition=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(CardWallDefinition);__reflect(ShouPaiDefinition.prototype,"ShouPaiDefinition");var GroupCardDefinition=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(ShouPaiDefinition);__reflect(GroupCardDefinition.prototype,"GroupCardDefinition");var OutCardDefinition=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(ShouPaiDefinition);__reflect(OutCardDefinition.prototype,"OutCardDefinition");var LiangPaiDefinition=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(ShouPaiDefinition);__reflect(LiangPaiDefinition.prototype,"LiangPaiDefinition");var DefinedManager=function(){function e(){}return e.Reset=function(){e._parseSet=new Array},e.SetConfigData=function(t){if(e._parseSet=new Array,e._dataMap.clear(),t)for(var n in t)0==e._dataMap.containsKey(n)?e._dataMap.add(n,t[n]):console.log("Config有重复的:",n)},e.setData=function(t,n){0==e._dataMap.containsKey(t)?e._dataMap.add(t,n):console.log("Config有重复的:",t)},e.IsParsed=function(t){return 1==e._parseSet[t]},e.GetData=function(t,n){return void 0===n&&(n=ResSuffixName.JSONSuffix),e._parseSet[t]=!0,e._dataMap.getValue(t)},e}();DefinedManager._dataMap=new Dictionary,DefinedManager._parseSet=new Array,__reflect(DefinedManager.prototype,"DefinedManager");var ErrorDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.errorConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.errorConfig);t.GetInstance().errorList=ShortNameDefined.GetInstance().convertEnter(e)},t.prototype.getDetails=function(e){var t=this.getDefinition(e,this.errorList);return t?t.des:void 0},t}(BaseDefined);ErrorDefined.errorConfig="error",__reflect(ErrorDefined.prototype,"ErrorDefined");var ErrorDefinition=function(){function e(){}return e}();__reflect(ErrorDefinition.prototype,"ErrorDefinition",["IBaseDefintion"]);var ExpDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.expConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.expConfig);this.expList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);ExpDefined.expConfig="exp",__reflect(ExpDefined.prototype,"ExpDefined");var ExpDefinition=function(){function e(){}return e}();__reflect(ExpDefinition.prototype,"ExpDefinition",["IBaseDefintion"]);var FanCalcDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.fanConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.fanConfig);t.GetInstance().fanCalcList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);FanCalcDefined.fanConfig="fan",__reflect(FanCalcDefined.prototype,"FanCalcDefined");var FanCalcDefinition=function(){function e(){}return e}();__reflect(FanCalcDefinition.prototype,"FanCalcDefinition",["IBaseDefintion"]);var FastChatDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.fastChatConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.fastChatConfig);this.fastChatList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);FastChatDefined.fastChatConfig="fastChat",__reflect(FastChatDefined.prototype,"FastChatDefined");var FastChatDefinition=function(){function e(){}return e}();__reflect(FastChatDefinition.prototype,"FastChatDefinition",["IBaseDefintion"]);var ForbiddenDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.forbiddenConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.forbiddenConfig);this.forbiddenList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);ForbiddenDefined.forbiddenConfig="forbidden",__reflect(ForbiddenDefined.prototype,"ForbiddenDefined");var ForbiddenDefinition=function(){function e(){}return e}();__reflect(ForbiddenDefinition.prototype,"ForbiddenDefinition",["IBaseDefintion"]);var ItemDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.itemConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.itemConfig);this.itemDefinitionList=ShortNameDefined.GetInstance().convertEnter(e)},t.prototype.getItemDefinition=function(e){for(var n=0,i=t.GetInstance().itemDefinitionList;n<i.length;n++){var a=i[n];if(a.id==e)return a}return null},t}(BaseDefined);ItemDefined.itemConfig="item",__reflect(ItemDefined.prototype,"ItemDefined");var ItemDefinition=function(){function e(){}return e}();__reflect(ItemDefinition.prototype,"ItemDefinition",["IBaseDefintion"]);var MusicDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.musicConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.musicConfig);if(t.GetInstance().musicList=ShortNameDefined.GetInstance().convertEnter(e),t.GetInstance().musicList)for(var n=0,i=t.GetInstance().musicList;n<i.length;n++){var a=i[n];a.boy&&(a.boy=a.boy.toString().split(SeparatorType.semicolon)),a.girl&&(a.girl=a.girl.toString().split(SeparatorType.semicolon))}},t.prototype.getSexMusicDefinition=function(e,t,n){var i=this.getMusicDefinition(t,n);if(i){var a=0;if(e==Sex.Female&&i.girl)return a=MathUtil.getRandom(0,i.girl.length-1),i.girl[a];if(e==Sex.Male&&i.boy)return a=MathUtil.getRandom(0,i.boy.length-1),i.boy[a];if(i.boy)return a=MathUtil.getRandom(0,i.boy.length-1),i.boy[a]}return StringConstant.empty},t.prototype.getMusicDefinition=function(e,t){if(!this.musicList)return null;var n,i=this.musicList.length;if(e==MusicAction.pai){if(void 0!=t)for(var a=0;i>a;a++)if(n=this.musicList[a],n.pai==t)return n}else for(var a=0;i>a;a++)if(n=this.musicList[a],n.action==e)return n},t}(BaseDefined);MusicDefined.musicConfig="music",__reflect(MusicDefined.prototype,"MusicDefined");var MusicDefinition=function(){function e(){}return e}();__reflect(MusicDefinition.prototype,"MusicDefinition",["IBaseDefintion"]);var NameDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.nameConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.nameConfig);this.nameList=ShortNameDefined.GetInstance().convertEnter(e),this.getRange()},t.prototype.getRange=function(){if(this.nameList.length>0){for(var e=0,t=this.nameList;e<t.length;e++){var n=t[e];this.lastNameRange||n.name||(this.lastNameRange=n.id-1),this.bboyFirstNameRange||n.boy||(this.bboyFirstNameRange=n.id-1)}this.lastNameRange||this.bboyFirstNameRange||console.log("获取姓名或男孩名范围失败")}},t}(BaseDefined);NameDefined.nameConfig="name",__reflect(NameDefined.prototype,"NameDefined");var NameDefinition=function(){function e(){}return e}();__reflect(NameDefinition.prototype,"NameDefinition",["IBaseDefintion"]);var PaiDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.paiConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.paiConfig);this.paiList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);PaiDefined.paiConfig="pai",__reflect(PaiDefined.prototype,"PaiDefined");var PaiDefinition=function(){function e(){}return e}();__reflect(PaiDefinition.prototype,"PaiDefinition",["IBaseDefintion"]);var PayDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.payConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.payConfig);this.payList=ShortNameDefined.GetInstance().convertEnter(e)},t.prototype.getPayDefinition=function(e){for(var n=0,i=t.GetInstance().payList;n<i.length;n++){var a=i[n];if(a.price==e)return a}return null},t}(BaseDefined);PayDefined.payConfig="pay",__reflect(PayDefined.prototype,"PayDefined");var PayDefinition=function(){function e(){}return e}();__reflect(PayDefinition.prototype,"PayDefinition",["IBaseDefintion"]);var ProjectDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.projectConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.projectConfig);this.projectObj=ShortNameDefined.GetInstance().convertEnter(e),this.round=this.projectObj.round,this.playWay=this.projectObj.playWay,this.antes=this.projectObj.antes,this.bringRoomCard=this.projectObj.bringRoomCard,this.gameFeedback=this.projectObj.gameFeedback,this.vipSpeed=this.projectObj.vipSpeed,FriendManager.giveOnceGoldNum=this.projectObj.giveOnceGoldNum,this.round&&this.round.forEach(function(e,t,n){e.groupName="round",e.isRound=!0}),this.playWay&&this.playWay.forEach(function(e,t,n){e.groupName="playWay"}),this.antes&&this.antes.forEach(function(e,t,n){e.groupName="antes"}),this.vipSpeed&&this.vipSpeed.forEach(function(e,t,n){e.groupName="vipSpeed"})},t.prototype.getValue=function(e){return this.projectObj?this.projectObj[e]:null},t.prototype.getPlayWayDefinition=function(e){for(var t=0,n=this.playWay;t<n.length;t++){var i=n[t];if(i.type==e)return i}return null},t.prototype.getAnteDefinition=function(e){for(var t=0,n=this.antes;t<n.length;t++){var i=n[t];if(i.score==e)return i}return null},t.prototype.getRoundDefinition=function(e){for(var t=0,n=this.round;t<n.length;t++){var i=n[t];if(i.num==e)return i}return null},t.prototype.getBringRoomCardDefinition=function(e){for(var t=0,n=this.bringRoomCard;t<n.length;t++){var i=n[t];if(i.type==e)return i}return null},t.prototype.getVipSpeedDefinition=function(e){for(var t=0,n=this.vipSpeed;t<n.length;t++){var i=n[t];if(i.type==e)return i}return null},t}(BaseDefined);ProjectDefined.projectConfig="project",ProjectDefined.version="version",ProjectDefined.onTimeOut="onTimeOut",ProjectDefined.intranetIp="intranetIp",ProjectDefined.intranetPort="intranetPort",ProjectDefined.serverCrowded="serverCrowded",ProjectDefined.waitActionTimeClient="waitActionTimeClient",ProjectDefined.putTimeoutClient="putTimeoutClient",ProjectDefined.putTimeoutTimes="putTimeoutTimes",ProjectDefined.initPutTimeOutClient="initPutTimeOutClient",ProjectDefined.waitReadyTime="waitReadyTime",ProjectDefined.waitDisbandTime="waitDisbandTime",ProjectDefined.address="address",ProjectDefined.port="port",ProjectDefined.testAddress="testAddress",ProjectDefined.testPort="testPort",ProjectDefined.chatMaxRecordTime="chatMaxRecordTime",ProjectDefined.voiceHost="voiceHost",ProjectDefined.voiceHostTest="voiceHostTest",ProjectDefined.voicePath="voicePath",ProjectDefined.versionUrl="versionUrl",ProjectDefined.maintainUrl="maintainUrl",ProjectDefined.updateUrl="updateUrl",ProjectDefined.vipLevel="vipLevel",__reflect(ProjectDefined.prototype,"ProjectDefined");var RoundDefinition=function(){function e(){}return e}();__reflect(RoundDefinition.prototype,"RoundDefinition");var PlayWayDefinition=function(){function e(){}return e}();__reflect(PlayWayDefinition.prototype,"PlayWayDefinition");var AntesDefinition=function(){function e(){}return e}();__reflect(AntesDefinition.prototype,"AntesDefinition");var BringRoomCardDefinition=function(){function e(){}return e}();__reflect(BringRoomCardDefinition.prototype,"BringRoomCardDefinition");var GameFeedbackDefinition=function(){function e(){}return e}();__reflect(GameFeedbackDefinition.prototype,"GameFeedbackDefinition");var VipSpeedDefinition=function(){function e(){}return e}();__reflect(VipSpeedDefinition.prototype,"VipSpeedDefinition");var ShoppingDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.ShoppingConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.ShoppingConfig);this.shoppingList=ShortNameDefined.GetInstance().convertEnter(e)},t}(BaseDefined);ShoppingDefined.ShoppingConfig="payList",__reflect(ShoppingDefined.prototype,"ShoppingDefined");var ShoppingDefinition=function(){function e(){}return e}();__reflect(ShoppingDefinition.prototype,"ShoppingDefinition",["IBaseDefintion"]);var ShortNameDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return null==t._instance&&(t._instance=new t),0==DefinedManager.IsParsed(t.shortConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){this.shortNameKv=DefinedManager.GetData(t.shortConfig)},t.prototype.convertEnter=function(e){if(null!=e){var t=e;if(t.length){for(var n=0;n<t.length;n++)this.convertEnter(t[n]);return e}return this.convert(e)}return null},t.prototype.convert=function(e){if(e){if("Array<Object>"==typeof e)return console.log("此转换仅支持对象转换"),null;for(var t in e){var n=this.getConvertKey(t);n&&(e[n]=e[t],delete e[t])}return e}return null},t.prototype.getConvertKey=function(e){if(this.shortNameKv)for(var t in this.shortNameKv)if(e==t)return this.shortNameKv[e];return""},t}(BaseDefined);ShortNameDefined.shortConfig="shortName",__reflect(ShortNameDefined.prototype,"ShortNameDefined");var TextDefined=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.GetInstance=function(){return t._instance||(t._instance=new t),0==DefinedManager.IsParsed(t.textConfig)&&t._instance.initialize(),t._instance},t.prototype.initialize=function(){var e=DefinedManager.GetData(t.textConfig);this.textList=ShortNameDefined.GetInstance().convertEnter(e);for(var n=/\\n/g,i=0,a=this.textList;i<a.length;i++){var o=a[i];o.text=o.text.replace(n,"\n")}},t}(BaseDefined);TextDefined.textConfig="text",__reflect(TextDefined.prototype,"TextDefined");
var TextDefinition=function(){function e(){}return e}();__reflect(TextDefinition.prototype,"TextDefinition",["IBaseDefintion"]);var Command=function(){function e(){}return e}();Command.Login_login="login",Command.Login_exchange="exchange",Command.Login_auth="auth",Command.System_Heartbeat_3016="c3016",Command.Req_JoinInRoom_3004="c3004",Command.System_Response_Login_2013="c2013",Command.Role_Get_3000="c3000",Command.Req_BuyCard_3001="c3001",Command.Rec_PushPropertyChange_2000="c2000",Command.Rec_PushOtherPlayerJoin_2001="c2001",Command.Req_GetRoundInfo_3002="c3002",Command.Req_CreateRoom_3003="c3003",Command.Req_ExitRoom_3005="c3005",Command.Req_IsAgreeExit_3006="c3006",Command.Rec_PushReqExitRoom_2002="c2002",Command.Rec_PushExitVoteResult_2003="c2003",Command.Req_GoOnGame_3015="c3015",Command.Rec_PushTouziResult_2004="c2004",Command.Rec_PushRoomDisbanded_2015="c2015",Command.Rec_PushShouPai_2005="c2005",Command.Rec_PushMoPai_2006="c2006",Command.Rec_PushOutCard_2007="c2007",Command.Rec_PushMoPaiResult_2016="c2016",Command.Req_PutOutCard_3008="c3008",Command.Req_PengCard_3009="c3009",Command.Req_GangCard_3010="c3010",Command.Req_HuCard_3011="c3011",Command.Req_TingCard_3012="c3012",Command.Rec_PushGangCard_2017="c2017",Command.Rec_PushPengCard_2018="c2018",Command.Rec_PushHuCard_2019="c2019",Command.Req_Pass_3020="c3020",Command.Rec_Push_2010="c2010",Command.Req_BuyHorse_3013="c3013",Command.Rec_PushOnceResult_2011="c2011",Command.Rec_PushGameOver_2020="c2020",Command.Rec_PushBuyHorse_2021="c2021",Command.Rec_PushPlayReady_2022="c2022",Command.Rec_PushScore_2008="c2008",Command.Rec_PushPlayerExitRoom_2023="c2023",Command.Rec_PushPlayerHosted_2024="c2024",Command.Req_Hosted_3022="c3022",Command.Rec_PushSec_2025="c2025",Command.Rec_Message_2014="c2014",Command.Rec_GetVipTime_2001="c2001",Command.Rec_Push_Offline_2026="c2026",Command.Req_GetRoundDetials_3024="c3024",Command.Req_BindId_3025="c3025",Command.Req_BringCard_3026="c3026",Command.Req_BindFriendList_3027="c3027",Command.Req_Send_ChatMessage_3019="c3019",Command.Req_Chat_Record_Sgin_3018="c3018",Command.Req_SetUserInfo_3017="c3017",Command.Rec_ExpChange_2028="c2028",Command.Req_RoomInfo_3002="c3002",Command.Req_friendInfo_3003="c3003",Command.Req_GiveFriendGold_3013="c3013",Command.Req_GetUserInfo_3023="c3023",Command.Req_ReceiveGift_3006="c3006",Command.Req_FriendRequest_3007="c3007",Command.Req_ReceiveFriend_3008="c3008",Command.Req_SearchPlayer_3009="c3009",Command.Req_AddPlayer_3010="c3010",Command.Req_FastReceive_3011="c3011",Command.Req_CreateRole_3012="c3012",Command.Req_saveORwithdraw_3014="c3014",Command.Req_safePwd_3017="c3017",Command.Req_Mail_3097="c3097",Command.Req_TakeMailPrize_3098="c3098",Command.Rec_Mail_New_Notify_2024="c2024",Command.Exchange_3113="c3113",__reflect(Command.prototype,"Command");var GameSceneWaitOper=function(){function e(){}return e}();__reflect(GameSceneWaitOper.prototype,"GameSceneWaitOper");var GroupCardController=function(){function e(e,t){this._benJiaGroupHandler=new GroupCardHandler(PosType.BenJia,t.getContainer(GameSetting.BenJiaGroupLayer)),this._xiaJiaGroupHandler=new GroupCardHandler(PosType.XiaJia,t.getContainer(GameSetting.XiaJiaGroupLayer)),this._duiJiaGroupHandler=new GroupCardHandler(PosType.DuiJia,t.getContainer(GameSetting.DuiJiaGrouplayer)),this._shangJiaGroupHandler=new GroupCardHandler(PosType.ShangJia,t.getContainer(GameSetting.ShangJiaGroupLayer)),this._handlerMap=new Dictionary,this._handlerMap.add(PosType.BenJia,this._benJiaGroupHandler),this._handlerMap.add(PosType.XiaJia,this._xiaJiaGroupHandler),this._handlerMap.add(PosType.DuiJia,this._duiJiaGroupHandler),this._handlerMap.add(PosType.ShangJia,this._shangJiaGroupHandler)}return e.prototype.addGroup=function(e,t,n){if(RoomManager.mineInfo){var i=RoomManager.getPosTypeForMine(e),a=this._handlerMap.getValue(i);a.addGroup(t,n)}},e.prototype.addBuGangGroup=function(e,t,n){if(RoomManager.mineInfo){var i=RoomManager.getPosTypeForMine(e),a=this._handlerMap.getValue(i);a&&a.addBuGangGroup(t,n)}},e.prototype.revertBuGang=function(e,t,n){if(RoomManager.mineInfo){var i=RoomManager.getPosTypeForMine(e),a=this._handlerMap.getValue(i);a&&a.revertBuGang(t,n)}},e.prototype.showPai=function(){if(RoomManager.roomInfo&&RoomManager.roomInfo.playerList){var e=void 0,t=void 0,n=void 0,i=void 0;this.clear();for(var a=0;a<RoomManager.roomInfo.playerList.length;a++)if(e=RoomManager.roomInfo.playerList[a],e.groupList){e.groupList.sort(this.sortByIndex);for(var o=0;o<e.groupList.length;o++){switch(t=e.groupList[o],t.action){case ActionType.Peng:n=RoomManager.getPosType(e.pos,t.pos),i=n-1;break;case ActionType.Gang:case ActionType.BuGang:n=RoomManager.getPosType(e.pos,t.pos),i=n+2;break;case ActionType.AnGang:i=GroupCardType.AnGang}this.addGroup(e.pos,i,t.card)}}}},e.prototype.clear=function(){for(var e=this._handlerMap.getValues(),t=0,n=e;t<n.length;t++){var i=n[t];i.clear()}},e.prototype.sortByIndex=function(e,t){return e.index>t.index?1:e.index<t.index?-1:0},e}();__reflect(GroupCardController.prototype,"GroupCardController");var ActionFunction=function(){function e(e,t){this._func=e,this._thisObject=t}return e.prototype.invoke=function(e){this._thisObject?void 0==e?this._func.call(this._thisObject):this._func.call(this._thisObject,e):void 0==e?this._func():this._func(e)},e}();__reflect(ActionFunction.prototype,"ActionFunction");var CardWallHandler=function(){function e(e,t){this._wallIndex=[0,28,56,84],this._timeSpeed=30,this._startTime=0,this._runIndex=0,this._faTimeSpeed=150,this._faTotal=12,this._faMoTimeSpeed=150,this._faMoTotal=4,this._touziNumList=[1,2,3,0],this._isCreate=!1,this._benJiaContainer=e,this._otherContainer=t,this._benJiaWallList=new Array,this._xiaJiaWallList=new Array,this._duiJiaWallList=new Array,this._shangJiaWallList=new Array,this._allWallList=new Array,this._totalJiaWallList=new Array,this._allWallList.push(this._benJiaWallList),this._allWallList.push(this._xiaJiaWallList),this._allWallList.push(this._duiJiaWallList),this._allWallList.push(this._shangJiaWallList)}return Object.defineProperty(e.prototype,"isFaMoRunOver",{get:function(){return this._isFaMoRunOver},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){if(this._isCreate)for(var t=0,n=this._totalJiaWallList;t<n.length;t++){var i=n[t];i.img.visible=e}else this.initCreate()},e.prototype.onEnable=function(){GameManager.stage.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},e.prototype.onDisable=function(){GameManager.stage.removeEventListener(egret.Event.ENTER_FRAME,this.update,this)},e.prototype.showCardWall=function(e){if(RoomManager.roomInfo){this.initialize(!0);for(var t=0,n=this._totalJiaWallList;t<n.length;t++){var i=n[t];i.img.visible=!0}this.initStartTail(e),this.refreshCardShow(RoomManager.roomInfo.head,RoomManager.roomInfo.tail)}},e.prototype.initStartTail=function(e){var t=RoomManager.mineInfo;if(t){var n;if(void 0!=e)n=e;else{var i=RoomManager.masterInfo;if(!i)return;n=i.pos}var a=(RoomManager.roomInfo.num1+RoomManager.roomInfo.num2)%4,o=n-1+a;o>RoomManager.mod&&(o-=RoomManager.mod);var r=RoomManager.getPosType(t.pos,o),s=this._allWallList[r-1],l=2*RoomManager.roomInfo.minTouziNum;if(this._start_startCardImg=s[l],!this._start_startCardImg)throw new Error("起手牌为空！");this._tail_startCardImg=s[l-1]}},e.prototype.updateCardWall=function(e,t){this.refreshCardShow(e,t)},e.prototype.refreshCardShow=function(e,t){this._start_startCardImg||this.initStartTail();var n=this._start_startCardImg.definition.id+e,i=!1;n>GameSetting.CardTotalNum&&(i=!0,n-=GameSetting.CardTotalNum);var a=this._tail_startCardImg.definition.id-t,o=!1;0>a&&(a=GameSetting.CardTotalNum-Math.abs(a),o=!0);var r=this.getCardWllImg(n);if(i){for(var s=this._start_startCardImg.definition.id;s<=GameSetting.CardTotalNum;s++)this.hideCard(s);for(var s=1;s<r.definition.id;s++)this.hideCard(s)}else for(var s=this._start_startCardImg.definition.id;s<r.definition.id;s++)this.hideCard(s);this.getCardWllImg(n);if(o){for(var s=this._tail_startCardImg.definition.id;s>0;s--)this.hideTailCard(s);for(var s=GameSetting.CardTotalNum;s>a;s--)this.hideTailCard(s)}else for(var s=this._tail_startCardImg.definition.id;s>a;s--)this.hideTailCard(s)},e.prototype.hideTailCard=function(e){e%2==1?this.hideCard(e+1):this.hideCard(e-1)},e.prototype.hideCard=function(e){var t=this.getCardWllImg(e);t&&(t.img.visible=!1)},e.prototype.getCardWllImg=function(e){for(var t=0,n=this._totalJiaWallList;t<n.length;t++){var i=n[t];if(i.definition.id==e)return i}return null},e.prototype.initCreate=function(){this.createJiaWall(PosType.BenJia,PosType.XiaJia,this._benJiaWallList,ImageSource.Card_Wall_BenJia),this.createJiaWall(PosType.XiaJia,PosType.DuiJia,this._shangJiaWallList,ImageSource.Card_Wall_ShangJia),this.createJiaWall(PosType.DuiJia,PosType.ShangJia,this._duiJiaWallList,ImageSource.Card_Wall_DuiJia),this.createJiaWall(PosType.ShangJia,PosType.BenJia,this._xiaJiaWallList,ImageSource.Card_Wall_XiaJia,GameSetting.CardTotalNum),this._totalJiaWallList.sort(this.sortCard);for(var e,t=0;t<this._totalJiaWallList.length;t++)e=this._totalJiaWallList[t],e.posType==PosType.BenJia?this._benJiaContainer.addChild(e.img):this._otherContainer.addChild(e.img);this._isCreate=!0},e.prototype.runCardWall=function(){this.initialize(!1),this._runIndex=0,this._startTime=egret.getTimer(),this._isRunOver=!1,this.onEnable()},e.prototype.runFaPai=function(e,t){this._faIndex=1,RoomManager.roomInfo&&RoomManager.roomInfo.playerList&&(this._faTotal=3*RoomManager.roomInfo.playerList.length),this._faStartTime=egret.getTimer(),this._isFaRunOver=!1,this._showShouPaiCallBack=e,this._showShoupaiThisObj=t,this.onEnable()},e.prototype.runMoPai=function(){this._faMoIndex=1,RoomManager.roomInfo&&RoomManager.roomInfo.playerList&&(this._faMoTotal=RoomManager.roomInfo.playerList.length),this._faMoStartTime=egret.getTimer(),this._isFaMoRunOver=!1},e.prototype.createJiaWall=function(e,t,n,i,a){var o=this._wallIndex[e-1],r=this._wallIndex[t-1];void 0!=a&&(r=a);for(var s,l,c=o+1;r>=c;c++)s=CardShowDefined.GetInstance().getDefinition(c,CardShowDefined.GetInstance().cardWallList),s&&(l=this.createCard(e,s,i),n.push(l),this._totalJiaWallList.push(l))},e.prototype.createCard=function(e,t,n){var i=new eui.Image(n);i.x=t.x,i.y=t.y,i.scaleX=i.scaleY=t.scale;var a=new CardWallImg;return a.img=i,a.definition=t,a.img.visible=!1,a.posType=e,a},e.prototype.update=function(t){if(!this._isRunOver&&egret.getTimer()-this._startTime>=this._timeSpeed){if(this._startTime=egret.getTimer(),this._runIndex>=this._benJiaWallList.length)return this._isRunOver=!0,this._isFaRunOver=!1,e.runAd.dispatch(),void this.onDisable();for(var n=void 0,i=0,a=this._allWallList;i<a.length;i++){var o=a[i];o.length>0&&(n=o[this._runIndex],n.img.visible=!0,n=o[this._runIndex+1],n.img.visible=!0)}this._runIndex+=2}if(!this._isFaRunOver&&egret.getTimer()-this._faStartTime>=this._faTimeSpeed){if(this._faStartTime=egret.getTimer(),this._faIndex>this._faTotal)return this._isFaRunOver=!0,this._isFaMoRunOver=!1,e.faAd.dispatch(),void this.runMoPai();SoundManager.playEffect(Sex.Male,MusicAction.fapai),this.refreshCardShow(4*this._faIndex,0),this._faIndex++,this._showShouPaiCallBack.bind(this._showShoupaiThisObj)()}if(!this._isFaMoRunOver&&egret.getTimer()-this._faMoStartTime>=this._faMoTimeSpeed){if(this._faMoStartTime=egret.getTimer(),this._faMoIndex>this._faMoTotal)return this._isFaMoRunOver=!0,e.faMoAd.dispatch(),void this.onDisable();SoundManager.playEffect(Sex.Male,MusicAction.fapai),this.refreshCardShow(RoomManager.mod*GameSetting.FaFourCardModel+this._faMoIndex,0),this._faMoIndex++,this._showShouPaiCallBack.bind(this._showShoupaiThisObj)()}},e.prototype.clear=function(){this._runIndex=0,this._startTime=0,this._isRunOver=!0,this._isFaRunOver=!0,this._faIndex=0,this._faStartTime=0,this._isFaMoRunOver=!0,this._faMoIndex=0,this._faMoStartTime=0,this.onDisable();for(var e=0,t=this._totalJiaWallList;e<t.length;e++){var n=t[e];n.img.visible=!1}this._start_startCardImg=null,this._tail_startCardImg=null},e.prototype.sortCard=function(e,t){return e.definition.layer>t.definition.layer?-1:e.definition.layer<t.definition.layer?1:0},e}();CardWallHandler.runAd=new ActionDispatcher,CardWallHandler.faAd=new ActionDispatcher,CardWallHandler.faMoAd=new ActionDispatcher,__reflect(CardWallHandler.prototype,"CardWallHandler");var CardWallImg=function(){function e(){}return e}();__reflect(CardWallImg.prototype,"CardWallImg");var GroupCardHandler=function(){function e(t,n){this._groupCount=0,this._layerContainer=n,this._posType=t,this._groupCount=0,this._cardList=new Array,this._list=CardShowDefined.GetInstance().groupCardMap.getValue(this._posType),this._moveEvent=new UIModuleEvent(UIModuleEvent.CHANGE,e.GroupMoveAction),this._eventObj={}}return e.prototype.addGroup=function(e,t){var n,i;e>GroupCardType.PengShangJia?(n=4,i=ActionType.Gang,e>GroupCardType.GangShangJia&&(i=ActionType.AnGang)):(n=3,i=ActionType.Peng);for(var a,o,r=1;n>=r;r++)o=this.getGroupCardDef(e,r),o&&(a=new GroupCard(o,t,this.initX+this.offsetX*this._groupCount,this.initY+this.offsetY*this._groupCount,this._groupCount),this._cardList.push(a));this.showByY(),this._eventObj.pos=this._posType,this._groupCount++,this.dispatchMoveEvent()},e.prototype.addBuGangGroup=function(e,t){this.reShowGroupCard(e,t,4)},e.prototype.revertBuGang=function(e,t){this.reShowGroupCard(e,t,3)},e.prototype.reShowGroupCard=function(e,t,n){for(var i,a,o=this._cardList.length-1;o>=0;o--)i=this._cardList[o],i.card==t&&(a=i.groupCount,this._layerContainer.removeChild(i),this._cardList.splice(o,1));for(var r,o=1;n>=o;o++)r=this.getGroupCardDef(e,o),r&&(i=new GroupCard(r,t,this.initX+this.offsetX*a,this.initY+this.offsetY*a,a),this._cardList.push(i));this.showByY()},e.prototype.dispatchMoveEvent=function(){this._eventObj.offsetX=this.offsetX*this._groupCount,this._eventObj.offsetY=this.offsetY*this._groupCount,this._moveEvent.data=this._eventObj,e.moveAd.dispatch(this._eventObj)},Object.defineProperty(e.prototype,"initX",{get:function(){switch(this._posType){case PosType.BenJia:return 1038;case PosType.DuiJia:return 302;case PosType.XiaJia:return 1020;case PosType.ShangJia:return 0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initY",{get:function(){switch(this._posType){case PosType.BenJia:return 556;case PosType.DuiJia:return 5;case PosType.XiaJia:return 75;case PosType.ShangJia:return 430}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){switch(this._posType){case PosType.BenJia:return-200;case PosType.DuiJia:return 128;case PosType.XiaJia:return 45;case PosType.ShangJia:return 45}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){switch(this._posType){case PosType.BenJia:case PosType.DuiJia:return 0;case PosType.XiaJia:return 102;case PosType.ShangJia:return-102}},enumerable:!0,configurable:!0}),e.prototype.showByY=function(){this._cardList.sort(this.sortByLayer);for(var e,t=this._cardList.length-1;t>=0;t--)e=this._cardList[t],this._layerContainer.addChild(e)},e.prototype.sortByLayer=function(e,t){return e.cardDef.layer>t.cardDef.layer?1:e.cardDef.layer<t.cardDef.layer?-1:0},e.prototype.clear=function(){this._groupCount=0,ArrayUtil.Clear(this._cardList),this._layerContainer.removeChildren()},e.prototype.getGroupCardDef=function(e,t){if(this._list)for(var n=0,i=this._list;n<i.length;n++){var a=i[n];if(a.groupType==e&&a.cardType==t)return a}return null},e}();GroupCardHandler.GroupMoveAction="GroupMoveEvent",GroupCardHandler.moveAd=new ActionDispatcher,__reflect(GroupCardHandler.prototype,"GroupCardHandler");var OutCardHandler=function(){function e(e,t,n){this._cardList=new Array,this._posType=e,this._container=t.getContainer(n),this._outCardList=CardShowDefined.GetInstance().outCardMap.getValue(e),this._eventObj={}}return e.prototype.addPai=function(t,n,i){if(void 0===i&&(i=!0),this._outCardList){void 0==n&&(n=this._cardList.length);var a=this.getOutDef(n+1),o=new OutCard(a,t,i);this._container.addChild(o),a&&this._cardList.push(o),this._lastCard=o,this.showByY(),a&&(this._eventObj.x=a.x+this.offsetX,this._eventObj.y=a.y+this.offsetY),e.onOutCardChange.dispatch(this._eventObj)}},Object.defineProperty(e.prototype,"offsetX",{get:function(){switch(this._posType){case PosType.BenJia:return-3;case PosType.XiaJia:return 5;case PosType.DuiJia:return-9;case PosType.ShangJia:return-2}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){switch(this._posType){case PosType.BenJia:return-75;case PosType.XiaJia:return-85;case PosType.DuiJia:return-81;case PosType.ShangJia:return-80}},enumerable:!0,configurable:!0}),e.prototype.showPai=function(e){if(e){ArrayUtil.Clear(this._cardList),this._container.removeChildren();for(var t=e.length,n=0;t>n;n++)this.addPai(e[n])}},e.prototype.removePai=function(e){this._lastCard&&this._lastCard.card==e&&(this._container.removeChild(this._lastCard),ArrayUtil.RemoveItem(this._lastCard,this._cardList),this._lastCard=null)},e.prototype.showByY=function(){this._cardList.sort(this.sortLayer),UIUtil.refreshSortContainer(this._cardList,this._container)},e.prototype.sortLayer=function(e,t){if(e.outCardDef&&t.outCardDef){if(e.outCardDef.layer>t.outCardDef.layer)return-1;if(e.outCardDef.layer<t.outCardDef.layer)return 1}return 0},e.prototype.getOutDef=function(e){if(this._outCardList)for(var t=0,n=this._outCardList;t<n.length;t++){var i=n[t];if(i.pos==e)return i}return null},e.prototype.clear=function(){for(var e,t=this._cardList.length,n=t-1;n>=0;n--)e=this._cardList[n],this._container.removeChild(e);ArrayUtil.Clear(this._cardList)},e}();OutCardHandler.onOutCardChange=new ActionDispatcher,__reflect(OutCardHandler.prototype,"OutCardHandler");var GameSocket=function(e){function t(){var t=e.call(this,!0)||this;return t._handshakeMsgId=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"roleId",{get:function(){return this._roleId},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e,t,n,i,a,o,r,s){if(void 0===s&&(s=egret.WebSocket.TYPE_BINARY),this._userId=e,this._roleId=t,this._serverId=n,this._secret=i,this._session1=a,this._msgType=s,o&&r){var l=this.getSchema(r),c=void 0;l.length>0&&(c=Sproto.createNew({buf:l,sz:l.length}));var h=this.getSchema(o);if(h.length>0&&(this._spRpc=Sproto.createNew({buf:h,sz:h.length}),c)){this._spRpc.s2cProtocol_n=c.protocol_n,this._spRpc.s2cProto=c.proto,this._spRpc.protocol_n+=c.protocol_n,this._spRpc.proto=this._spRpc.proto.concat(c.proto);for(var d=0,u=c.type;d<u.length;d++)for(var p=u[d],g=0,f=p.f;g<f.length;g++){var m=f[g];m.st&&(m.st=m.st+this._spRpc.type_n)}this._spRpc.type_n+=c.type_n,this._spRpc.type=this._spRpc.type.concat(c.type),l=null,c=null}this._spRpc||console.log("创建Sproto对象失败!")}},t.prototype.getSchema=function(e){for(var t=new DataView(e),n=new Array,i=0;i<t.byteLength;i++)n[i]=t.getUint8(i);return n},t.prototype.InvokeDiscRetry=function(){if(this._discRetryMap)for(var e=this._discRetryMap.getKeys(),t=this._discRetryMap.getValues(),n=void 0,i=0;i<t.length;i++)n=t[i],this.sendData(e[i],n.session,n.obj)},t.prototype.Handshake=function(){this._handshakeMsgId++,this.Send(BaseSocket.HandshakeName,{session:this._session1,userid:this._userId,roleid:0,serverid:this._serverId,token:Crypt.HmacSha1(this._secret,StringUtil.format("{0},{1}",this._userId,this._handshakeMsgId))})},t.prototype.ParseHandshake=function(t){this.RemoveCommandListener(BaseSocket.HandshakeName,this.ParseHandshake),t.cmdId==BaseSocket.HandshakeName&&(this._isHandshaking=!1,0==t.error?(this._roleId=t.data.roleid,e.prototype.DispatchMessage.call(this,new SocketMessage(SocketMessageType.Connect,"0","handshake succeed"))):e.prototype.DispatchMessage.call(this,new SocketMessage(SocketMessageType.HandshakeError,t.error.toString(),"handshake failed")))},t}(BaseSocket);__reflect(GameSocket.prototype,"GameSocket");var LoginSocket=function(e){function t(){return e.call(this,!1)||this}return __extends(t,e),t.prototype.initialize=function(e,t){if(void 0===t&&(t=egret.WebSocket.TYPE_BINARY),this._msgType=t,e){for(var n=new DataView(e),i=new Array,a=0;a<n.byteLength;a++)i[a]=n.getUint8(a);i.length>0&&(this._spRpc=Sproto.createNew({buf:i,sz:i.length})),this._spRpc||console.log("创建Sproto对象失败!")}},t}(BaseSocket);__reflect(LoginSocket.prototype,"LoginSocket");var SocketMessageType;!function(e){e[e.None=0]="None",e[e.Connect=1]="Connect",e[e.NetworkError=2]="NetworkError",e[e.Failing=3]="Failing",e[e.HandshakeError=4]="HandshakeError"}(SocketMessageType||(SocketMessageType={}));var SocketMessage=function(){function e(e,t,n){this._type=e,this._errorCode=t,this._message=n}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorCode",{get:function(){return this._errorCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),e}();__reflect(SocketMessage.prototype,"SocketMessage");var SocketSendInfo=function(){function e(){}return e}();__reflect(SocketSendInfo.prototype,"SocketSendInfo");var SpRpcOp;!function(e){e[e.None=0]="None",e[e.Request=1]="Request",e[e.Response=2]="Response",e[e.Unknown=4]="Unknown"}(SpRpcOp||(SpRpcOp={}));var SpRpcResult=function(){function e(){}return e}();__reflect(SpRpcResult.prototype,"SpRpcResult");var ArrayUtil=function(){function e(){}return e.RemoveItem=function(e,t,n){void 0===n&&(n=1);var i;if(t)if(n>0){for(var a=0,o=0;n>o;o++){var r=t.indexOf(e);r>=0&&(t.splice(r,1),a++)}a==n&&(i=!0)}else if(-1==n)for(var o=t.length-1;o>=0;o--)t[o]==e&&(t.splice(o,1),i=!0);return i},e.Clear=function(e){e&&(e.length=0)},e.getIndex=function(e,t,n){if(t&&n)for(var i=0;i<t.length;i++)if(t[i][n]==e)return i;return-1},e.moveSomeElementsToTheEnd=function(e,t,n){0>t||t>=e.length-1,t+n+1>e.length;for(var i=new Array(n),a=0;a<i.length;a++)i[a]=e[t+a];for(var a=t;a<e.length-n;a++)e[a]=e[a+n];for(var o=0,a=e.length-n;a<e.length;a++)e[a]=i[o],o++},e}();__reflect(ArrayUtil.prototype,"ArrayUtil");var Crypt=function(){function e(){}return e.lrandomkey=function(){for(var t=new Array(8),n=0,i=0;8>i;i++)n=Math.floor(256*Math.random()),t[i]=String.fromCharCode(255&n);var a=e.toString(t);return a},e.lb64encode=function(e){return Base64.encode(e)},e.lb64decode=function(e){return Base64.decode(e)},e.ltohex=function(t){var n=e.toCharArray("0123456789abcdef"),i=0,a=e.toCharArray(t);i=a.length;var o=new Array(256),r=o;i>128&&(r=new Array(2*i));var s,l=StringConstant.empty;for(s=0;i>s;s++)l=a[s],r[2*s]=n[l.charCodeAt(0)/Math.pow(2,4)],r[2*s+1]=n[15&l.charCodeAt(0)];var c=e.toString(r),h=/\0+$/g;return c=c.replace(h,StringConstant.empty)},e.mul_mod_p=function(t,n){for(var i=new bigInt(0);n.greater(0);){if(n.and(1)>0){var a=e.P.subtract(t);i=i.greaterOrEquals(a)?i.subtract(a):i.add(t)}t=t.greaterOrEquals(e.P.subtract(t))?t.multiply(2).subtract(e.P):t.multiply(2),n=n.divide(2)}return i},e.pow_mod_p=function(t,n){if(n.equals(1))return t;var i=e.pow_mod_p(t,n.divide(2));return i=e.mul_mod_p(i,i),n.mod(2).greater(0)&&(i=e.mul_mod_p(i,t)),i},e.powmodp=function(t,n){var i=new bigInt(t),a=new bigInt(e.P);return i.greater(a)&&(i=i.mod(a)),console.log(n.valueOf()),e.pow_mod_p(i,n)},e.push64=function(e){return""},e.read64=function(e,t,n,i){},e.ldhexchange=function(e){return StringConstant.empty},e.ldhsecret=function(e,t){return StringConstant.empty},e.HmacSha1=function(e,t){var n=b64_hmac_sha1(e,t);return n},e.AESEncrypt=function(e,t){for(var n=aesjs.utils.utf8.toBytes(t),i=new Array(16),a=Math.min(16,n.length),o=0;a>o;o++)i[o]=n[o];var r=aesjs.utils.utf8.toBytes(e),s=(aesjs.padding.pkcs7.pad(i),new aesjs.ModeOfOperation.ecb(i)),l=aesjs.padding.pkcs7.pad(r),c=s.encrypt(l),h=Base64.btoa(String.fromCharCode.apply(null,c));return h},e.AESDecrypt=function(e,t){return StringConstant.empty},e.toString=function(e){for(var t=StringConstant.empty,n=0;n<e.length;n++)t+=e[n];return t},e.toCharArray=function(e){var t=new Array;if(e)for(var n=0;n<e.length;n++)t.push(e.charAt(n));return t},e}();Crypt.P=new bigInt(0x10000000000000000),__reflect(Crypt.prototype,"Crypt");var DateTimeUtil=function(){function e(){}return e.baseDateFormat=function(e,t,n){/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t},e.formatDate=function(t,n){t||(t=new Date),n||(n=e.Format_Standard_Full);var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),"S+":t.getMilliseconds()};return e.baseDateFormat(t,n,i)},e.formatTimestamp=function(t,n){var i=new Date;return void 0!=t&&null!=t&&i.setTime(1e3*t),e.formatDate(i,n)},e.toTimestamp=function(e){var t=e?new Date(e):new Date;return Math.round(t.getTime()/1e3)},e.formatCountdown=function(e,t){return void 0===t&&(t="00"),"00"==t?e>=10?e.toString():"0"+e.toString():e.toString()},e}();DateTimeUtil.Format_Standard_Full="yyyy-MM-dd hh:mm:ss",DateTimeUtil.Format_Standard_Date="yyyy-MM-dd",DateTimeUtil.Format_Standard_Time="hh:mm:ss",DateTimeUtil.Format_Standard_NoSecond="yyyy-MM-dd hh:mm",DateTimeUtil.Format_China_Full="yyyy年MM月dd日 hh时mm分ss秒",DateTimeUtil.Format_China_Date="yyyy年MM月dd日",DateTimeUtil.Format_China_Time="hh时mm分ss秒",DateTimeUtil.Format_China_NoSecond="yyyy年MM月dd日 hh时mm分",__reflect(DateTimeUtil.prototype,"DateTimeUtil");var MathUtil=function(){function e(){}return e.clamp=function(e,t,n){return t>e?t:e>n?n:e},e.lerp=function(e,t,n){return n=0>n?0:n,n=n>1?1:n,e+(t-e)*n},e.getRandom=function(e,t){return Math.round(Math.random()*(t-e))+e},e.formatNum=function(t){var n;return 1e4>t?n=t.toString():t>=1e4&&1e8>t?n=t%1e4==0?t/1e4+"万":e.fixedFloor(t/1e4,2)+"万":t>=1e8?n=t%1e8==0?t/1e8+"亿":e.fixedFloor(t/1e8,2)+"亿":void 0},e.fixedFloor=function(e,t){t||(t=0);var n=e.toString();return n.indexOf(".")+t+1>n.length?n:n.substring(0,n.indexOf(".")+t+1)},e}();__reflect(MathUtil.prototype,"MathUtil");var StringUtil=function(){function e(){}return e.toBoolean=function(t){return e.isNullOrEmpty(t)?!1:"0"==t||"false"==t?!1:!0},e.isNullOrEmpty=function(e){return void 0===e||null===e||""===e?!0:!1},e.isNull=function(e){return void 0===e||null===e?!0:!1},e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(t&&e)for(var i=0;i<t.length;i++)e=e.replace("{"+i.toString()+"}",t[i]);return e},e.toIntArray=function(t,n){void 0===n&&(n=",");var i=e.toStringArray(t,n);if(null==i)return null;for(var a,o=new Array(i.length),r=0;r<i.length;r++)a=i[r],o[r]=a?parseInt(a):0;return o},e.toFloatArray=function(t,n){void 0===n&&(n=",");var i=e.toStringArray(t,n);if(null==i)return null;for(var a,o=new Array(i.length),r=0;r<i.length;r++)o[r]=a?parseFloat(a):0;return o},e.toStringArray=function(e,t){return void 0===t&&(t=","),e?e.split(t):null},e}();__reflect(StringUtil.prototype,"StringUtil");var Tick=function(){function e(){this._frameUpdateMethodList=new Array,this._secondsUpdateMethodList=new Array,this._timeoutList=new Array,this._hashCode=0,this._deltaTime=0,this._lastStamp=0}return e.getInstance=function(){return e._tick||(e._tick=new e),e._tick},e.prototype.initialize=function(e){this.stage=e,this._secondsTime=egret.getTimer(),this.stage.addEventListener(egret.Event.ENTER_FRAME,this.update,this)},Object.defineProperty(e.prototype,"deltaTime",{get:function(){return this._deltaTime},enumerable:!0,configurable:!0}),e.prototype.SecondsUpdate=function(){this.runSecondsUpdate(1)},e.prototype.update=function(e){0==this._lastStamp?this._lastStamp=egret.getTimer():(this._deltaTime=egret.getTimer()-this._lastStamp,this._lastStamp=egret.getTimer()),null!=this._frameUpdateMethodList&&this.runFrameUpdate();var t=egret.getTimer()-this._secondsTime;if(t>=1e3&&(this._secondsTime=egret.getTimer(),null!=this._secondsUpdateMethodList&&this.runSecondsUpdate(t)),this._timeoutList.length>0)for(var n=this._timeoutList.length,i=n-1;i>=0;i--){var a=this._timeoutList[i];egret.getTimer()>=a.time&&(this._timeoutList.splice(i,1),a.method(),this._timeoutList.length<n&&(i-=n-this._timeoutList.length))}},e.prototype.runFrameUpdate=function(){for(var e=0,t=this._frameUpdateMethodList;e<t.length;e++){var n=t[e];n.thisObject?n.call(n.thisObject):n()}},e.prototype.runSecondsUpdate=function(e){for(var t=0,n=this._secondsUpdateMethodList;t<n.length;t++){var i=n[t];i.thisObject?i.call(i.thisObject):i()}},e.prototype.addFrameInvoke=function(e,t){this.isExist(e,this._frameUpdateMethodList)||(t&&(e.thisObject=t),this._frameUpdateMethodList.push(e))},e.prototype.removeFrameInvoke=function(e){for(var t=this._frameUpdateMethodList.length-1;t>=0;t--)this._frameUpdateMethodList[t]==e&&this._frameUpdateMethodList.splice(t,1)},e.prototype.AddSecondsInvoke=function(e,t){this.isExist(e,this._secondsUpdateMethodList)||(t&&(e.thisObject=t),this._secondsUpdateMethodList.push(e))},e.prototype.RemoveSecondsInvoke=function(e){for(var t=this._secondsUpdateMethodList.length-1;t>=0;t--)this._secondsUpdateMethodList[t]==e&&this._secondsUpdateMethodList.splice(t,1)},e.prototype.AddTimeoutInvoke=function(e,t){if(t>0&&null!=e){var n=new TickInfo;return n.id=this._hashCode++,n.method=e,n.time=egret.getTimer()+t,this._timeoutList.push(n),n.id}return 0},e.prototype.RemoveTimeoutInvokeById=function(e){for(var t=0;t<this._timeoutList.length;t++)if(this._timeoutList[t].id==e){this._timeoutList.splice(t,1);break}},e.prototype.RemoveTimeoutInvoke=function(e){for(var t=this._timeoutList.length-1;t>=0;t--)this._timeoutList[t].method==e&&this._timeoutList.splice(t,1)},e.prototype.isExist=function(e,t){for(var n=0,i=t;n<i.length;n++){var a=i[n];if(a==e)return!0}return!1},e}();__reflect(Tick.prototype,"Tick");var TickInfo=function(){function e(){}return e}();__reflect(TickInfo.prototype,"TickInfo");var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.setProgress=function(e,t){this.textField.text="正在加载游戏启动资源......"+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var Main=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.loadCount=0,t.isThemeLoadEnd=!1,t.isResourceLoadEnd=!1,t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.stage.setContentSize(GameSetting.StageWidth,GameSetting.StageHeight),egret.Logger.logLevel=egret.Logger.ERROR;var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView)),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var t=new eui.Theme("resource/default.thm.json",this.stage);t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),this.loadCount=0,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup(ResGroupName.Preload),RES.loadGroup(ResGroupName.Pub)},t.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,this.createScene()
},t.prototype.onResourceLoadComplete=function(e){(e.groupName==ResGroupName.Preload||e.groupName==ResGroupName.Pub)&&this.loadCount++,2==this.loadCount&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.loadingView&&this.stage.removeChild(this.loadingView),this.isResourceLoadEnd=!0,this.createScene())},t.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&(this.stage.orientation=egret.OrientationMode.LANDSCAPE,GameManager.initialize(this.stage),UIManager.initialize(this.stage),Tick.getInstance().initialize(this.stage),this.startCreateScene())},t.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},t.prototype.onResourceLoadError=function(e){console.warn("Group:"+e.groupName+" has failed to load"),this.onResourceLoadComplete(e)},t.prototype.onResourceProgress=function(e){this.loadingView&&this.loadingView.setProgress(e.itemsLoaded,e.itemsTotal);e.itemsLoaded/e.itemsTotal;console.log("资源加载地址："+e.resItem.url)},t.prototype.startCreateScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return LoadConfig.startLoad(this.loadConfigComplete,this),[2]})})},t.prototype.loadConfigComplete=function(){SceneManager.goToLogin()},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function a(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,a,this,RES.ResourceItem.TYPE_TEXT)},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);